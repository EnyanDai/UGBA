nohup: ignoring input
Namespace(attack_method='Rand_Gene', cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=1, dropout=0.5, epochs=200, hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=10, selection_method='cluster', target_class=0, test_model='GCN', thrd=0.5, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Length of training set: 541
Training benign model Finished!
Total time elapsed: 2.5788s
Benign CA: 0.8444
Length of training set: 541
=== training gcn model ===
Epoch 0, training loss: 1.9322519302368164
acc_val: 0.2926
Epoch 10, training loss: 1.8021061420440674
acc_val: 0.3037
Epoch 20, training loss: 1.7138649225234985
acc_val: 0.3037
Epoch 30, training loss: 1.4916369915008545
acc_val: 0.3704
Epoch 40, training loss: 1.249752402305603
acc_val: 0.4222
Epoch 50, training loss: 1.0792059898376465
acc_val: 0.4852
Epoch 60, training loss: 0.9508324861526489
acc_val: 0.5519
Epoch 70, training loss: 0.8185819387435913
acc_val: 0.5889
Epoch 80, training loss: 0.7560440301895142
acc_val: 0.6000
Epoch 90, training loss: 0.7048591375350952
acc_val: 0.6815
Epoch 100, training loss: 0.641007125377655
acc_val: 0.7037
Epoch 110, training loss: 0.5871879458427429
acc_val: 0.7000
Epoch 120, training loss: 0.5697427988052368
acc_val: 0.7074
Epoch 130, training loss: 0.5388627052307129
acc_val: 0.7222
Epoch 140, training loss: 0.5049092173576355
acc_val: 0.7185
Epoch 150, training loss: 0.49561578035354614
acc_val: 0.7185
Epoch 160, training loss: 0.46084830164909363
acc_val: 0.7148
Epoch 170, training loss: 0.4230300188064575
acc_val: 0.7259
Epoch 180, training loss: 0.4255925714969635
acc_val: 0.7185
Epoch 190, training loss: 0.39406707882881165
acc_val: 0.7333
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 1.7880s
Encoder CA on clean test nodes: 0.7889
[2 5 5 ... 3 2 2]
Epoch 0, loss_inner: 1.94543, loss_target: 0.00000, homo loss: 0.48789 
acc_train_clean: 0.2126, ASR_train_attach: 0.0000, ASR_train_outter: 0.1163
Epoch 10, loss_inner: 1.68280, loss_target: 0.00000, homo loss: 0.48836 
acc_train_clean: 0.3179, ASR_train_attach: 0.9048, ASR_train_outter: 0.2101
Epoch 20, loss_inner: 1.48626, loss_target: 0.00000, homo loss: 0.48848 
acc_train_clean: 0.3475, ASR_train_attach: 0.9524, ASR_train_outter: 0.7111
Epoch 30, loss_inner: 1.28349, loss_target: 0.00000, homo loss: 0.48721 
acc_train_clean: 0.6137, ASR_train_attach: 0.9524, ASR_train_outter: 0.4934
Epoch 40, loss_inner: 1.07898, loss_target: 0.00000, homo loss: 0.48764 
acc_train_clean: 0.7652, ASR_train_attach: 0.9524, ASR_train_outter: 0.4822
Epoch 50, loss_inner: 0.90053, loss_target: 0.00000, homo loss: 0.48717 
acc_train_clean: 0.8115, ASR_train_attach: 1.0000, ASR_train_outter: 0.5159
Epoch 60, loss_inner: 0.76196, loss_target: 0.00000, homo loss: 0.48782 
acc_train_clean: 0.8299, ASR_train_attach: 1.0000, ASR_train_outter: 0.4784
Epoch 70, loss_inner: 0.66008, loss_target: 0.00000, homo loss: 0.48731 
acc_train_clean: 0.8743, ASR_train_attach: 0.9524, ASR_train_outter: 0.5047
Epoch 80, loss_inner: 0.58325, loss_target: 0.00000, homo loss: 0.48699 
acc_train_clean: 0.8965, ASR_train_attach: 0.9524, ASR_train_outter: 0.4953
Epoch 90, loss_inner: 0.52095, loss_target: 0.00000, homo loss: 0.48824 
acc_train_clean: 0.9150, ASR_train_attach: 1.0000, ASR_train_outter: 0.4540
Epoch 100, loss_inner: 0.47449, loss_target: 0.00000, homo loss: 0.48789 
acc_train_clean: 0.9279, ASR_train_attach: 0.9524, ASR_train_outter: 0.4953
Epoch 110, loss_inner: 0.43612, loss_target: 0.00000, homo loss: 0.48894 
acc_train_clean: 0.9353, ASR_train_attach: 1.0000, ASR_train_outter: 0.4709
Epoch 120, loss_inner: 0.40556, loss_target: 0.00000, homo loss: 0.48741 
acc_train_clean: 0.9390, ASR_train_attach: 1.0000, ASR_train_outter: 0.4559
Epoch 130, loss_inner: 0.38177, loss_target: 0.00000, homo loss: 0.48819 
acc_train_clean: 0.9427, ASR_train_attach: 1.0000, ASR_train_outter: 0.4559
Epoch 140, loss_inner: 0.36236, loss_target: 0.00000, homo loss: 0.48716 
acc_train_clean: 0.9501, ASR_train_attach: 1.0000, ASR_train_outter: 0.4747
Epoch 150, loss_inner: 0.34693, loss_target: 0.00000, homo loss: 0.48726 
acc_train_clean: 0.9501, ASR_train_attach: 0.9524, ASR_train_outter: 0.4578
Epoch 160, loss_inner: 0.33144, loss_target: 0.00000, homo loss: 0.48641 
acc_train_clean: 0.9501, ASR_train_attach: 1.0000, ASR_train_outter: 0.4784
Epoch 170, loss_inner: 0.31942, loss_target: 0.00000, homo loss: 0.48740 
acc_train_clean: 0.9519, ASR_train_attach: 1.0000, ASR_train_outter: 0.4503
Epoch 180, loss_inner: 0.31038, loss_target: 0.00000, homo loss: 0.48789 
acc_train_clean: 0.9519, ASR_train_attach: 0.9524, ASR_train_outter: 0.4709
Epoch 190, loss_inner: 0.29979, loss_target: 0.00000, homo loss: 0.48816 
acc_train_clean: 0.9556, ASR_train_attach: 1.0000, ASR_train_outter: 0.4634
precent of left attach nodes: 1.000
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8296
ASR: 0.5277
CA: 0.8037
