nohup: ignoring input
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='isolate', device_id=1, dropout=0.5, epochs=200, hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=10, selection_method='cluster', target_class=0, test_model='GCN', thrd=0.0, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Length of training set: 541
Training benign model Finished!
Total time elapsed: 13.4208s
Benign CA: 0.8444
Length of training set: 541
=== training gcn model ===
Epoch 0, training loss: 1.9322519302368164
acc_val: 0.2926
Epoch 10, training loss: 1.8021061420440674
acc_val: 0.3037
Epoch 20, training loss: 1.7138649225234985
acc_val: 0.3037
Epoch 30, training loss: 1.4916369915008545
acc_val: 0.3704
Epoch 40, training loss: 1.249752402305603
acc_val: 0.4222
Epoch 50, training loss: 1.0792059898376465
acc_val: 0.4852
Epoch 60, training loss: 0.9508324861526489
acc_val: 0.5519
Epoch 70, training loss: 0.8185819387435913
acc_val: 0.5889
Epoch 80, training loss: 0.7560439705848694
acc_val: 0.6000
Epoch 90, training loss: 0.7048591375350952
acc_val: 0.6815
Epoch 100, training loss: 0.6410071849822998
acc_val: 0.7037
Epoch 110, training loss: 0.5871880054473877
acc_val: 0.7000
Epoch 120, training loss: 0.5697429776191711
acc_val: 0.7074
Epoch 130, training loss: 0.5388627648353577
acc_val: 0.7222
Epoch 140, training loss: 0.5049092769622803
acc_val: 0.7185
Epoch 150, training loss: 0.4956158995628357
acc_val: 0.7185
Epoch 160, training loss: 0.46084830164909363
acc_val: 0.7148
Epoch 170, training loss: 0.4230300188064575
acc_val: 0.7259
Epoch 180, training loss: 0.42559340596199036
acc_val: 0.7185
Epoch 190, training loss: 0.3940292298793793
acc_val: 0.7333
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 10.4201s
Encoder CA on clean test nodes: 0.7889
[2 5 5 ... 3 2 2]
Epoch 0, loss_inner: 1.94553, loss_target: 0.00000, homo loss: 0.50871 
acc_train_clean: 0.2126, ASR_train_attach: 0.0000, ASR_train_outter: 0.7036
Epoch 10, loss_inner: 1.69763, loss_target: 0.00000, homo loss: 0.19574 
acc_train_clean: 0.3142, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 20, loss_inner: 1.57122, loss_target: 0.00000, homo loss: 0.18884 
acc_train_clean: 0.3179, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 30, loss_inner: 1.44382, loss_target: 0.00000, homo loss: 0.14671 
acc_train_clean: 0.3549, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 1.29234, loss_target: 0.00000, homo loss: 0.09019 
acc_train_clean: 0.5582, ASR_train_attach: 0.9524, ASR_train_outter: 0.9944
Epoch 50, loss_inner: 1.11772, loss_target: 0.00000, homo loss: 0.26718 
acc_train_clean: 0.6876, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 60, loss_inner: 0.95679, loss_target: 0.00000, homo loss: 0.27491 
acc_train_clean: 0.7726, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 70, loss_inner: 0.81884, loss_target: 0.00000, homo loss: 0.06946 
acc_train_clean: 0.8207, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 80, loss_inner: 0.71725, loss_target: 0.00000, homo loss: 0.08346 
acc_train_clean: 0.8262, ASR_train_attach: 1.0000, ASR_train_outter: 0.9906
Epoch 90, loss_inner: 0.63720, loss_target: 0.00000, homo loss: 0.25051 
acc_train_clean: 0.8706, ASR_train_attach: 0.9524, ASR_train_outter: 0.9869
Epoch 100, loss_inner: 0.57439, loss_target: 0.00000, homo loss: 0.13152 
acc_train_clean: 0.8928, ASR_train_attach: 0.9524, ASR_train_outter: 0.9944
Epoch 110, loss_inner: 0.51657, loss_target: 0.00000, homo loss: 0.06611 
acc_train_clean: 0.9020, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 120, loss_inner: 0.47500, loss_target: 0.00000, homo loss: 0.08624 
acc_train_clean: 0.9113, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 130, loss_inner: 0.44057, loss_target: 0.00000, homo loss: 0.08715 
acc_train_clean: 0.9261, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 140, loss_inner: 0.41925, loss_target: 0.00000, homo loss: 0.26096 
acc_train_clean: 0.9316, ASR_train_attach: 0.9524, ASR_train_outter: 0.9587
Epoch 150, loss_inner: 0.39777, loss_target: 0.00000, homo loss: 0.12828 
acc_train_clean: 0.9409, ASR_train_attach: 0.8571, ASR_train_outter: 0.9193
Epoch 160, loss_inner: 0.39172, loss_target: 0.00000, homo loss: 0.11732 
acc_train_clean: 0.9464, ASR_train_attach: 0.8095, ASR_train_outter: 0.8612
Epoch 170, loss_inner: 0.39520, loss_target: 0.00000, homo loss: 0.21581 
acc_train_clean: 0.9519, ASR_train_attach: 0.5714, ASR_train_outter: 0.7148
Epoch 180, loss_inner: 0.38492, loss_target: 0.00000, homo loss: 0.14466 
acc_train_clean: 0.9482, ASR_train_attach: 0.6667, ASR_train_outter: 0.6735
Epoch 190, loss_inner: 0.36832, loss_target: 0.00000, homo loss: 0.04982 
acc_train_clean: 0.9482, ASR_train_attach: 0.5714, ASR_train_outter: 0.6454
precent of left attach nodes: 0.048
target class rate on Vs: 0.9048
accuracy on clean test nodes: 0.4222
ASR: 0.6716
CA: 0.4296
