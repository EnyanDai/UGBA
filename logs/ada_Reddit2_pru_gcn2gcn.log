nohup: ignoring input
WARNING:root:The OGB package is out of date. Your version is 1.3.3, while the latest version is 1.3.4.
1
2
Namespace(attack_method='Basic', cuda=True, dataset='Reddit2', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, hidden=128, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='cluster', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Loading benign GCN model Finished!
Benign CA: 0.3497
Length of training set: 46593
=== training gcn model ===
Epoch 0, training loss: 3.716425657272339
acc_val: 0.0479
Epoch 10, training loss: 3.406393527984619
acc_val: 0.1268
Epoch 20, training loss: 3.125899076461792
acc_val: 0.1518
Epoch 30, training loss: 2.947035312652588
acc_val: 0.2123
Epoch 40, training loss: 2.8641929626464844
acc_val: 0.2358
Epoch 50, training loss: 2.669053554534912
acc_val: 0.3167
Epoch 60, training loss: 2.381194829940796
acc_val: 0.4051
Epoch 70, training loss: 2.1973414421081543
acc_val: 0.4497
Epoch 80, training loss: 2.0963282585144043
acc_val: 0.4655
Epoch 90, training loss: 2.050295829772949
acc_val: 0.4746
Epoch 100, training loss: 1.9953829050064087
acc_val: 0.4832
Epoch 110, training loss: 1.9668024778366089
acc_val: 0.4870
Epoch 120, training loss: 1.9294748306274414
acc_val: 0.4923
Epoch 130, training loss: 1.920756220817566
acc_val: 0.4945
Epoch 140, training loss: 1.9019180536270142
acc_val: 0.4973
Epoch 150, training loss: 1.8858000040054321
acc_val: 0.5006
Epoch 160, training loss: 1.867116093635559
acc_val: 0.5056
Epoch 170, training loss: 1.861798882484436
acc_val: 0.5099
Epoch 180, training loss: 1.861110806465149
acc_val: 0.5056
Epoch 190, training loss: 1.8526389598846436
acc_val: 0.5085
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 95.2630s
Encoder CA on clean test nodes: 0.5084
running k-means on cuda:1..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:01, ?it/s, center_shift=715.780090, iteration=1, tol=0.000100][running kmeans]: 1it [00:01,  1.30s/it, center_shift=715.780090, iteration=1, tol=0.000100][running kmeans]: 1it [00:02,  1.30s/it, center_shift=164.237823, iteration=2, tol=0.000100][running kmeans]: 2it [00:02,  1.34s/it, center_shift=164.237823, iteration=2, tol=0.000100][running kmeans]: 2it [00:03,  1.34s/it, center_shift=59.838326, iteration=3, tol=0.000100] [running kmeans]: 3it [00:03,  1.24s/it, center_shift=59.838326, iteration=3, tol=0.000100][running kmeans]: 3it [00:05,  1.24s/it, center_shift=40.466351, iteration=4, tol=0.000100][running kmeans]: 4it [00:05,  1.23s/it, center_shift=40.466351, iteration=4, tol=0.000100][running kmeans]: 4it [00:06,  1.23s/it, center_shift=31.928402, iteration=5, tol=0.000100][running kmeans]: 5it [00:06,  1.23s/it, center_shift=31.928402, iteration=5, tol=0.000100][running kmeans]: 5it [00:07,  1.23s/it, center_shift=24.281414, iteration=6, tol=0.000100][running kmeans]: 6it [00:07,  1.23s/it, center_shift=24.281414, iteration=6, tol=0.000100][running kmeans]: 6it [00:08,  1.23s/it, center_shift=19.784933, iteration=7, tol=0.000100][running kmeans]: 7it [00:08,  1.25s/it, center_shift=19.784933, iteration=7, tol=0.000100][running kmeans]: 7it [00:09,  1.25s/it, center_shift=17.946735, iteration=8, tol=0.000100][running kmeans]: 8it [00:09,  1.23s/it, center_shift=17.946735, iteration=8, tol=0.000100][running kmeans]: 8it [00:11,  1.23s/it, center_shift=14.607884, iteration=9, tol=0.000100][running kmeans]: 9it [00:11,  1.21s/it, center_shift=14.607884, iteration=9, tol=0.000100][running kmeans]: 9it [00:12,  1.21s/it, center_shift=13.142741, iteration=10, tol=0.000100][running kmeans]: 10it [00:12,  1.26s/it, center_shift=13.142741, iteration=10, tol=0.000100][running kmeans]: 10it [00:13,  1.26s/it, center_shift=12.932078, iteration=11, tol=0.000100][running kmeans]: 11it [00:13,  1.29s/it, center_shift=12.932078, iteration=11, tol=0.000100][running kmeans]: 11it [00:15,  1.29s/it, center_shift=13.236588, iteration=12, tol=0.000100][running kmeans]: 12it [00:15,  1.30s/it, center_shift=13.236588, iteration=12, tol=0.000100][running kmeans]: 12it [00:16,  1.30s/it, center_shift=13.780786, iteration=13, tol=0.000100][running kmeans]: 13it [00:16,  1.30s/it, center_shift=13.780786, iteration=13, tol=0.000100][running kmeans]: 13it [00:17,  1.30s/it, center_shift=11.112839, iteration=14, tol=0.000100][running kmeans]: 14it [00:17,  1.36s/it, center_shift=11.112839, iteration=14, tol=0.000100][running kmeans]: 14it [00:19,  1.36s/it, center_shift=8.509803, iteration=15, tol=0.000100] [running kmeans]: 15it [00:19,  1.35s/it, center_shift=8.509803, iteration=15, tol=0.000100][running kmeans]: 15it [00:20,  1.35s/it, center_shift=5.771782, iteration=16, tol=0.000100][running kmeans]: 16it [00:20,  1.33s/it, center_shift=5.771782, iteration=16, tol=0.000100][running kmeans]: 16it [00:21,  1.33s/it, center_shift=4.548391, iteration=17, tol=0.000100][running kmeans]: 17it [00:21,  1.34s/it, center_shift=4.548391, iteration=17, tol=0.000100][running kmeans]: 17it [00:23,  1.34s/it, center_shift=3.068301, iteration=18, tol=0.000100][running kmeans]: 18it [00:23,  1.35s/it, center_shift=3.068301, iteration=18, tol=0.000100][running kmeans]: 18it [00:24,  1.35s/it, center_shift=2.695467, iteration=19, tol=0.000100][running kmeans]: 19it [00:24,  1.37s/it, center_shift=2.695467, iteration=19, tol=0.000100][running kmeans]: 19it [00:26,  1.37s/it, center_shift=1.925061, iteration=20, tol=0.000100][running kmeans]: 20it [00:26,  1.37s/it, center_shift=1.925061, iteration=20, tol=0.000100][running kmeans]: 20it [00:27,  1.37s/it, center_shift=1.525437, iteration=21, tol=0.000100][running kmeans]: 21it [00:27,  1.38s/it, center_shift=1.525437, iteration=21, tol=0.000100][running kmeans]: 21it [00:28,  1.38s/it, center_shift=1.382185, iteration=22, tol=0.000100][running kmeans]: 22it [00:28,  1.37s/it, center_shift=1.382185, iteration=22, tol=0.000100][running kmeans]: 22it [00:30,  1.37s/it, center_shift=1.160482, iteration=23, tol=0.000100][running kmeans]: 23it [00:30,  1.36s/it, center_shift=1.160482, iteration=23, tol=0.000100][running kmeans]: 23it [00:31,  1.36s/it, center_shift=0.922047, iteration=24, tol=0.000100][running kmeans]: 24it [00:31,  1.39s/it, center_shift=0.922047, iteration=24, tol=0.000100][running kmeans]: 24it [00:33,  1.39s/it, center_shift=0.690785, iteration=25, tol=0.000100][running kmeans]: 25it [00:33,  1.41s/it, center_shift=0.690785, iteration=25, tol=0.000100][running kmeans]: 25it [00:34,  1.41s/it, center_shift=0.670605, iteration=26, tol=0.000100][running kmeans]: 26it [00:34,  1.41s/it, center_shift=0.670605, iteration=26, tol=0.000100][running kmeans]: 26it [00:35,  1.41s/it, center_shift=0.544263, iteration=27, tol=0.000100][running kmeans]: 27it [00:35,  1.42s/it, center_shift=0.544263, iteration=27, tol=0.000100][running kmeans]: 27it [00:37,  1.42s/it, center_shift=0.480357, iteration=28, tol=0.000100][running kmeans]: 28it [00:37,  1.40s/it, center_shift=0.480357, iteration=28, tol=0.000100][running kmeans]: 28it [00:38,  1.40s/it, center_shift=0.489648, iteration=29, tol=0.000100][running kmeans]: 29it [00:38,  1.40s/it, center_shift=0.489648, iteration=29, tol=0.000100][running kmeans]: 29it [00:40,  1.40s/it, center_shift=0.408143, iteration=30, tol=0.000100][running kmeans]: 30it [00:40,  1.41s/it, center_shift=0.408143, iteration=30, tol=0.000100][running kmeans]: 30it [00:41,  1.41s/it, center_shift=0.357817, iteration=31, tol=0.000100][running kmeans]: 31it [00:41,  1.42s/it, center_shift=0.357817, iteration=31, tol=0.000100][running kmeans]: 31it [00:42,  1.42s/it, center_shift=0.312441, iteration=32, tol=0.000100][running kmeans]: 32it [00:42,  1.41s/it, center_shift=0.312441, iteration=32, tol=0.000100][running kmeans]: 32it [00:44,  1.41s/it, center_shift=0.272644, iteration=33, tol=0.000100][running kmeans]: 33it [00:44,  1.42s/it, center_shift=0.272644, iteration=33, tol=0.000100][running kmeans]: 33it [00:46,  1.42s/it, center_shift=0.261876, iteration=34, tol=0.000100][running kmeans]: 34it [00:46,  1.48s/it, center_shift=0.261876, iteration=34, tol=0.000100][running kmeans]: 34it [00:47,  1.48s/it, center_shift=0.298331, iteration=35, tol=0.000100][running kmeans]: 35it [00:47,  1.47s/it, center_shift=0.298331, iteration=35, tol=0.000100][running kmeans]: 35it [00:48,  1.47s/it, center_shift=0.250118, iteration=36, tol=0.000100][running kmeans]: 36it [00:48,  1.44s/it, center_shift=0.250118, iteration=36, tol=0.000100][running kmeans]: 36it [00:50,  1.44s/it, center_shift=0.228186, iteration=37, tol=0.000100][running kmeans]: 37it [00:50,  1.44s/it, center_shift=0.228186, iteration=37, tol=0.000100][running kmeans]: 37it [00:51,  1.44s/it, center_shift=0.244821, iteration=38, tol=0.000100][running kmeans]: 38it [00:51,  1.45s/it, center_shift=0.244821, iteration=38, tol=0.000100][running kmeans]: 38it [00:53,  1.45s/it, center_shift=0.232671, iteration=39, tol=0.000100][running kmeans]: 39it [00:53,  1.43s/it, center_shift=0.232671, iteration=39, tol=0.000100][running kmeans]: 39it [00:54,  1.43s/it, center_shift=0.247443, iteration=40, tol=0.000100][running kmeans]: 40it [00:54,  1.43s/it, center_shift=0.247443, iteration=40, tol=0.000100][running kmeans]: 40it [00:55,  1.43s/it, center_shift=0.228426, iteration=41, tol=0.000100][running kmeans]: 41it [00:55,  1.43s/it, center_shift=0.228426, iteration=41, tol=0.000100][running kmeans]: 41it [00:57,  1.43s/it, center_shift=0.274725, iteration=42, tol=0.000100][running kmeans]: 42it [00:57,  1.43s/it, center_shift=0.274725, iteration=42, tol=0.000100][running kmeans]: 42it [00:58,  1.43s/it, center_shift=0.290859, iteration=43, tol=0.000100][running kmeans]: 43it [00:58,  1.40s/it, center_shift=0.290859, iteration=43, tol=0.000100][running kmeans]: 43it [00:59,  1.40s/it, center_shift=0.331912, iteration=44, tol=0.000100][running kmeans]: 44it [00:59,  1.35s/it, center_shift=0.331912, iteration=44, tol=0.000100][running kmeans]: 44it [01:01,  1.35s/it, center_shift=0.381782, iteration=45, tol=0.000100][running kmeans]: 45it [01:01,  1.38s/it, center_shift=0.381782, iteration=45, tol=0.000100][running kmeans]: 45it [01:02,  1.38s/it, center_shift=0.476143, iteration=46, tol=0.000100][running kmeans]: 46it [01:02,  1.41s/it, center_shift=0.476143, iteration=46, tol=0.000100][running kmeans]: 46it [01:04,  1.41s/it, center_shift=0.462896, iteration=47, tol=0.000100][running kmeans]: 47it [01:04,  1.40s/it, center_shift=0.462896, iteration=47, tol=0.000100][running kmeans]: 47it [01:05,  1.40s/it, center_shift=0.406547, iteration=48, tol=0.000100][running kmeans]: 48it [01:05,  1.40s/it, center_shift=0.406547, iteration=48, tol=0.000100][running kmeans]: 48it [01:06,  1.40s/it, center_shift=0.367990, iteration=49, tol=0.000100][running kmeans]: 49it [01:06,  1.33s/it, center_shift=0.367990, iteration=49, tol=0.000100][running kmeans]: 49it [01:08,  1.33s/it, center_shift=0.333135, iteration=50, tol=0.000100][running kmeans]: 50it [01:08,  1.28s/it, center_shift=0.333135, iteration=50, tol=0.000100][running kmeans]: 50it [01:09,  1.28s/it, center_shift=0.228803, iteration=51, tol=0.000100][running kmeans]: 51it [01:09,  1.32s/it, center_shift=0.228803, iteration=51, tol=0.000100][running kmeans]: 51it [01:11,  1.32s/it, center_shift=0.198885, iteration=52, tol=0.000100][running kmeans]: 52it [01:11,  1.49s/it, center_shift=0.198885, iteration=52, tol=0.000100][running kmeans]: 52it [01:12,  1.49s/it, center_shift=0.187685, iteration=53, tol=0.000100][running kmeans]: 53it [01:12,  1.37s/it, center_shift=0.187685, iteration=53, tol=0.000100][running kmeans]: 53it [01:13,  1.37s/it, center_shift=0.152610, iteration=54, tol=0.000100][running kmeans]: 54it [01:13,  1.39s/it, center_shift=0.152610, iteration=54, tol=0.000100][running kmeans]: 54it [01:15,  1.39s/it, center_shift=0.120608, iteration=55, tol=0.000100][running kmeans]: 55it [01:15,  1.43s/it, center_shift=0.120608, iteration=55, tol=0.000100][running kmeans]: 55it [01:16,  1.43s/it, center_shift=0.104549, iteration=56, tol=0.000100][running kmeans]: 56it [01:16,  1.42s/it, center_shift=0.104549, iteration=56, tol=0.000100][running kmeans]: 56it [01:18,  1.42s/it, center_shift=0.079934, iteration=57, tol=0.000100][running kmeans]: 57it [01:18,  1.38s/it, center_shift=0.079934, iteration=57, tol=0.000100][running kmeans]: 57it [01:19,  1.38s/it, center_shift=0.041507, iteration=58, tol=0.000100][running kmeans]: 58it [01:19,  1.32s/it, center_shift=0.041507, iteration=58, tol=0.000100][running kmeans]: 58it [01:20,  1.32s/it, center_shift=0.041388, iteration=59, tol=0.000100][running kmeans]: 59it [01:20,  1.27s/it, center_shift=0.041388, iteration=59, tol=0.000100][running kmeans]: 59it [01:21,  1.27s/it, center_shift=0.032966, iteration=60, tol=0.000100][running kmeans]: 60it [01:21,  1.29s/it, center_shift=0.032966, iteration=60, tol=0.000100][running kmeans]: 60it [01:23,  1.29s/it, center_shift=0.022320, iteration=61, tol=0.000100][running kmeans]: 61it [01:23,  1.39s/it, center_shift=0.022320, iteration=61, tol=0.000100][running kmeans]: 61it [01:24,  1.39s/it, center_shift=0.012583, iteration=62, tol=0.000100][running kmeans]: 62it [01:24,  1.42s/it, center_shift=0.012583, iteration=62, tol=0.000100][running kmeans]: 62it [01:26,  1.42s/it, center_shift=0.006588, iteration=63, tol=0.000100][running kmeans]: 63it [01:26,  1.38s/it, center_shift=0.006588, iteration=63, tol=0.000100][running kmeans]: 63it [01:27,  1.38s/it, center_shift=0.008994, iteration=64, tol=0.000100][running kmeans]: 64it [01:27,  1.39s/it, center_shift=0.008994, iteration=64, tol=0.000100][running kmeans]: 64it [01:28,  1.39s/it, center_shift=0.005263, iteration=65, tol=0.000100][running kmeans]: 65it [01:28,  1.36s/it, center_shift=0.005263, iteration=65, tol=0.000100][running kmeans]: 65it [01:30,  1.36s/it, center_shift=0.003066, iteration=66, tol=0.000100][running kmeans]: 66it [01:30,  1.37s/it, center_shift=0.003066, iteration=66, tol=0.000100][running kmeans]: 66it [01:31,  1.37s/it, center_shift=0.002987, iteration=67, tol=0.000100][running kmeans]: 67it [01:31,  1.33s/it, center_shift=0.002987, iteration=67, tol=0.000100][running kmeans]: 67it [01:32,  1.33s/it, center_shift=0.003062, iteration=68, tol=0.000100][running kmeans]: 68it [01:32,  1.36s/it, center_shift=0.003062, iteration=68, tol=0.000100][running kmeans]: 68it [01:34,  1.36s/it, center_shift=0.002528, iteration=69, tol=0.000100][running kmeans]: 69it [01:34,  1.34s/it, center_shift=0.002528, iteration=69, tol=0.000100][running kmeans]: 69it [01:35,  1.34s/it, center_shift=0.002801, iteration=70, tol=0.000100][running kmeans]: 70it [01:35,  1.34s/it, center_shift=0.002801, iteration=70, tol=0.000100][running kmeans]: 70it [01:37,  1.34s/it, center_shift=0.002216, iteration=71, tol=0.000100][running kmeans]: 71it [01:37,  1.39s/it, center_shift=0.002216, iteration=71, tol=0.000100][running kmeans]: 71it [01:38,  1.39s/it, center_shift=0.002061, iteration=72, tol=0.000100][running kmeans]: 72it [01:38,  1.39s/it, center_shift=0.002061, iteration=72, tol=0.000100][running kmeans]: 72it [01:39,  1.39s/it, center_shift=0.002558, iteration=73, tol=0.000100][running kmeans]: 73it [01:39,  1.38s/it, center_shift=0.002558, iteration=73, tol=0.000100][running kmeans]: 73it [01:41,  1.38s/it, center_shift=0.001156, iteration=74, tol=0.000100][running kmeans]: 74it [01:41,  1.38s/it, center_shift=0.001156, iteration=74, tol=0.000100][running kmeans]: 74it [01:42,  1.38s/it, center_shift=0.001755, iteration=75, tol=0.000100][running kmeans]: 75it [01:42,  1.40s/it, center_shift=0.001755, iteration=75, tol=0.000100][running kmeans]: 75it [01:43,  1.40s/it, center_shift=0.001364, iteration=76, tol=0.000100][running kmeans]: 76it [01:43,  1.37s/it, center_shift=0.001364, iteration=76, tol=0.000100][running kmeans]: 76it [01:45,  1.37s/it, center_shift=0.001375, iteration=77, tol=0.000100][running kmeans]: 77it [01:45,  1.34s/it, center_shift=0.001375, iteration=77, tol=0.000100][running kmeans]: 77it [01:46,  1.34s/it, center_shift=0.001234, iteration=78, tol=0.000100][running kmeans]: 78it [01:46,  1.38s/it, center_shift=0.001234, iteration=78, tol=0.000100][running kmeans]: 78it [01:47,  1.38s/it, center_shift=0.001132, iteration=79, tol=0.000100][running kmeans]: 79it [01:47,  1.36s/it, center_shift=0.001132, iteration=79, tol=0.000100][running kmeans]: 79it [01:49,  1.36s/it, center_shift=0.001906, iteration=80, tol=0.000100][running kmeans]: 80it [01:49,  1.38s/it, center_shift=0.001906, iteration=80, tol=0.000100][running kmeans]: 80it [01:50,  1.38s/it, center_shift=0.001981, iteration=81, tol=0.000100][running kmeans]: 81it [01:50,  1.45s/it, center_shift=0.001981, iteration=81, tol=0.000100][running kmeans]: 81it [01:52,  1.45s/it, center_shift=0.001765, iteration=82, tol=0.000100][running kmeans]: 82it [01:52,  1.43s/it, center_shift=0.001765, iteration=82, tol=0.000100][running kmeans]: 82it [01:53,  1.43s/it, center_shift=0.001934, iteration=83, tol=0.000100][running kmeans]: 83it [01:53,  1.41s/it, center_shift=0.001934, iteration=83, tol=0.000100][running kmeans]: 83it [01:55,  1.41s/it, center_shift=0.003323, iteration=84, tol=0.000100][running kmeans]: 84it [01:55,  1.48s/it, center_shift=0.003323, iteration=84, tol=0.000100][running kmeans]: 84it [01:56,  1.48s/it, center_shift=0.003761, iteration=85, tol=0.000100][running kmeans]: 85it [01:56,  1.37s/it, center_shift=0.003761, iteration=85, tol=0.000100][running kmeans]: 85it [01:57,  1.37s/it, center_shift=0.001305, iteration=86, tol=0.000100][running kmeans]: 86it [01:57,  1.30s/it, center_shift=0.001305, iteration=86, tol=0.000100][running kmeans]: 86it [01:58,  1.30s/it, center_shift=0.003056, iteration=87, tol=0.000100][running kmeans]: 87it [01:58,  1.31s/it, center_shift=0.003056, iteration=87, tol=0.000100][running kmeans]: 87it [02:00,  1.31s/it, center_shift=0.002750, iteration=88, tol=0.000100][running kmeans]: 88it [02:00,  1.29s/it, center_shift=0.002750, iteration=88, tol=0.000100][running kmeans]: 88it [02:01,  1.29s/it, center_shift=0.001452, iteration=89, tol=0.000100][running kmeans]: 89it [02:01,  1.24s/it, center_shift=0.001452, iteration=89, tol=0.000100][running kmeans]: 89it [02:02,  1.24s/it, center_shift=0.002789, iteration=90, tol=0.000100][running kmeans]: 90it [02:02,  1.20s/it, center_shift=0.002789, iteration=90, tol=0.000100][running kmeans]: 90it [02:03,  1.20s/it, center_shift=0.002928, iteration=91, tol=0.000100][running kmeans]: 91it [02:03,  1.24s/it, center_shift=0.002928, iteration=91, tol=0.000100][running kmeans]: 91it [02:04,  1.24s/it, center_shift=0.004614, iteration=92, tol=0.000100][running kmeans]: 92it [02:04,  1.22s/it, center_shift=0.004614, iteration=92, tol=0.000100][running kmeans]: 92it [02:06,  1.22s/it, center_shift=0.006130, iteration=93, tol=0.000100][running kmeans]: 93it [02:06,  1.24s/it, center_shift=0.006130, iteration=93, tol=0.000100][running kmeans]: 93it [02:07,  1.24s/it, center_shift=0.006509, iteration=94, tol=0.000100][running kmeans]: 94it [02:07,  1.22s/it, center_shift=0.006509, iteration=94, tol=0.000100][running kmeans]: 94it [02:08,  1.22s/it, center_shift=0.005545, iteration=95, tol=0.000100][running kmeans]: 95it [02:08,  1.15s/it, center_shift=0.005545, iteration=95, tol=0.000100][running kmeans]: 95it [02:09,  1.15s/it, center_shift=0.003459, iteration=96, tol=0.000100][running kmeans]: 96it [02:09,  1.18s/it, center_shift=0.003459, iteration=96, tol=0.000100][running kmeans]: 96it [02:10,  1.18s/it, center_shift=0.003950, iteration=97, tol=0.000100][running kmeans]: 97it [02:10,  1.16s/it, center_shift=0.003950, iteration=97, tol=0.000100][running kmeans]: 97it [02:11,  1.16s/it, center_shift=0.002646, iteration=98, tol=0.000100][running kmeans]: 98it [02:11,  1.17s/it, center_shift=0.002646, iteration=98, tol=0.000100][running kmeans]: 98it [02:13,  1.17s/it, center_shift=0.001136, iteration=99, tol=0.000100][running kmeans]: 99it [02:13,  1.18s/it, center_shift=0.001136, iteration=99, tol=0.000100][running kmeans]: 99it [02:14,  1.18s/it, center_shift=0.000968, iteration=100, tol=0.000100][running kmeans]: 100it [02:14,  1.20s/it, center_shift=0.000968, iteration=100, tol=0.000100][running kmeans]: 100it [02:15,  1.20s/it, center_shift=0.000235, iteration=101, tol=0.000100][running kmeans]: 101it [02:15,  1.19s/it, center_shift=0.000235, iteration=101, tol=0.000100][running kmeans]: 101it [02:16,  1.19s/it, center_shift=0.000884, iteration=102, tol=0.000100][running kmeans]: 102it [02:16,  1.16s/it, center_shift=0.000884, iteration=102, tol=0.000100][running kmeans]: 102it [02:17,  1.16s/it, center_shift=0.000777, iteration=103, tol=0.000100][running kmeans]: 103it [02:17,  1.20s/it, center_shift=0.000777, iteration=103, tol=0.000100][running kmeans]: 103it [02:19,  1.20s/it, center_shift=0.001229, iteration=104, tol=0.000100][running kmeans]: 104it [02:19,  1.19s/it, center_shift=0.001229, iteration=104, tol=0.000100][running kmeans]: 104it [02:20,  1.19s/it, center_shift=0.000634, iteration=105, tol=0.000100][running kmeans]: 105it [02:20,  1.19s/it, center_shift=0.000634, iteration=105, tol=0.000100][running kmeans]: 105it [02:21,  1.19s/it, center_shift=0.000690, iteration=106, tol=0.000100][running kmeans]: 106it [02:21,  1.18s/it, center_shift=0.000690, iteration=106, tol=0.000100][running kmeans]: 106it [02:22,  1.18s/it, center_shift=0.000458, iteration=107, tol=0.000100][running kmeans]: 107it [02:22,  1.17s/it, center_shift=0.000458, iteration=107, tol=0.000100][running kmeans]: 107it [02:24,  1.17s/it, center_shift=0.000113, iteration=108, tol=0.000100][running kmeans]: 108it [02:24,  1.24s/it, center_shift=0.000113, iteration=108, tol=0.000100][running kmeans]: 108it [02:25,  1.24s/it, center_shift=0.000211, iteration=109, tol=0.000100][running kmeans]: 109it [02:25,  1.26s/it, center_shift=0.000211, iteration=109, tol=0.000100][running kmeans]: 109it [02:26,  1.26s/it, center_shift=0.000088, iteration=110, tol=0.000100][running kmeans]: 110it [02:26,  1.27s/it, center_shift=0.000088, iteration=110, tol=0.000100][running kmeans]: 110it [02:26,  1.33s/it, center_shift=0.000088, iteration=110, tol=0.000100]
predicting on cuda:1..
tensor([25,  9,  5,  ..., 14,  2,  6])
Epoch 0, loss_inner: 3.71398, loss_target: 3.69828, homo loss: 0.47158 
acc_train_clean: 0.0024, ASR_train_attach: 0.0000, ASR_train_outter: 0.0842
Traceback (most recent call last):
  File "run.py", line 258, in <module>
    model.fit(data.x, train_edge_index, None, data.y, idx_train,idx_attach, unlabeled_idx)
  File "/home/project-graph-backdoor/Backdoor/models/backdoor.py", line 506, in fit
    loss_outter.backward()
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 7.21 GiB (GPU 1; 47.54 GiB total capacity; 26.70 GiB already allocated; 461.31 MiB free; 46.12 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
