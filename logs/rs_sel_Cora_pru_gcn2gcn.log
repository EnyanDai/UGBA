nohup: ignoring input
Namespace(attack_method='Rand_Samp', cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=1, dropout=0.5, epochs=200, hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=10, selection_method='cluster', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Length of training set: 541
Training benign model Finished!
Total time elapsed: 4.0617s
Benign CA: 0.8444
Length of training set: 541
=== training gcn model ===
Epoch 0, training loss: 1.9322519302368164
acc_val: 0.2926
Epoch 10, training loss: 1.8021061420440674
acc_val: 0.3037
Epoch 20, training loss: 1.7138646841049194
acc_val: 0.3037
Epoch 30, training loss: 1.4916402101516724
acc_val: 0.3704
Epoch 40, training loss: 1.2497543096542358
acc_val: 0.4222
Epoch 50, training loss: 1.079182505607605
acc_val: 0.4852
Epoch 60, training loss: 0.9507980942726135
acc_val: 0.5519
Epoch 70, training loss: 0.8186353445053101
acc_val: 0.5889
Epoch 80, training loss: 0.7561426758766174
acc_val: 0.6037
Epoch 90, training loss: 0.7051460146903992
acc_val: 0.6815
Epoch 100, training loss: 0.6418095827102661
acc_val: 0.7037
Epoch 110, training loss: 0.5879091620445251
acc_val: 0.6963
Epoch 120, training loss: 0.5704084038734436
acc_val: 0.7074
Epoch 130, training loss: 0.5387479066848755
acc_val: 0.7222
Epoch 140, training loss: 0.5039682984352112
acc_val: 0.7074
Epoch 150, training loss: 0.4950578510761261
acc_val: 0.7148
Epoch 160, training loss: 0.4649313688278198
acc_val: 0.7111
Epoch 170, training loss: 0.424276202917099
acc_val: 0.7259
Epoch 180, training loss: 0.42583391070365906
acc_val: 0.7111
Epoch 190, training loss: 0.39449867606163025
acc_val: 0.7333
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 3.2331s
Encoder CA on clean test nodes: 0.7889
[1 3 3 ... 5 1 1]
Epoch 0, loss_inner: 1.94548, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.2107, ASR_train_attach: 0.0476, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 1.71627, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.3198, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 1.54426, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.3512, ASR_train_attach: 0.0000, ASR_train_outter: 0.0225
Epoch 30, loss_inner: 1.36291, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.5712, ASR_train_attach: 0.3333, ASR_train_outter: 0.1144
Epoch 40, loss_inner: 1.17479, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.7542, ASR_train_attach: 0.5714, ASR_train_outter: 0.2889
Epoch 50, loss_inner: 0.99963, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.8096, ASR_train_attach: 0.7143, ASR_train_outter: 0.3396
Epoch 60, loss_inner: 0.85307, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.8226, ASR_train_attach: 0.7143, ASR_train_outter: 0.3771
Epoch 70, loss_inner: 0.73263, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.8614, ASR_train_attach: 0.6667, ASR_train_outter: 0.3752
Epoch 80, loss_inner: 0.63999, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.8835, ASR_train_attach: 0.7619, ASR_train_outter: 0.3602
Epoch 90, loss_inner: 0.57058, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.8928, ASR_train_attach: 0.7619, ASR_train_outter: 0.3527
Epoch 100, loss_inner: 0.51712, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9113, ASR_train_attach: 0.7619, ASR_train_outter: 0.3734
Epoch 110, loss_inner: 0.47533, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9242, ASR_train_attach: 0.8095, ASR_train_outter: 0.3527
Epoch 120, loss_inner: 0.44322, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9316, ASR_train_attach: 0.8095, ASR_train_outter: 0.3752
Epoch 130, loss_inner: 0.41634, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9335, ASR_train_attach: 0.8095, ASR_train_outter: 0.3227
Epoch 140, loss_inner: 0.39505, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9390, ASR_train_attach: 0.8095, ASR_train_outter: 0.3583
Epoch 150, loss_inner: 0.37772, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9390, ASR_train_attach: 0.7619, ASR_train_outter: 0.3265
Epoch 160, loss_inner: 0.36192, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9464, ASR_train_attach: 0.7619, ASR_train_outter: 0.3565
Epoch 170, loss_inner: 0.34938, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9482, ASR_train_attach: 0.8095, ASR_train_outter: 0.3640
Epoch 180, loss_inner: 0.33946, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9482, ASR_train_attach: 0.7619, ASR_train_outter: 0.3527
Epoch 190, loss_inner: 0.32786, loss_target: 0.00000, homo loss: 0.00000 
acc_train_clean: 0.9519, ASR_train_attach: 0.8095, ASR_train_outter: 0.3133
precent of left attach nodes: 1.000
target class rate on Vs: 0.9048
accuracy on clean test nodes: 0.7556
ASR: 0.2214
CA: 0.7333
