nohup: ignoring input
WARNING:root:The OGB package is out of date. Your version is 1.3.3, while the latest version is 1.3.4.
1
2
Namespace(attack_method='Basic', cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=0, dis_weight=1.0, dropout=0.5, epochs=200, hidden=128, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='cluster', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Length of training set: 17850
Training benign model Finished!
Total time elapsed: 8.1815s
Benign CA: 0.4722
Length of training set: 17850
=== training gcn model ===
Epoch 0, training loss: 1.940137267112732
acc_val: 0.4223
Epoch 10, training loss: 1.6328984498977661
acc_val: 0.4222
Epoch 20, training loss: 1.5902451276779175
acc_val: 0.4231
Epoch 30, training loss: 1.583495020866394
acc_val: 0.4240
Epoch 40, training loss: 1.5741158723831177
acc_val: 0.4303
Epoch 50, training loss: 1.555529236793518
acc_val: 0.4558
Epoch 60, training loss: 1.5387212038040161
acc_val: 0.4760
Epoch 70, training loss: 1.5235005617141724
acc_val: 0.4686
Epoch 80, training loss: 1.520551085472107
acc_val: 0.4793
Epoch 90, training loss: 1.5164480209350586
acc_val: 0.4791
Epoch 100, training loss: 1.5151103734970093
acc_val: 0.4771
Epoch 110, training loss: 1.5155184268951416
acc_val: 0.4876
Epoch 120, training loss: 1.5121114253997803
acc_val: 0.4821
Epoch 130, training loss: 1.5077452659606934
acc_val: 0.4755
Epoch 140, training loss: 1.5102015733718872
acc_val: 0.4861
Epoch 150, training loss: 1.5085554122924805
acc_val: 0.4897
Epoch 160, training loss: 1.4990538358688354
acc_val: 0.4893
Epoch 170, training loss: 1.501237154006958
acc_val: 0.4908
Epoch 180, training loss: 1.5114063024520874
acc_val: 0.4748
Epoch 190, training loss: 1.5023525953292847
acc_val: 0.4836
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 11.8363s
Encoder CA on clean test nodes: 0.4980
running k-means on cuda:0..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:00, ?it/s, center_shift=0.145261, iteration=1, tol=0.000100][running kmeans]: 1it [00:00,  5.39it/s, center_shift=0.020303, iteration=2, tol=0.000100][running kmeans]: 2it [00:00, 10.77it/s, center_shift=0.020303, iteration=2, tol=0.000100][running kmeans]: 2it [00:00, 10.77it/s, center_shift=0.013011, iteration=3, tol=0.000100][running kmeans]: 3it [00:00, 10.77it/s, center_shift=0.006229, iteration=4, tol=0.000100][running kmeans]: 4it [00:00, 10.98it/s, center_shift=0.006229, iteration=4, tol=0.000100][running kmeans]: 4it [00:00, 10.98it/s, center_shift=0.002636, iteration=5, tol=0.000100][running kmeans]: 5it [00:00, 10.98it/s, center_shift=0.001383, iteration=6, tol=0.000100][running kmeans]: 6it [00:00, 10.92it/s, center_shift=0.001383, iteration=6, tol=0.000100][running kmeans]: 6it [00:00, 10.92it/s, center_shift=0.000861, iteration=7, tol=0.000100][running kmeans]: 7it [00:00, 10.92it/s, center_shift=0.000655, iteration=8, tol=0.000100][running kmeans]: 8it [00:00, 11.16it/s, center_shift=0.000655, iteration=8, tol=0.000100][running kmeans]: 8it [00:00, 11.16it/s, center_shift=0.000423, iteration=9, tol=0.000100][running kmeans]: 9it [00:00, 11.16it/s, center_shift=0.000283, iteration=10, tol=0.000100][running kmeans]: 10it [00:00, 11.00it/s, center_shift=0.000283, iteration=10, tol=0.000100][running kmeans]: 10it [00:01, 11.00it/s, center_shift=0.000205, iteration=11, tol=0.000100][running kmeans]: 11it [00:01, 11.00it/s, center_shift=0.000141, iteration=12, tol=0.000100][running kmeans]: 12it [00:01, 10.91it/s, center_shift=0.000141, iteration=12, tol=0.000100][running kmeans]: 12it [00:01, 10.91it/s, center_shift=0.000102, iteration=13, tol=0.000100][running kmeans]: 13it [00:01, 10.91it/s, center_shift=0.000070, iteration=14, tol=0.000100][running kmeans]: 14it [00:01, 11.00it/s, center_shift=0.000070, iteration=14, tol=0.000100][running kmeans]: 14it [00:01, 10.98it/s, center_shift=0.000070, iteration=14, tol=0.000100]
predicting on cuda:0..
tensor([6, 0, 6,  ..., 5, 0, 0])
Epoch 0, loss_inner: 1.94612, loss_target: 1.90567, homo loss: 0.49787 
acc_train_clean: 0.2481, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 1.66527, loss_target: 1.62912, homo loss: 0.01152 
acc_train_clean: 0.4159, ASR_train_attach: 0.7087, ASR_train_outter: 0.8344
Epoch 20, loss_inner: 1.61529, loss_target: 1.57715, homo loss: 0.00830 
acc_train_clean: 0.4130, ASR_train_attach: 0.7549, ASR_train_outter: 0.8499
Epoch 30, loss_inner: 1.59878, loss_target: 1.56137, homo loss: 0.01087 
acc_train_clean: 0.4118, ASR_train_attach: 0.8515, ASR_train_outter: 0.9421
Epoch 40, loss_inner: 1.58470, loss_target: 1.54861, homo loss: 0.01254 
acc_train_clean: 0.4128, ASR_train_attach: 0.8936, ASR_train_outter: 0.9731
Epoch 50, loss_inner: 1.57217, loss_target: 1.53512, homo loss: 0.01174 
acc_train_clean: 0.4122, ASR_train_attach: 0.9566, ASR_train_outter: 0.9535
Epoch 60, loss_inner: 1.56254, loss_target: 1.52863, homo loss: 0.01313 
acc_train_clean: 0.4132, ASR_train_attach: 0.9538, ASR_train_outter: 0.9935
Epoch 70, loss_inner: 1.62682, loss_target: 1.52079, homo loss: 0.29174 
acc_train_clean: 0.4048, ASR_train_attach: 1.0000, ASR_train_outter: 0.9617
Epoch 80, loss_inner: 1.65148, loss_target: 1.61093, homo loss: 0.74646 
acc_train_clean: 0.4229, ASR_train_attach: 0.7241, ASR_train_outter: 0.9608
Epoch 90, loss_inner: 1.54969, loss_target: 1.51909, homo loss: 0.73473 
acc_train_clean: 0.4127, ASR_train_attach: 0.8964, ASR_train_outter: 0.9967
Epoch 100, loss_inner: 1.54438, loss_target: 1.50909, homo loss: 0.48628 
acc_train_clean: 0.4157, ASR_train_attach: 0.9832, ASR_train_outter: 0.9992
Epoch 110, loss_inner: 1.56456, loss_target: 1.63800, homo loss: 0.04294 
acc_train_clean: 0.4074, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 120, loss_inner: 1.61585, loss_target: 1.71791, homo loss: 0.06113 
acc_train_clean: 0.4240, ASR_train_attach: 0.4692, ASR_train_outter: 1.0000
Epoch 130, loss_inner: 1.54798, loss_target: 1.51663, homo loss: 0.15672 
acc_train_clean: 0.4199, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 140, loss_inner: 1.52708, loss_target: 1.48636, homo loss: 0.17710 
acc_train_clean: 0.4174, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 150, loss_inner: 1.52303, loss_target: 1.48185, homo loss: 0.14281 
acc_train_clean: 0.4179, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 160, loss_inner: 1.51731, loss_target: 1.47748, homo loss: 0.09874 
acc_train_clean: 0.4207, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 170, loss_inner: 1.56286, loss_target: 2.52329, homo loss: 0.01399 
acc_train_clean: 0.4110, ASR_train_attach: 0.9944, ASR_train_outter: 0.0000
Epoch 180, loss_inner: 1.61949, loss_target: 2.36920, homo loss: 0.30432 
acc_train_clean: 0.4206, ASR_train_attach: 0.9496, ASR_train_outter: 0.0000
Epoch 190, loss_inner: 4.92735, loss_target: 6.40362, homo loss: 0.43003 
acc_train_clean: 0.3792, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
precent of left attach nodes: 1.000
target class rate on Vs: 0.0000
accuracy on clean test nodes: 0.4308
ASR: 0.0000
CA: 0.4297
