nohup: ignoring input
Namespace(clean_test_nodes_num=200, cuda=True, dataset='citeseer', debug=True, defense_mode='prune', device_id=5, dropout=0.5, epochs=200, hidden=32, homo_boost_thrd=0.6, homo_loss_weight=1.0, load_benign_model=True, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=10, target_class=0, target_test_nodes_num=200, test_model='GCN', thrd=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Loading benign GCN model Finished!
Benign CA: 0.7100
Benign CA on clean test nodes: 0.6450
3327
200
tensor(1.8010, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(27.6000, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 0, training loss: 1.8009929656982422
acc_train_clean: 0.1479, acc_train_attach: 0.1304
tensor(1.5739, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(21.2796, device='cuda:5', grad_fn=<MulBackward0>)
tensor(1.3213, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(18.4777, device='cuda:5', grad_fn=<MulBackward0>)
tensor(1.0667, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(17.1251, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.8614, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(16.1932, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.6531, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(15.5384, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.5415, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(13.9678, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.4194, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(12.1442, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.3363, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(10.6601, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.2743, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(8.8068, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.2232, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(7.8117, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 10, training loss: 0.2232016921043396
acc_train_clean: 0.9521, acc_train_attach: 1.0000
tensor(0.2181, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(7.0254, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.1729, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(6.9704, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.1452, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(6.6850, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.1325, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(6.5300, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.1130, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(6.3080, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.1129, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(5.8426, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0876, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(5.1230, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0901, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(4.0242, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0893, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(2.8477, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0763, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.9997, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 20, training loss: 0.07633260637521744
acc_train_clean: 0.9729, acc_train_attach: 1.0000
tensor(0.0800, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.2380, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0675, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.1835, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0773, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.0631, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0807, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.9739, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0569, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.1338, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0533, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.8043, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0626, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.8056, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0607, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.7396, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0539, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.7264, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0511, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.7662, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 30, training loss: 0.05108350142836571
acc_train_clean: 0.9854, acc_train_attach: 1.0000
tensor(0.0599, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.8439, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0567, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.7477, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0623, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.5062, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0498, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.3598, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0587, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.5482, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0450, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.5291, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0463, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.3576, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0567, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.3932, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0546, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.5322, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0482, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2170, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 40, training loss: 0.04816538468003273
acc_train_clean: 0.9854, acc_train_attach: 1.0000
tensor(0.0582, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.3889, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0497, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1227, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0597, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0755, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0499, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2679, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0525, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.5099, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0515, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0962, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0573, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0311, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0493, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1162, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0494, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0801, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0563, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1600, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 50, training loss: 0.05626548081636429
acc_train_clean: 0.9875, acc_train_attach: 1.0000
tensor(0.0557, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2093, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0519, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0541, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0727, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0611, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0734, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0568, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0738, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0491, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0500, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0592, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0539, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0669, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0464, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0310, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0482, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1940, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 60, training loss: 0.04816460609436035
acc_train_clean: 0.9875, acc_train_attach: 1.0000
tensor(0.0606, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0311, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0492, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0268, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0471, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0110, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0512, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0516, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0396, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0523, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0224, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0541, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0700, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0775, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0489, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1704, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0594, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 70, training loss: 0.059365011751651764
acc_train_clean: 0.9917, acc_train_attach: 0.9565
tensor(0.0483, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0520, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0626, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0526, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0617, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0773, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0425, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0419, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0959, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0542, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0528, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0086, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0457, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1856, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0565, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0738, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 80, training loss: 0.05645289272069931
acc_train_clean: 0.9812, acc_train_attach: 0.9565
tensor(0.0475, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0922, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0427, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(1.1921e-07, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0478, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0035, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0471, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1262, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0515, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1139, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0411, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0490, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0426, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1119, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0475, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0873, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0475, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 90, training loss: 0.04751845449209213
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0466, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0386, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0976, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0428, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0514, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0033, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0429, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0224, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0433, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0413, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0355, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0450, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1066, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0451, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 100, training loss: 0.04513072595000267
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0400, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0510, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0364, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0386, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2545, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0441, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0385, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0345, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0471, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0098, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0398, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0458, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1464, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 110, training loss: 0.04581218212842941
acc_train_clean: 0.9854, acc_train_attach: 1.0000
tensor(0.0398, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0326, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0329, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0488, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0381, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0369, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0963, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0419, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0392, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0327, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0444, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0108, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0398, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 120, training loss: 0.03983543440699577
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0331, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0419, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0420, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1250, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0417, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0517, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0399, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0371, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0367, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0433, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0324, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 130, training loss: 0.03240825980901718
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0365, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0365, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0307, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0443, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0302, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0382, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0423, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0369, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1021, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0355, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0392, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1798, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0373, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0159, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 140, training loss: 0.03725609555840492
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0356, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0306, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0308, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0357, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0406, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0415, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0058, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0321, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0526, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0475, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0369, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0375, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0305, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
Epoch 150, training loss: 0.030547840520739555
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0356, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0573, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0392, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0342, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0421, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0452, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0832, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0392, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0355, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0211, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0385, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0532, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0406, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0406, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 160, training loss: 0.04063279926776886
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor(0.0348, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0386, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0409, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0389, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0322, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0302, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0380, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0437, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0211, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0403, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0505, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0344, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0303, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2115, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 170, training loss: 0.030265914276242256
acc_train_clean: 0.9938, acc_train_attach: 1.0000
tensor(0.0317, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0979, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0409, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0338, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0371, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0873, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0322, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0453, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0356, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.2247, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0335, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0352, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1615, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0305, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0079, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0340, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0624, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0318, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0058, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 180, training loss: 0.03183095529675484
acc_train_clean: 0.9938, acc_train_attach: 1.0000
tensor(0.0446, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0582, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0330, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0145, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0344, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0321, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0264, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0156, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0363, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0098, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0320, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0488, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0369, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0375, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0318, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0598, device='cuda:5', grad_fn=<MulBackward0>)
Epoch 190, training loss: 0.03181776404380798
acc_train_clean: 0.9917, acc_train_attach: 1.0000
tensor(0.0325, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0374, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0071, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0320, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0310, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0307, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0369, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.1747, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0336, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0., device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0394, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0378, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0383, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0375, device='cuda:5', grad_fn=<MulBackward0>)
tensor(0.0378, device='cuda:5', grad_fn=<NllLossBackward0>) tensor(0.0211, device='cuda:5', grad_fn=<MulBackward0>)
503
503
4454 2306
{1152, 2062, 1945, 3239, 1461, 57, 2371, 195, 2118, 1478, 1481, 2506, 1741, 1366, 3031, 1115, 3038, 3294, 350, 2537, 1778, 499, 1785}
=== training gcn model ===
Epoch 0, training loss: 1.8040162324905396
acc_val: 0.4375
Epoch 10, training loss: 0.2283579707145691
acc_val: 0.6475
Epoch 20, training loss: 0.07946524769067764
acc_val: 0.6475
Epoch 30, training loss: 0.056803397834300995
acc_val: 0.6475
Epoch 40, training loss: 0.060137923806905746
acc_val: 0.6425
Epoch 50, training loss: 0.045923877507448196
acc_val: 0.6500
Epoch 60, training loss: 0.049407944083213806
acc_val: 0.6500
Epoch 70, training loss: 0.045373786240816116
acc_val: 0.6475
Epoch 80, training loss: 0.042588744312524796
acc_val: 0.6475
Epoch 90, training loss: 0.04069415479898453
acc_val: 0.6525
Epoch 100, training loss: 0.045175712555646896
acc_val: 0.6425
Epoch 110, training loss: 0.03928813710808754
acc_val: 0.6475
Epoch 120, training loss: 0.039318837225437164
acc_val: 0.6500
Epoch 130, training loss: 0.0312005914747715
acc_val: 0.6375
Epoch 140, training loss: 0.04139023646712303
acc_val: 0.6450
Epoch 150, training loss: 0.033888064324855804
acc_val: 0.6450
Epoch 160, training loss: 0.03585260733962059
acc_val: 0.6475
Epoch 170, training loss: 0.03575604408979416
acc_val: 0.6275
Epoch 180, training loss: 0.03444058448076248
acc_val: 0.6625
Epoch 190, training loss: 0.03804544731974602
acc_val: 0.6400
=== picking the best model according to the performance on validation ===
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.7150
ASR: 0.8000
CA: 0.6200
