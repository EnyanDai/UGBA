nohup: ignoring input
Namespace(attack_method='Basic', cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, use_vs_number=False, vs_number=0, vs_ratio=0.001, weight_decay=0.0005)
Length of training set: 33868
Training benign model Finished!
Total time elapsed: 39.3212s
Benign CA: 0.6623
Length of training set: 33868
=== training gcn model ===
Epoch 0, training loss: 3.6526169776916504
acc_val: 0.1333
Epoch 10, training loss: 2.751763105392456
acc_val: 0.2825
Epoch 20, training loss: 2.2286064624786377
acc_val: 0.4160
Epoch 30, training loss: 1.93708336353302
acc_val: 0.5169
Epoch 40, training loss: 1.7818117141723633
acc_val: 0.5514
Epoch 50, training loss: 1.674763798713684
acc_val: 0.5772
Epoch 60, training loss: 1.6104705333709717
acc_val: 0.5956
Epoch 70, training loss: 1.5685280561447144
acc_val: 0.6062
Epoch 80, training loss: 1.5407723188400269
acc_val: 0.6202
Epoch 90, training loss: 1.5165632963180542
acc_val: 0.6169
Epoch 100, training loss: 1.5052522420883179
acc_val: 0.6274
Epoch 110, training loss: 1.492020845413208
acc_val: 0.6236
Epoch 120, training loss: 1.467665195465088
acc_val: 0.6338
Epoch 130, training loss: 1.4635690450668335
acc_val: 0.6343
Epoch 140, training loss: 1.4558981657028198
acc_val: 0.6292
Epoch 150, training loss: 1.4529757499694824
acc_val: 0.6365
Epoch 160, training loss: 1.4436343908309937
acc_val: 0.6378
Epoch 170, training loss: 1.4376065731048584
acc_val: 0.6396
Epoch 180, training loss: 1.4254471063613892
acc_val: 0.6403
Epoch 190, training loss: 1.4287092685699463
acc_val: 0.6420
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 35.8974s
Encoder CA on clean test nodes: 0.6489
running k-means on cuda:2..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:06, ?it/s, center_shift=1246.528687, iteration=1, tol=0.000100][running kmeans]: 1it [00:06,  6.00s/it, center_shift=1246.528687, iteration=1, tol=0.000100][running kmeans]: 1it [00:10,  6.00s/it, center_shift=221.310318, iteration=2, tol=0.000100] [running kmeans]: 2it [00:10,  5.05s/it, center_shift=221.310318, iteration=2, tol=0.000100][running kmeans]: 2it [00:14,  5.05s/it, center_shift=93.286079, iteration=3, tol=0.000100] [running kmeans]: 3it [00:14,  4.68s/it, center_shift=93.286079, iteration=3, tol=0.000100][running kmeans]: 3it [00:20,  4.68s/it, center_shift=47.011684, iteration=4, tol=0.000100][running kmeans]: 4it [00:20,  5.19s/it, center_shift=47.011684, iteration=4, tol=0.000100][running kmeans]: 4it [00:22,  5.19s/it, center_shift=27.288446, iteration=5, tol=0.000100][running kmeans]: 5it [00:22,  3.94s/it, center_shift=27.288446, iteration=5, tol=0.000100][running kmeans]: 5it [00:25,  3.94s/it, center_shift=17.386642, iteration=6, tol=0.000100][running kmeans]: 6it [00:25,  3.53s/it, center_shift=17.386642, iteration=6, tol=0.000100][running kmeans]: 6it [00:28,  3.53s/it, center_shift=12.051169, iteration=7, tol=0.000100][running kmeans]: 7it [00:28,  3.36s/it, center_shift=12.051169, iteration=7, tol=0.000100][running kmeans]: 7it [00:30,  3.36s/it, center_shift=9.225424, iteration=8, tol=0.000100] [running kmeans]: 8it [00:30,  2.99s/it, center_shift=9.225424, iteration=8, tol=0.000100][running kmeans]: 8it [00:31,  2.99s/it, center_shift=7.243834, iteration=9, tol=0.000100][running kmeans]: 9it [00:31,  2.51s/it, center_shift=7.243834, iteration=9, tol=0.000100][running kmeans]: 9it [00:36,  2.51s/it, center_shift=5.955774, iteration=10, tol=0.000100][running kmeans]: 10it [00:36,  3.16s/it, center_shift=5.955774, iteration=10, tol=0.000100][running kmeans]: 10it [00:39,  3.16s/it, center_shift=5.466000, iteration=11, tol=0.000100][running kmeans]: 11it [00:39,  3.18s/it, center_shift=5.466000, iteration=11, tol=0.000100][running kmeans]: 11it [00:44,  3.18s/it, center_shift=4.865478, iteration=12, tol=0.000100][running kmeans]: 12it [00:44,  3.60s/it, center_shift=4.865478, iteration=12, tol=0.000100][running kmeans]: 12it [00:46,  3.60s/it, center_shift=4.248448, iteration=13, tol=0.000100][running kmeans]: 13it [00:46,  3.37s/it, center_shift=4.248448, iteration=13, tol=0.000100][running kmeans]: 13it [00:50,  3.37s/it, center_shift=3.434689, iteration=14, tol=0.000100][running kmeans]: 14it [00:50,  3.33s/it, center_shift=3.434689, iteration=14, tol=0.000100][running kmeans]: 14it [00:52,  3.33s/it, center_shift=2.750588, iteration=15, tol=0.000100][running kmeans]: 15it [00:52,  3.03s/it, center_shift=2.750588, iteration=15, tol=0.000100][running kmeans]: 15it [00:54,  3.03s/it, center_shift=2.276062, iteration=16, tol=0.000100][running kmeans]: 16it [00:54,  2.76s/it, center_shift=2.276062, iteration=16, tol=0.000100][running kmeans]: 16it [00:57,  2.76s/it, center_shift=1.834573, iteration=17, tol=0.000100][running kmeans]: 17it [00:57,  2.75s/it, center_shift=1.834573, iteration=17, tol=0.000100][running kmeans]: 17it [01:00,  2.75s/it, center_shift=1.333319, iteration=18, tol=0.000100][running kmeans]: 18it [01:00,  2.99s/it, center_shift=1.333319, iteration=18, tol=0.000100][running kmeans]: 18it [01:02,  2.99s/it, center_shift=1.033009, iteration=19, tol=0.000100][running kmeans]: 19it [01:02,  2.70s/it, center_shift=1.033009, iteration=19, tol=0.000100][running kmeans]: 19it [01:05,  2.70s/it, center_shift=0.856095, iteration=20, tol=0.000100][running kmeans]: 20it [01:05,  2.55s/it, center_shift=0.856095, iteration=20, tol=0.000100][running kmeans]: 20it [01:06,  2.55s/it, center_shift=1.159458, iteration=21, tol=0.000100][running kmeans]: 21it [01:06,  2.17s/it, center_shift=1.159458, iteration=21, tol=0.000100][running kmeans]: 21it [01:08,  2.17s/it, center_shift=1.265520, iteration=22, tol=0.000100][running kmeans]: 22it [01:08,  2.10s/it, center_shift=1.265520, iteration=22, tol=0.000100][running kmeans]: 22it [01:10,  2.10s/it, center_shift=1.122298, iteration=23, tol=0.000100][running kmeans]: 23it [01:10,  2.19s/it, center_shift=1.122298, iteration=23, tol=0.000100][running kmeans]: 23it [01:12,  2.19s/it, center_shift=0.596931, iteration=24, tol=0.000100][running kmeans]: 24it [01:12,  2.17s/it, center_shift=0.596931, iteration=24, tol=0.000100][running kmeans]: 24it [01:14,  2.17s/it, center_shift=0.714952, iteration=25, tol=0.000100][running kmeans]: 25it [01:14,  2.02s/it, center_shift=0.714952, iteration=25, tol=0.000100][running kmeans]: 25it [01:18,  2.02s/it, center_shift=0.386562, iteration=26, tol=0.000100][running kmeans]: 26it [01:18,  2.63s/it, center_shift=0.386562, iteration=26, tol=0.000100][running kmeans]: 26it [01:23,  2.63s/it, center_shift=0.377832, iteration=27, tol=0.000100][running kmeans]: 27it [01:23,  3.28s/it, center_shift=0.377832, iteration=27, tol=0.000100][running kmeans]: 27it [01:28,  3.28s/it, center_shift=0.356130, iteration=28, tol=0.000100][running kmeans]: 28it [01:28,  3.89s/it, center_shift=0.356130, iteration=28, tol=0.000100][running kmeans]: 28it [01:32,  3.89s/it, center_shift=0.285452, iteration=29, tol=0.000100][running kmeans]: 29it [01:32,  3.96s/it, center_shift=0.285452, iteration=29, tol=0.000100][running kmeans]: 29it [01:36,  3.96s/it, center_shift=0.242702, iteration=30, tol=0.000100][running kmeans]: 30it [01:36,  3.79s/it, center_shift=0.242702, iteration=30, tol=0.000100][running kmeans]: 30it [01:39,  3.79s/it, center_shift=0.194734, iteration=31, tol=0.000100][running kmeans]: 31it [01:39,  3.53s/it, center_shift=0.194734, iteration=31, tol=0.000100][running kmeans]: 31it [01:44,  3.53s/it, center_shift=0.237065, iteration=32, tol=0.000100][running kmeans]: 32it [01:44,  4.07s/it, center_shift=0.237065, iteration=32, tol=0.000100][running kmeans]: 32it [01:50,  4.07s/it, center_shift=0.174903, iteration=33, tol=0.000100][running kmeans]: 33it [01:50,  4.72s/it, center_shift=0.174903, iteration=33, tol=0.000100][running kmeans]: 33it [01:55,  4.72s/it, center_shift=0.158380, iteration=34, tol=0.000100][running kmeans]: 34it [01:55,  4.70s/it, center_shift=0.158380, iteration=34, tol=0.000100][running kmeans]: 34it [01:57,  4.70s/it, center_shift=0.152969, iteration=35, tol=0.000100][running kmeans]: 35it [01:57,  4.06s/it, center_shift=0.152969, iteration=35, tol=0.000100][running kmeans]: 35it [02:01,  4.06s/it, center_shift=0.130916, iteration=36, tol=0.000100][running kmeans]: 36it [02:01,  3.87s/it, center_shift=0.130916, iteration=36, tol=0.000100][running kmeans]: 36it [02:04,  3.87s/it, center_shift=0.118568, iteration=37, tol=0.000100][running kmeans]: 37it [02:04,  3.69s/it, center_shift=0.118568, iteration=37, tol=0.000100][running kmeans]: 37it [02:06,  3.69s/it, center_shift=0.109863, iteration=38, tol=0.000100][running kmeans]: 38it [02:06,  3.21s/it, center_shift=0.109863, iteration=38, tol=0.000100][running kmeans]: 38it [02:08,  3.21s/it, center_shift=0.106799, iteration=39, tol=0.000100][running kmeans]: 39it [02:08,  2.91s/it, center_shift=0.106799, iteration=39, tol=0.000100][running kmeans]: 39it [02:11,  2.91s/it, center_shift=0.090951, iteration=40, tol=0.000100][running kmeans]: 40it [02:11,  2.83s/it, center_shift=0.090951, iteration=40, tol=0.000100][running kmeans]: 40it [02:14,  2.83s/it, center_shift=0.084912, iteration=41, tol=0.000100][running kmeans]: 41it [02:14,  2.74s/it, center_shift=0.084912, iteration=41, tol=0.000100][running kmeans]: 41it [02:16,  2.74s/it, center_shift=0.065550, iteration=42, tol=0.000100][running kmeans]: 42it [02:16,  2.65s/it, center_shift=0.065550, iteration=42, tol=0.000100][running kmeans]: 42it [02:20,  2.65s/it, center_shift=0.067513, iteration=43, tol=0.000100][running kmeans]: 43it [02:20,  3.16s/it, center_shift=0.067513, iteration=43, tol=0.000100][running kmeans]: 43it [02:22,  3.16s/it, center_shift=0.058787, iteration=44, tol=0.000100][running kmeans]: 44it [02:22,  2.80s/it, center_shift=0.058787, iteration=44, tol=0.000100][running kmeans]: 44it [02:25,  2.80s/it, center_shift=0.047389, iteration=45, tol=0.000100][running kmeans]: 45it [02:25,  2.68s/it, center_shift=0.047389, iteration=45, tol=0.000100][running kmeans]: 45it [02:27,  2.68s/it, center_shift=0.044455, iteration=46, tol=0.000100][running kmeans]: 46it [02:27,  2.65s/it, center_shift=0.044455, iteration=46, tol=0.000100][running kmeans]: 46it [02:29,  2.65s/it, center_shift=0.041313, iteration=47, tol=0.000100][running kmeans]: 47it [02:29,  2.49s/it, center_shift=0.041313, iteration=47, tol=0.000100][running kmeans]: 47it [02:33,  2.49s/it, center_shift=0.027266, iteration=48, tol=0.000100][running kmeans]: 48it [02:33,  2.87s/it, center_shift=0.027266, iteration=48, tol=0.000100][running kmeans]: 48it [02:36,  2.87s/it, center_shift=0.023102, iteration=49, tol=0.000100][running kmeans]: 49it [02:36,  2.96s/it, center_shift=0.023102, iteration=49, tol=0.000100][running kmeans]: 49it [02:40,  2.96s/it, center_shift=0.019373, iteration=50, tol=0.000100][running kmeans]: 50it [02:40,  3.01s/it, center_shift=0.019373, iteration=50, tol=0.000100][running kmeans]: 50it [02:43,  3.01s/it, center_shift=0.016396, iteration=51, tol=0.000100][running kmeans]: 51it [02:43,  3.22s/it, center_shift=0.016396, iteration=51, tol=0.000100][running kmeans]: 51it [02:48,  3.22s/it, center_shift=0.016858, iteration=52, tol=0.000100][running kmeans]: 52it [02:48,  3.54s/it, center_shift=0.016858, iteration=52, tol=0.000100][running kmeans]: 52it [02:50,  3.54s/it, center_shift=0.013995, iteration=53, tol=0.000100][running kmeans]: 53it [02:50,  3.29s/it, center_shift=0.013995, iteration=53, tol=0.000100][running kmeans]: 53it [02:53,  3.29s/it, center_shift=0.012321, iteration=54, tol=0.000100][running kmeans]: 54it [02:53,  2.99s/it, center_shift=0.012321, iteration=54, tol=0.000100][running kmeans]: 54it [02:55,  2.99s/it, center_shift=0.013202, iteration=55, tol=0.000100][running kmeans]: 55it [02:55,  2.77s/it, center_shift=0.013202, iteration=55, tol=0.000100][running kmeans]: 55it [02:56,  2.77s/it, center_shift=0.011053, iteration=56, tol=0.000100][running kmeans]: 56it [02:56,  2.41s/it, center_shift=0.011053, iteration=56, tol=0.000100][running kmeans]: 56it [02:58,  2.41s/it, center_shift=0.011236, iteration=57, tol=0.000100][running kmeans]: 57it [02:58,  2.13s/it, center_shift=0.011236, iteration=57, tol=0.000100][running kmeans]: 57it [02:59,  2.13s/it, center_shift=0.007143, iteration=58, tol=0.000100][running kmeans]: 58it [02:59,  1.85s/it, center_shift=0.007143, iteration=58, tol=0.000100][running kmeans]: 58it [03:01,  1.85s/it, center_shift=0.007476, iteration=59, tol=0.000100][running kmeans]: 59it [03:01,  2.00s/it, center_shift=0.007476, iteration=59, tol=0.000100][running kmeans]: 59it [03:04,  2.00s/it, center_shift=0.005782, iteration=60, tol=0.000100][running kmeans]: 60it [03:04,  2.06s/it, center_shift=0.005782, iteration=60, tol=0.000100][running kmeans]: 60it [03:06,  2.06s/it, center_shift=0.004480, iteration=61, tol=0.000100][running kmeans]: 61it [03:06,  2.18s/it, center_shift=0.004480, iteration=61, tol=0.000100][running kmeans]: 61it [03:07,  2.18s/it, center_shift=0.005710, iteration=62, tol=0.000100][running kmeans]: 62it [03:07,  1.95s/it, center_shift=0.005710, iteration=62, tol=0.000100][running kmeans]: 62it [03:10,  1.95s/it, center_shift=0.004563, iteration=63, tol=0.000100][running kmeans]: 63it [03:10,  1.99s/it, center_shift=0.004563, iteration=63, tol=0.000100][running kmeans]: 63it [03:12,  1.99s/it, center_shift=0.003623, iteration=64, tol=0.000100][running kmeans]: 64it [03:12,  1.99s/it, center_shift=0.003623, iteration=64, tol=0.000100][running kmeans]: 64it [03:12,  1.99s/it, center_shift=0.004109, iteration=65, tol=0.000100][running kmeans]: 65it [03:12,  1.60s/it, center_shift=0.004109, iteration=65, tol=0.000100][running kmeans]: 65it [03:14,  1.60s/it, center_shift=0.003502, iteration=66, tol=0.000100][running kmeans]: 66it [03:14,  1.61s/it, center_shift=0.003502, iteration=66, tol=0.000100][running kmeans]: 66it [03:16,  1.61s/it, center_shift=0.004125, iteration=67, tol=0.000100][running kmeans]: 67it [03:16,  1.80s/it, center_shift=0.004125, iteration=67, tol=0.000100][running kmeans]: 67it [03:19,  1.80s/it, center_shift=0.004663, iteration=68, tol=0.000100][running kmeans]: 68it [03:19,  2.27s/it, center_shift=0.004663, iteration=68, tol=0.000100][running kmeans]: 68it [03:21,  2.27s/it, center_shift=0.006145, iteration=69, tol=0.000100][running kmeans]: 69it [03:21,  1.97s/it, center_shift=0.006145, iteration=69, tol=0.000100][running kmeans]: 69it [03:22,  1.97s/it, center_shift=0.007855, iteration=70, tol=0.000100][running kmeans]: 70it [03:22,  1.83s/it, center_shift=0.007855, iteration=70, tol=0.000100][running kmeans]: 70it [03:25,  1.83s/it, center_shift=0.006099, iteration=71, tol=0.000100][running kmeans]: 71it [03:25,  2.11s/it, center_shift=0.006099, iteration=71, tol=0.000100][running kmeans]: 71it [03:27,  2.11s/it, center_shift=0.005931, iteration=72, tol=0.000100][running kmeans]: 72it [03:27,  2.14s/it, center_shift=0.005931, iteration=72, tol=0.000100][running kmeans]: 72it [03:31,  2.14s/it, center_shift=0.013252, iteration=73, tol=0.000100][running kmeans]: 73it [03:31,  2.78s/it, center_shift=0.013252, iteration=73, tol=0.000100][running kmeans]: 73it [03:35,  2.78s/it, center_shift=0.005850, iteration=74, tol=0.000100][running kmeans]: 74it [03:35,  3.10s/it, center_shift=0.005850, iteration=74, tol=0.000100][running kmeans]: 74it [03:40,  3.10s/it, center_shift=0.005214, iteration=75, tol=0.000100][running kmeans]: 75it [03:40,  3.58s/it, center_shift=0.005214, iteration=75, tol=0.000100][running kmeans]: 75it [03:45,  3.58s/it, center_shift=0.005605, iteration=76, tol=0.000100][running kmeans]: 76it [03:45,  4.01s/it, center_shift=0.005605, iteration=76, tol=0.000100][running kmeans]: 76it [03:48,  4.01s/it, center_shift=0.005589, iteration=77, tol=0.000100][running kmeans]: 77it [03:48,  3.55s/it, center_shift=0.005589, iteration=77, tol=0.000100][running kmeans]: 77it [03:50,  3.55s/it, center_shift=0.006542, iteration=78, tol=0.000100][running kmeans]: 78it [03:50,  3.13s/it, center_shift=0.006542, iteration=78, tol=0.000100][running kmeans]: 78it [03:52,  3.13s/it, center_shift=0.009211, iteration=79, tol=0.000100][running kmeans]: 79it [03:52,  2.78s/it, center_shift=0.009211, iteration=79, tol=0.000100][running kmeans]: 79it [03:53,  2.78s/it, center_shift=0.009511, iteration=80, tol=0.000100][running kmeans]: 80it [03:53,  2.38s/it, center_shift=0.009511, iteration=80, tol=0.000100][running kmeans]: 80it [03:55,  2.38s/it, center_shift=0.009160, iteration=81, tol=0.000100][running kmeans]: 81it [03:55,  2.27s/it, center_shift=0.009160, iteration=81, tol=0.000100][running kmeans]: 81it [03:57,  2.27s/it, center_shift=0.007173, iteration=82, tol=0.000100][running kmeans]: 82it [03:57,  2.21s/it, center_shift=0.007173, iteration=82, tol=0.000100][running kmeans]: 82it [03:59,  2.21s/it, center_shift=0.008925, iteration=83, tol=0.000100][running kmeans]: 83it [03:59,  2.09s/it, center_shift=0.008925, iteration=83, tol=0.000100][running kmeans]: 83it [04:01,  2.09s/it, center_shift=0.005747, iteration=84, tol=0.000100][running kmeans]: 84it [04:01,  2.12s/it, center_shift=0.005747, iteration=84, tol=0.000100][running kmeans]: 84it [04:04,  2.12s/it, center_shift=0.006435, iteration=85, tol=0.000100][running kmeans]: 85it [04:04,  2.38s/it, center_shift=0.006435, iteration=85, tol=0.000100][running kmeans]: 85it [04:10,  2.38s/it, center_shift=0.007471, iteration=86, tol=0.000100][running kmeans]: 86it [04:10,  3.28s/it, center_shift=0.007471, iteration=86, tol=0.000100][running kmeans]: 86it [04:12,  3.28s/it, center_shift=0.004334, iteration=87, tol=0.000100][running kmeans]: 87it [04:12,  3.12s/it, center_shift=0.004334, iteration=87, tol=0.000100][running kmeans]: 87it [04:15,  3.12s/it, center_shift=0.003660, iteration=88, tol=0.000100][running kmeans]: 88it [04:15,  3.00s/it, center_shift=0.003660, iteration=88, tol=0.000100][running kmeans]: 88it [04:19,  3.00s/it, center_shift=0.002632, iteration=89, tol=0.000100][running kmeans]: 89it [04:19,  3.42s/it, center_shift=0.002632, iteration=89, tol=0.000100][running kmeans]: 89it [04:22,  3.42s/it, center_shift=0.002343, iteration=90, tol=0.000100][running kmeans]: 90it [04:22,  3.22s/it, center_shift=0.002343, iteration=90, tol=0.000100][running kmeans]: 90it [04:24,  3.22s/it, center_shift=0.003359, iteration=91, tol=0.000100][running kmeans]: 91it [04:24,  2.88s/it, center_shift=0.003359, iteration=91, tol=0.000100][running kmeans]: 91it [04:26,  2.88s/it, center_shift=0.002768, iteration=92, tol=0.000100][running kmeans]: 92it [04:26,  2.46s/it, center_shift=0.002768, iteration=92, tol=0.000100][running kmeans]: 92it [04:30,  2.46s/it, center_shift=0.001723, iteration=93, tol=0.000100][running kmeans]: 93it [04:30,  3.03s/it, center_shift=0.001723, iteration=93, tol=0.000100][running kmeans]: 93it [04:33,  3.03s/it, center_shift=0.002492, iteration=94, tol=0.000100][running kmeans]: 94it [04:33,  3.07s/it, center_shift=0.002492, iteration=94, tol=0.000100][running kmeans]: 94it [04:37,  3.07s/it, center_shift=0.002415, iteration=95, tol=0.000100][running kmeans]: 95it [04:37,  3.30s/it, center_shift=0.002415, iteration=95, tol=0.000100][running kmeans]: 95it [04:40,  3.30s/it, center_shift=0.001929, iteration=96, tol=0.000100][running kmeans]: 96it [04:40,  3.31s/it, center_shift=0.001929, iteration=96, tol=0.000100][running kmeans]: 96it [04:45,  3.31s/it, center_shift=0.002698, iteration=97, tol=0.000100][running kmeans]: 97it [04:45,  3.67s/it, center_shift=0.002698, iteration=97, tol=0.000100][running kmeans]: 97it [04:48,  3.67s/it, center_shift=0.002442, iteration=98, tol=0.000100][running kmeans]: 98it [04:48,  3.60s/it, center_shift=0.002442, iteration=98, tol=0.000100][running kmeans]: 98it [04:53,  3.60s/it, center_shift=0.002548, iteration=99, tol=0.000100][running kmeans]: 99it [04:53,  3.77s/it, center_shift=0.002548, iteration=99, tol=0.000100][running kmeans]: 99it [04:56,  3.77s/it, center_shift=0.002646, iteration=100, tol=0.000100][running kmeans]: 100it [04:56,  3.71s/it, center_shift=0.002646, iteration=100, tol=0.000100][running kmeans]: 100it [04:59,  3.71s/it, center_shift=0.002878, iteration=101, tol=0.000100][running kmeans]: 101it [04:59,  3.45s/it, center_shift=0.002878, iteration=101, tol=0.000100][running kmeans]: 101it [05:02,  3.45s/it, center_shift=0.003506, iteration=102, tol=0.000100][running kmeans]: 102it [05:02,  3.30s/it, center_shift=0.003506, iteration=102, tol=0.000100][running kmeans]: 102it [05:05,  3.30s/it, center_shift=0.003004, iteration=103, tol=0.000100][running kmeans]: 103it [05:05,  3.29s/it, center_shift=0.003004, iteration=103, tol=0.000100][running kmeans]: 103it [05:08,  3.29s/it, center_shift=0.002215, iteration=104, tol=0.000100][running kmeans]: 104it [05:08,  3.08s/it, center_shift=0.002215, iteration=104, tol=0.000100][running kmeans]: 104it [05:10,  3.08s/it, center_shift=0.001498, iteration=105, tol=0.000100][running kmeans]: 105it [05:10,  2.97s/it, center_shift=0.001498, iteration=105, tol=0.000100][running kmeans]: 105it [05:15,  2.97s/it, center_shift=0.001193, iteration=106, tol=0.000100][running kmeans]: 106it [05:15,  3.34s/it, center_shift=0.001193, iteration=106, tol=0.000100][running kmeans]: 106it [05:19,  3.34s/it, center_shift=0.000751, iteration=107, tol=0.000100][running kmeans]: 107it [05:19,  3.57s/it, center_shift=0.000751, iteration=107, tol=0.000100][running kmeans]: 107it [05:21,  3.57s/it, center_shift=0.000693, iteration=108, tol=0.000100][running kmeans]: 108it [05:21,  3.24s/it, center_shift=0.000693, iteration=108, tol=0.000100][running kmeans]: 108it [05:25,  3.24s/it, center_shift=0.000981, iteration=109, tol=0.000100][running kmeans]: 109it [05:25,  3.46s/it, center_shift=0.000981, iteration=109, tol=0.000100][running kmeans]: 109it [05:29,  3.46s/it, center_shift=0.000801, iteration=110, tol=0.000100][running kmeans]: 110it [05:29,  3.56s/it, center_shift=0.000801, iteration=110, tol=0.000100][running kmeans]: 110it [05:33,  3.56s/it, center_shift=0.000833, iteration=111, tol=0.000100][running kmeans]: 111it [05:33,  3.63s/it, center_shift=0.000833, iteration=111, tol=0.000100][running kmeans]: 111it [05:35,  3.63s/it, center_shift=0.001234, iteration=112, tol=0.000100][running kmeans]: 112it [05:35,  3.35s/it, center_shift=0.001234, iteration=112, tol=0.000100][running kmeans]: 112it [05:40,  3.35s/it, center_shift=0.001008, iteration=113, tol=0.000100][running kmeans]: 113it [05:40,  3.58s/it, center_shift=0.001008, iteration=113, tol=0.000100][running kmeans]: 113it [05:43,  3.58s/it, center_shift=0.000552, iteration=114, tol=0.000100][running kmeans]: 114it [05:43,  3.49s/it, center_shift=0.000552, iteration=114, tol=0.000100][running kmeans]: 114it [05:47,  3.49s/it, center_shift=0.000599, iteration=115, tol=0.000100][running kmeans]: 115it [05:47,  3.67s/it, center_shift=0.000599, iteration=115, tol=0.000100][running kmeans]: 115it [05:49,  3.67s/it, center_shift=0.000594, iteration=116, tol=0.000100][running kmeans]: 116it [05:49,  3.26s/it, center_shift=0.000594, iteration=116, tol=0.000100][running kmeans]: 116it [05:52,  3.26s/it, center_shift=0.000209, iteration=117, tol=0.000100][running kmeans]: 117it [05:52,  3.05s/it, center_shift=0.000209, iteration=117, tol=0.000100][running kmeans]: 117it [05:55,  3.05s/it, center_shift=0.000102, iteration=118, tol=0.000100][running kmeans]: 118it [05:55,  3.12s/it, center_shift=0.000102, iteration=118, tol=0.000100][running kmeans]: 118it [05:59,  3.12s/it, center_shift=0.000065, iteration=119, tol=0.000100][running kmeans]: 119it [05:59,  3.36s/it, center_shift=0.000065, iteration=119, tol=0.000100][running kmeans]: 119it [05:59,  3.02s/it, center_shift=0.000065, iteration=119, tol=0.000100]
[ 4 28 28 ... 24  4  4]
Epoch 0, loss_inner: 3.65089, loss_target: 3.44929, homo loss: 0.00000 
acc_train_clean: 0.1599, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 2.78852, loss_target: 2.71552, homo loss: 0.00000 
acc_train_clean: 0.2827, ASR_train_attach: 1.0000, ASR_train_outter: 0.9490
Epoch 20, loss_inner: 2.36148, loss_target: 2.29869, homo loss: 0.00000 
acc_train_clean: 0.3655, ASR_train_attach: 1.0000, ASR_train_outter: 0.8764
Epoch 30, loss_inner: 1.97065, loss_target: 1.92676, homo loss: 0.00000 
acc_train_clean: 0.4966, ASR_train_attach: 1.0000, ASR_train_outter: 0.9057
Epoch 40, loss_inner: 1.71085, loss_target: 1.69183, homo loss: 0.00000 
acc_train_clean: 0.5518, ASR_train_attach: 1.0000, ASR_train_outter: 0.7898
Epoch 50, loss_inner: 1.57680, loss_target: 1.61264, homo loss: 0.00000 
acc_train_clean: 0.5777, ASR_train_attach: 1.0000, ASR_train_outter: 0.9845
Epoch 60, loss_inner: 1.48058, loss_target: 1.47926, homo loss: 0.00000 
acc_train_clean: 0.5948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9753
Epoch 70, loss_inner: 1.41275, loss_target: 1.40366, homo loss: 0.00000 
acc_train_clean: 0.6072, ASR_train_attach: 1.0000, ASR_train_outter: 0.9444
Epoch 80, loss_inner: 1.36009, loss_target: 1.34110, homo loss: 0.00000 
acc_train_clean: 0.6180, ASR_train_attach: 1.0000, ASR_train_outter: 0.9907
Epoch 90, loss_inner: 1.31852, loss_target: 1.29945, homo loss: 0.00000 
acc_train_clean: 0.6265, ASR_train_attach: 1.0000, ASR_train_outter: 0.9815
Epoch 100, loss_inner: 1.28693, loss_target: 1.26800, homo loss: 0.00000 
acc_train_clean: 0.6323, ASR_train_attach: 1.0000, ASR_train_outter: 0.9892
Epoch 110, loss_inner: 1.26234, loss_target: 1.24425, homo loss: 0.00000 
acc_train_clean: 0.6376, ASR_train_attach: 1.0000, ASR_train_outter: 0.9892
Epoch 120, loss_inner: 1.24313, loss_target: 1.22538, homo loss: 0.00000 
acc_train_clean: 0.6418, ASR_train_attach: 1.0000, ASR_train_outter: 0.9892
Epoch 130, loss_inner: 1.22749, loss_target: 1.21015, homo loss: 0.00000 
acc_train_clean: 0.6458, ASR_train_attach: 1.0000, ASR_train_outter: 0.9907
Epoch 140, loss_inner: 1.21441, loss_target: 1.19736, homo loss: 0.00000 
acc_train_clean: 0.6488, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 150, loss_inner: 1.20334, loss_target: 1.18667, homo loss: 0.00000 
acc_train_clean: 0.6520, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 160, loss_inner: 1.19371, loss_target: 1.17713, homo loss: 0.00000 
acc_train_clean: 0.6548, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 170, loss_inner: 1.18499, loss_target: 1.16870, homo loss: 0.00000 
acc_train_clean: 0.6569, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 180, loss_inner: 1.17725, loss_target: 1.16133, homo loss: 0.00000 
acc_train_clean: 0.6588, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 190, loss_inner: 1.17039, loss_target: 1.15430, homo loss: 0.00000 
acc_train_clean: 0.6598, ASR_train_attach: 1.0000, ASR_train_outter: 0.9938
precent of left attach nodes: 1.000
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6626
ASR: 0.9742
Flip ASR: 0.9741/16875 nodes
CA: 0.6601
