nohup: ignoring input
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:160
idx_attach: tensor([151986, 162467,  44926,  23940,  72501,  13300,  22065, 147153,  79242,
        128143,  93465,  63507,  73972,  73044,  56937,  88754, 163842, 119362,
         54554,  33519,   8154,  16049, 113091, 156331,  35927, 152431,  38080,
        168947, 121840, 101165,  34467, 130677, 127703, 162722,   4875,  95491,
        148529,  78072, 126281,  59601,  54103, 107477,  51951,  10138,  10104,
         26393,  18876, 151911,  73699, 122090, 149541,   7918,  23625,  54054,
        165054,  90478, 130766, 106047,  62056, 152543, 100119,  62343, 119437,
        129228, 130514,  12459,  58483,  35161,  27651,  77539,  49360,  43087,
         51852,  84642, 162577, 108656,  81292,  49283,  70860,  49404, 141270,
         36926, 101724,  14727,  12525,  19995, 162207,  69782, 127237,   8541,
         83147, 131520,  97803, 109806, 145193, 118680,  20924, 131955, 106455,
        129401,  58891, 116300,  34079,    224,   3172,  88160, 109185, 110668,
        103248,  95078, 154019, 168817,   3771,  18207, 154860,  26834,  11175,
         63122,  47747,  80305, 102581,  82265, 117214, 132492, 137535, 122891,
        164548, 100623,  17308, 153845,  91474, 142746,  85505,  97061, 152602,
        116420,  15941, 152529,  19807,  15146, 148629, 162255, 138185,  96655,
         71909,  25179,  34595, 147363,  64609,  67502,   8161, 136765, 110630,
         11895, 158529,   5181,  90008,  16843,  62749,  33553],
       device='cuda:2')
Epoch 0, loss_inner: 3.74871, loss_target: 3.62665, homo loss: 0.80994 
acc_train_clean: 0.0089, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 3.02516, loss_target: 3.10775, homo loss: 0.00682 
acc_train_clean: 0.2638, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 2.77227, loss_target: 2.80122, homo loss: 0.00158 
acc_train_clean: 0.2842, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 30, loss_inner: 2.47444, loss_target: 2.46147, homo loss: 0.00088 
acc_train_clean: 0.3636, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 40, loss_inner: 2.17512, loss_target: 2.13781, homo loss: 0.00085 
acc_train_clean: 0.4427, ASR_train_attach: 0.5438, ASR_train_outter: 0.5283
Epoch 50, loss_inner: 1.92801, loss_target: 1.89294, homo loss: 0.00080 
acc_train_clean: 0.5040, ASR_train_attach: 0.8125, ASR_train_outter: 0.7753
Epoch 60, loss_inner: 1.73442, loss_target: 1.70241, homo loss: 0.00065 
acc_train_clean: 0.5387, ASR_train_attach: 0.9250, ASR_train_outter: 0.8795
Epoch 70, loss_inner: 1.59453, loss_target: 1.56549, homo loss: 0.00069 
acc_train_clean: 0.5704, ASR_train_attach: 0.9875, ASR_train_outter: 0.9643
Epoch 80, loss_inner: 1.49145, loss_target: 1.46683, homo loss: 0.00056 
acc_train_clean: 0.5940, ASR_train_attach: 0.9813, ASR_train_outter: 0.9658
Epoch 90, loss_inner: 1.41612, loss_target: 1.39549, homo loss: 0.00039 
acc_train_clean: 0.6083, ASR_train_attach: 0.9813, ASR_train_outter: 0.9628
Epoch 100, loss_inner: 1.36337, loss_target: 1.34500, homo loss: 0.00017 
acc_train_clean: 0.6175, ASR_train_attach: 0.9875, ASR_train_outter: 0.9688
Epoch 110, loss_inner: 1.32682, loss_target: 1.30947, homo loss: 0.00006 
acc_train_clean: 0.6243, ASR_train_attach: 0.9875, ASR_train_outter: 0.9702
Epoch 120, loss_inner: 1.29639, loss_target: 1.27874, homo loss: 0.00002 
acc_train_clean: 0.6297, ASR_train_attach: 0.9938, ASR_train_outter: 0.9732
Epoch 130, loss_inner: 1.26983, loss_target: 1.25251, homo loss: 0.00001 
acc_train_clean: 0.6364, ASR_train_attach: 0.9938, ASR_train_outter: 0.9792
Epoch 140, loss_inner: 1.24836, loss_target: 1.23186, homo loss: 0.00001 
acc_train_clean: 0.6412, ASR_train_attach: 1.0000, ASR_train_outter: 0.9807
Epoch 150, loss_inner: 1.23306, loss_target: 1.21724, homo loss: 0.00002 
acc_train_clean: 0.6445, ASR_train_attach: 1.0000, ASR_train_outter: 0.9836
Epoch 160, loss_inner: 1.22178, loss_target: 1.20602, homo loss: 0.00004 
acc_train_clean: 0.6460, ASR_train_attach: 1.0000, ASR_train_outter: 0.9851
Epoch 170, loss_inner: 1.21340, loss_target: 1.19796, homo loss: 0.00001 
acc_train_clean: 0.6476, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 180, loss_inner: 1.20619, loss_target: 1.19089, homo loss: 0.00001 
acc_train_clean: 0.6491, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 190, loss_inner: 1.20006, loss_target: 1.18494, homo loss: 0.00002 
acc_train_clean: 0.6504, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 200, loss_inner: 1.19436, loss_target: 1.17916, homo loss: 0.00003 
acc_train_clean: 0.6522, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 210, loss_inner: 1.18896, loss_target: 1.17415, homo loss: 0.00001 
acc_train_clean: 0.6537, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 220, loss_inner: 1.18235, loss_target: 1.16698, homo loss: 0.00002 
acc_train_clean: 0.6551, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 230, loss_inner: 1.17369, loss_target: 1.15894, homo loss: 0.00003 
acc_train_clean: 0.6577, ASR_train_attach: 1.0000, ASR_train_outter: 0.9896
Epoch 240, loss_inner: 1.16639, loss_target: 1.15159, homo loss: 0.00003 
acc_train_clean: 0.6600, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 250, loss_inner: 1.16117, loss_target: 1.14666, homo loss: 0.00002 
acc_train_clean: 0.6604, ASR_train_attach: 1.0000, ASR_train_outter: 0.9896
Epoch 260, loss_inner: 1.15676, loss_target: 1.14214, homo loss: 0.00002 
acc_train_clean: 0.6625, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 270, loss_inner: 1.15307, loss_target: 1.13865, homo loss: 0.00001 
acc_train_clean: 0.6629, ASR_train_attach: 1.0000, ASR_train_outter: 0.9896
Epoch 280, loss_inner: 1.15027, loss_target: 1.13540, homo loss: 0.00000 
acc_train_clean: 0.6623, ASR_train_attach: 1.0000, ASR_train_outter: 0.9911
Epoch 290, loss_inner: 1.14694, loss_target: 1.13241, homo loss: 0.00000 
acc_train_clean: 0.6643, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 300, loss_inner: 1.14408, loss_target: 1.12953, homo loss: 0.00000 
acc_train_clean: 0.6653, ASR_train_attach: 1.0000, ASR_train_outter: 0.9896
Epoch 310, loss_inner: 1.14061, loss_target: 1.12640, homo loss: 0.00001 
acc_train_clean: 0.6666, ASR_train_attach: 1.0000, ASR_train_outter: 0.9881
Epoch 320, loss_inner: 1.13853, loss_target: 1.12410, homo loss: 0.00036 
acc_train_clean: 0.6676, ASR_train_attach: 0.9938, ASR_train_outter: 0.9851
Epoch 330, loss_inner: 1.13371, loss_target: 1.12018, homo loss: 0.00007 
acc_train_clean: 0.6673, ASR_train_attach: 1.0000, ASR_train_outter: 0.9911
Epoch 340, loss_inner: 1.12973, loss_target: 1.11509, homo loss: 0.00001 
acc_train_clean: 0.6694, ASR_train_attach: 1.0000, ASR_train_outter: 0.9940
Epoch 350, loss_inner: 1.12681, loss_target: 1.11211, homo loss: 0.00001 
acc_train_clean: 0.6696, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 360, loss_inner: 1.12459, loss_target: 1.10957, homo loss: 0.00001 
acc_train_clean: 0.6709, ASR_train_attach: 1.0000, ASR_train_outter: 0.9955
Epoch 370, loss_inner: 1.12293, loss_target: 1.10809, homo loss: 0.00000 
acc_train_clean: 0.6716, ASR_train_attach: 1.0000, ASR_train_outter: 0.9955
Epoch 380, loss_inner: 1.12130, loss_target: 1.10646, homo loss: 0.00002 
acc_train_clean: 0.6715, ASR_train_attach: 1.0000, ASR_train_outter: 0.9940
Epoch 390, loss_inner: 1.11995, loss_target: 1.10549, homo loss: 0.00003 
acc_train_clean: 0.6726, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=265, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6217
Overall ASR: 0.9423
Flip ASR: 0.9421/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=125, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6231
Overall ASR: 0.9462
Flip ASR: 0.9460/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=996, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6310
Overall ASR: 0.9386
Flip ASR: 0.9384/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=527, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6280
Overall ASR: 0.9487
Flip ASR: 0.9485/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=320, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6137
Overall ASR: 0.9449
Flip ASR: 0.9447/16875 nodes
Overall ASR: 0.9441 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.6235
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=781, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6310
Overall ASR: 0.9617
Flip ASR: 0.9616/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=706, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6297
Overall ASR: 0.9618
Flip ASR: 0.9617/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=778, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6286
Overall ASR: 0.9617
Flip ASR: 0.9616/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=604, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6288
Overall ASR: 0.9618
Flip ASR: 0.9617/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=133, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.6298
Overall ASR: 0.9618
Flip ASR: 0.9617/16875 nodes
Overall ASR: 0.9618 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.6296
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=673, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.6274
Overall ASR: 0.8619
Flip ASR: 0.8615/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=904, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9688
accuracy on clean test nodes: 0.6241
Overall ASR: 0.8656
Flip ASR: 0.8652/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=56, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9563
accuracy on clean test nodes: 0.6299
Overall ASR: 0.8551
Flip ASR: 0.8548/16875 nodes
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=1, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9625
accuracy on clean test nodes: 0.6355
Overall ASR: 0.8652
Flip ASR: 0.8648/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=694, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9438
accuracy on clean test nodes: 0.6199
Overall ASR: 0.8486
Flip ASR: 0.8481/16875 nodes
Overall ASR: 0.8593 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.6273
Total Overall ASR: 0.9217 
Total Clean Accuracy: 0.6268
