nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:400
./selected_nodes/ogbn-arxiv/Overall/seed10/nodes.txt
idx_attach: tensor([ 54390, 157455,  37808, 104266, 134231,  88403,  97894, 145558,  75995,
          2523,  30654,  20600,  56835,  76107, 122838, 124720,  72291,  70684,
         88511,  23226, 150027,  12416,  99002,  46881, 103886, 117654,  50823,
        121168, 144203, 143633, 136429, 112440,  81141,  79824,  10148,  95144,
         93828,  78393, 153163, 141078, 111199, 128890,  74910,  12922, 143349,
         86383,  45024,  78103,  38987,  64934,  28343, 115072,  28354,  29606,
        103992,  73623, 133034,  90971,  39541,  25036, 112284,  63103,  33557,
         62164, 138417,  59598,  55088, 144144,  54462,  70967, 130090, 138708,
        138746,  61622,  48231, 119164,  76234, 132750, 111019,  50314, 157370,
        157846,  31230,    617,  86483,  75032,  45860, 100867, 132713,   4272,
        159487,  32925, 142085,  46326, 155020,  41944, 106237,  66207,  30170,
         17599, 100373,  24219, 110903,  36333,  63383, 108329,   7154,  75105,
          8538,  80112,  18796, 162579,  92925, 142267,  42836, 126638, 138501,
        140123,  47582,  91720, 161830, 138798,  80076, 131652, 110527, 166679,
         67497, 136221,  33946,  83768, 142487,  26312, 114281,   3102,  18746,
        102567,   7673, 140598, 101387,  88129, 132313, 165759, 148658, 128981,
         91815, 102696, 108961, 126977,  41554, 149979, 150203, 147007,  52325,
         53846, 123910,  17831, 112302,  97732,  82755, 166550,  14974, 111663,
          3720,  54791, 168499,  86719, 126475, 109057, 128074, 109260,   7135,
        151262,  48964,  33452,  46436, 154707, 143728, 162547, 103833, 140060,
        142182,  25591, 145429,  17081,  11532, 138315,  74706,  65360, 114189,
         80139, 128643,  36247,  25110, 106496,  78596,  44131, 135150, 160007,
          9748, 158003, 115798,  45601, 109789,  95126,  51976, 122616, 157363,
         54963,  39955, 151520, 146277,  56859,  48867,  40994,  47644,   1385,
         12541,  47134, 109171,  92225,  85852,  14422, 145856, 137888,  71313,
        116028,  82517,  19482,  98303, 100479,  30252, 108498,  33524, 129069,
         63022,  85223,  38805, 146276,   4735,  21881,  74864, 103292,  48904,
         48925, 144883, 101496,  25913, 144290,  57522,  83655,   5026, 127472,
        156735,  41513, 163283, 151193, 160889,  71248,  98768, 167204,  85158,
         93790,  66161,  97177, 106428,  68855,   4380,  65611,  53050,  12926,
        121390, 103623, 136891,  11481,  49460,  83448,  60653, 169290, 112099,
        150082, 110675, 120207, 142045,   7172,  23318,  91837, 135381,  81067,
         35475,  69424,  92918, 131567,  82800,  29793,  58192, 104424, 114341,
        129190, 149984, 111108,  68960, 116809,  95384,  68849, 168002,  20081,
         81455, 144613,  84076,  95782, 122138, 155525,  23008,  85036,    591,
         55693, 114950,  27160, 140737,  54338, 151294,  44287, 150272, 146468,
         57377, 126293, 131830,  32880,   5821,   9522,  41942,  56293, 157929,
         77726,  96989, 100516, 139395,  87293,  42956,  90551, 108268,  77460,
        116414, 100243, 135897, 114723, 123718,   6462, 133429,  21945,  12037,
         48469, 119988,  51556, 115667,   1962,  51694, 121367,  10752,  29575,
         71985,  51769,  21750,  58223,  73785, 100482, 114871,  47238,  65379,
        113756,  65787, 140138,  94860, 162635,  93908, 169314, 108253,  66767,
         43459, 117229, 120187, 162096, 122376,  29365,  96936, 116755,  56436,
        113226, 103830, 157791,  73170,  81062, 163007, 117650, 145395,  52480,
        145160, 100029, 116799, 166712], device='cuda:1')
tensor([     1,      2,      3,  ..., 169334, 169336, 169338], device='cuda:1')
Epoch 0, loss_inner: 3.74858, loss_target: 3.62823, homo loss: 0.80600 
acc_train_clean: 0.0089, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 3.04015, loss_target: 3.08912, homo loss: 0.00624 
acc_train_clean: 0.2655, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 2.78132, loss_target: 2.76350, homo loss: 0.00143 
acc_train_clean: 0.2863, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 30, loss_inner: 2.47125, loss_target: 2.42638, homo loss: 0.00096 
acc_train_clean: 0.3541, ASR_train_attach: 0.2500, ASR_train_outter: 0.4068
Epoch 40, loss_inner: 2.16335, loss_target: 2.11317, homo loss: 0.00087 
acc_train_clean: 0.4404, ASR_train_attach: 0.9400, ASR_train_outter: 0.9013
Epoch 50, loss_inner: 1.91566, loss_target: 1.87352, homo loss: 0.00087 
acc_train_clean: 0.5023, ASR_train_attach: 0.9300, ASR_train_outter: 0.9211
Epoch 60, loss_inner: 1.73058, loss_target: 1.69553, homo loss: 0.00127 
acc_train_clean: 0.5355, ASR_train_attach: 0.9775, ASR_train_outter: 0.9572
Epoch 70, loss_inner: 1.59865, loss_target: 1.56880, homo loss: 0.00099 
acc_train_clean: 0.5632, ASR_train_attach: 0.9925, ASR_train_outter: 0.9638
Epoch 80, loss_inner: 1.49067, loss_target: 1.46392, homo loss: 0.00088 
acc_train_clean: 0.5897, ASR_train_attach: 0.9975, ASR_train_outter: 0.9704
Epoch 90, loss_inner: 1.40753, loss_target: 1.38444, homo loss: 0.00088 
acc_train_clean: 0.6051, ASR_train_attach: 1.0000, ASR_train_outter: 0.9759
Epoch 100, loss_inner: 1.35549, loss_target: 1.33448, homo loss: 0.00085 
acc_train_clean: 0.6152, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 110, loss_inner: 1.32055, loss_target: 1.30037, homo loss: 0.00081 
acc_train_clean: 0.6220, ASR_train_attach: 1.0000, ASR_train_outter: 0.9901
Epoch 120, loss_inner: 1.29393, loss_target: 1.27468, homo loss: 0.00075 
acc_train_clean: 0.6276, ASR_train_attach: 1.0000, ASR_train_outter: 0.9890
Epoch 130, loss_inner: 1.27173, loss_target: 1.25270, homo loss: 0.00066 
acc_train_clean: 0.6334, ASR_train_attach: 1.0000, ASR_train_outter: 0.9901
Epoch 140, loss_inner: 1.25274, loss_target: 1.23409, homo loss: 0.00053 
acc_train_clean: 0.6402, ASR_train_attach: 1.0000, ASR_train_outter: 0.9912
Epoch 150, loss_inner: 1.23697, loss_target: 1.21873, homo loss: 0.00037 
acc_train_clean: 0.6434, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 160, loss_inner: 1.22410, loss_target: 1.20732, homo loss: 0.00057 
acc_train_clean: 0.6460, ASR_train_attach: 1.0000, ASR_train_outter: 0.9814
Epoch 170, loss_inner: 1.21322, loss_target: 1.19526, homo loss: 0.00039 
acc_train_clean: 0.6487, ASR_train_attach: 1.0000, ASR_train_outter: 0.9934
Epoch 180, loss_inner: 1.20411, loss_target: 1.18603, homo loss: 0.00017 
acc_train_clean: 0.6505, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 190, loss_inner: 1.19627, loss_target: 1.17913, homo loss: 0.00007 
acc_train_clean: 0.6517, ASR_train_attach: 1.0000, ASR_train_outter: 0.9857
Epoch 200, loss_inner: 1.18941, loss_target: 1.17193, homo loss: 0.00006 
acc_train_clean: 0.6532, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 210, loss_inner: 1.18337, loss_target: 1.16601, homo loss: 0.00015 
acc_train_clean: 0.6545, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 220, loss_inner: 1.17786, loss_target: 1.16066, homo loss: 0.00006 
acc_train_clean: 0.6554, ASR_train_attach: 1.0000, ASR_train_outter: 0.9945
Epoch 230, loss_inner: 1.17295, loss_target: 1.15567, homo loss: 0.00003 
acc_train_clean: 0.6562, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 240, loss_inner: 1.16863, loss_target: 1.15182, homo loss: 0.00022 
acc_train_clean: 0.6577, ASR_train_attach: 1.0000, ASR_train_outter: 0.9934
Epoch 250, loss_inner: 1.16413, loss_target: 1.14699, homo loss: 0.00002 
acc_train_clean: 0.6578, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 260, loss_inner: 1.16020, loss_target: 1.14460, homo loss: 0.00021 
acc_train_clean: 0.6591, ASR_train_attach: 1.0000, ASR_train_outter: 0.9846
Epoch 270, loss_inner: 1.15583, loss_target: 1.13811, homo loss: 0.00004 
acc_train_clean: 0.6603, ASR_train_attach: 1.0000, ASR_train_outter: 0.9989
Epoch 280, loss_inner: 1.14780, loss_target: 1.13062, homo loss: 0.00002 
acc_train_clean: 0.6625, ASR_train_attach: 1.0000, ASR_train_outter: 0.9945
Epoch 290, loss_inner: 1.14080, loss_target: 1.12344, homo loss: 0.00002 
acc_train_clean: 0.6647, ASR_train_attach: 1.0000, ASR_train_outter: 0.9989
Epoch 300, loss_inner: 1.13551, loss_target: 1.11944, homo loss: 0.00071 
acc_train_clean: 0.6656, ASR_train_attach: 1.0000, ASR_train_outter: 0.9934
Epoch 310, loss_inner: 1.13183, loss_target: 1.11628, homo loss: 0.00061 
acc_train_clean: 0.6674, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 320, loss_inner: 1.12887, loss_target: 1.11291, homo loss: 0.00042 
acc_train_clean: 0.6673, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 330, loss_inner: 1.12623, loss_target: 1.11034, homo loss: 0.00027 
acc_train_clean: 0.6686, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 340, loss_inner: 1.12393, loss_target: 1.10754, homo loss: 0.00001 
acc_train_clean: 0.6689, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 350, loss_inner: 1.12206, loss_target: 1.10568, homo loss: 0.00000 
acc_train_clean: 0.6695, ASR_train_attach: 1.0000, ASR_train_outter: 0.9967
Epoch 360, loss_inner: 1.12034, loss_target: 1.10375, homo loss: 0.00001 
acc_train_clean: 0.6698, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 370, loss_inner: 1.11884, loss_target: 1.10233, homo loss: 0.00000 
acc_train_clean: 0.6701, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 380, loss_inner: 1.11832, loss_target: 1.10138, homo loss: 0.00001 
acc_train_clean: 0.6698, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 390, loss_inner: 1.11612, loss_target: 1.09984, homo loss: 0.00001 
acc_train_clean: 0.6709, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 400, loss_inner: 1.11489, loss_target: 1.09848, homo loss: 0.00001 
acc_train_clean: 0.6707, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 410, loss_inner: 1.11365, loss_target: 1.09751, homo loss: 0.00009 
acc_train_clean: 0.6715, ASR_train_attach: 1.0000, ASR_train_outter: 0.9978
Epoch 420, loss_inner: 1.11257, loss_target: 1.09633, homo loss: 0.00005 
acc_train_clean: 0.6719, ASR_train_attach: 1.0000, ASR_train_outter: 0.9989
Epoch 430, loss_inner: 1.28711, loss_target: 1.21292, homo loss: 0.00176 
acc_train_clean: 0.6152, ASR_train_attach: 1.0000, ASR_train_outter: 0.9890
Epoch 440, loss_inner: 1.17972, loss_target: 1.23950, homo loss: 0.00385 
acc_train_clean: 0.6593, ASR_train_attach: 0.9675, ASR_train_outter: 0.9550
Epoch 450, loss_inner: 1.14827, loss_target: 1.19125, homo loss: 0.00249 
acc_train_clean: 0.6648, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 460, loss_inner: 1.12313, loss_target: 1.13464, homo loss: 0.00136 
acc_train_clean: 0.6707, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 470, loss_inner: 1.11685, loss_target: 1.12562, homo loss: 0.00159 
acc_train_clean: 0.6722, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 480, loss_inner: 1.11343, loss_target: 1.11431, homo loss: 0.00128 
acc_train_clean: 0.6727, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 490, loss_inner: 1.11232, loss_target: 1.11357, homo loss: 0.00106 
acc_train_clean: 0.6730, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 500, loss_inner: 1.11168, loss_target: 1.11080, homo loss: 0.00103 
acc_train_clean: 0.6733, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 510, loss_inner: 1.11312, loss_target: 1.11213, homo loss: 0.00105 
acc_train_clean: 0.6707, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 520, loss_inner: 1.12764, loss_target: 1.14771, homo loss: 0.00107 
acc_train_clean: 0.6686, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 530, loss_inner: 1.12803, loss_target: 1.14207, homo loss: 0.00110 
acc_train_clean: 0.6677, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 540, loss_inner: 1.14633, loss_target: 1.17744, homo loss: 0.00116 
acc_train_clean: 0.6602, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 550, loss_inner: 1.16738, loss_target: 1.18778, homo loss: 0.00125 
acc_train_clean: 0.6547, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 560, loss_inner: 1.15525, loss_target: 1.21430, homo loss: 0.00124 
acc_train_clean: 0.6599, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 570, loss_inner: 1.24714, loss_target: 1.39765, homo loss: 0.00163 
acc_train_clean: 0.6365, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 580, loss_inner: 1.29741, loss_target: 1.54165, homo loss: 0.00201 
acc_train_clean: 0.6311, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 590, loss_inner: 2.37641, loss_target: 3.46520, homo loss: 0.03246 
acc_train_clean: 0.5447, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 600, loss_inner: 1.71386, loss_target: 2.72639, homo loss: 0.01418 
acc_train_clean: 0.5435, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 610, loss_inner: 2.51685, loss_target: 3.13493, homo loss: 0.03804 
acc_train_clean: 0.4839, ASR_train_attach: 1.0000, ASR_train_outter: 0.6217
Epoch 620, loss_inner: 2.99129, loss_target: 6.80899, homo loss: 0.06262 
acc_train_clean: 0.4125, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 630, loss_inner: 2.34139, loss_target: 5.45549, homo loss: 0.08171 
acc_train_clean: 0.4032, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 640, loss_inner: 2.18986, loss_target: 3.67195, homo loss: 0.05817 
acc_train_clean: 0.4248, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 650, loss_inner: 2.37687, loss_target: 3.93981, homo loss: 0.03948 
acc_train_clean: 0.4829, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 660, loss_inner: 3.59177, loss_target: 6.87197, homo loss: 0.03735 
acc_train_clean: 0.4960, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 670, loss_inner: 1.97131, loss_target: 2.86219, homo loss: 0.04183 
acc_train_clean: 0.4939, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 680, loss_inner: 1.62699, loss_target: 1.59066, homo loss: 0.04472 
acc_train_clean: 0.5603, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 690, loss_inner: 1.53846, loss_target: 1.49022, homo loss: 0.03291 
acc_train_clean: 0.5801, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 700, loss_inner: 1.45540, loss_target: 1.44447, homo loss: 0.02045 
acc_train_clean: 0.5928, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 710, loss_inner: 1.40852, loss_target: 1.39001, homo loss: 0.01348 
acc_train_clean: 0.6035, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 720, loss_inner: 1.38209, loss_target: 1.35955, homo loss: 0.01021 
acc_train_clean: 0.6069, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 730, loss_inner: 1.35479, loss_target: 1.33597, homo loss: 0.00818 
acc_train_clean: 0.6134, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 740, loss_inner: 1.33043, loss_target: 1.33001, homo loss: 0.00707 
acc_train_clean: 0.6192, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 750, loss_inner: 1.30862, loss_target: 1.29469, homo loss: 0.00648 
acc_train_clean: 0.6254, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 760, loss_inner: 1.28647, loss_target: 1.28068, homo loss: 0.00607 
acc_train_clean: 0.6302, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 770, loss_inner: 1.26683, loss_target: 1.24740, homo loss: 0.00603 
acc_train_clean: 0.6360, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 780, loss_inner: 1.24867, loss_target: 1.22930, homo loss: 0.00600 
acc_train_clean: 0.6386, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 790, loss_inner: 1.23328, loss_target: 1.21723, homo loss: 0.00600 
acc_train_clean: 0.6417, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 800, loss_inner: 3.60739, loss_target: 1.78493, homo loss: 0.00813 
acc_train_clean: 0.6401, ASR_train_attach: 0.0000, ASR_train_outter: 1.0000
Epoch 810, loss_inner: 1.45265, loss_target: 2.58943, homo loss: 0.02611 
acc_train_clean: 0.6231, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 820, loss_inner: 1.27751, loss_target: 1.25767, homo loss: 0.03737 
acc_train_clean: 0.6342, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 830, loss_inner: 1.24920, loss_target: 1.22932, homo loss: 0.03251 
acc_train_clean: 0.6390, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 840, loss_inner: 1.22544, loss_target: 1.22343, homo loss: 0.02054 
acc_train_clean: 0.6451, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 850, loss_inner: 1.20214, loss_target: 1.18388, homo loss: 0.01403 
acc_train_clean: 0.6504, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 860, loss_inner: 1.19227, loss_target: 1.17351, homo loss: 0.00982 
acc_train_clean: 0.6522, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 870, loss_inner: 1.18467, loss_target: 1.16865, homo loss: 0.00771 
acc_train_clean: 0.6546, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 880, loss_inner: 1.18091, loss_target: 1.16622, homo loss: 0.00654 
acc_train_clean: 0.6550, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 890, loss_inner: 1.17793, loss_target: 1.16118, homo loss: 0.00604 
acc_train_clean: 0.6547, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 900, loss_inner: 1.17673, loss_target: 1.15964, homo loss: 0.00551 
acc_train_clean: 0.6549, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 910, loss_inner: 1.17402, loss_target: 1.15759, homo loss: 0.00499 
acc_train_clean: 0.6561, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 920, loss_inner: 1.17141, loss_target: 1.15484, homo loss: 0.00469 
acc_train_clean: 0.6571, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 930, loss_inner: 1.16925, loss_target: 1.15279, homo loss: 0.00453 
acc_train_clean: 0.6574, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 940, loss_inner: 1.16874, loss_target: 1.15236, homo loss: 0.00449 
acc_train_clean: 0.6570, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 950, loss_inner: 1.16743, loss_target: 1.15132, homo loss: 0.00426 
acc_train_clean: 0.6571, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 960, loss_inner: 1.16589, loss_target: 1.14930, homo loss: 0.00414 
acc_train_clean: 0.6574, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 970, loss_inner: 1.16352, loss_target: 1.14824, homo loss: 0.00401 
acc_train_clean: 0.6584, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 980, loss_inner: 1.16443, loss_target: 1.14843, homo loss: 0.00397 
acc_train_clean: 0.6586, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 990, loss_inner: 1.16384, loss_target: 1.14816, homo loss: 0.00384 
acc_train_clean: 0.6584, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1000, loss_inner: 1.16216, loss_target: 1.14561, homo loss: 0.00378 
acc_train_clean: 0.6584, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1010, loss_inner: 1.15972, loss_target: 1.14347, homo loss: 0.00354 
acc_train_clean: 0.6592, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1020, loss_inner: 1.15782, loss_target: 1.14149, homo loss: 0.00343 
acc_train_clean: 0.6594, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1030, loss_inner: 1.15868, loss_target: 1.14227, homo loss: 0.00339 
acc_train_clean: 0.6587, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1040, loss_inner: 1.15683, loss_target: 1.14068, homo loss: 0.00335 
acc_train_clean: 0.6591, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1050, loss_inner: 1.15516, loss_target: 1.13890, homo loss: 0.00323 
acc_train_clean: 0.6601, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1060, loss_inner: 1.15469, loss_target: 1.13958, homo loss: 0.00332 
acc_train_clean: 0.6594, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1070, loss_inner: 1.15322, loss_target: 1.13695, homo loss: 0.00319 
acc_train_clean: 0.6596, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1080, loss_inner: 1.15774, loss_target: 1.14388, homo loss: 0.00293 
acc_train_clean: 0.6604, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1090, loss_inner: 1.15377, loss_target: 1.13737, homo loss: 0.00294 
acc_train_clean: 0.6602, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1100, loss_inner: 1.15186, loss_target: 1.15990, homo loss: 0.00298 
acc_train_clean: 0.6602, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1110, loss_inner: 1.15286, loss_target: 1.13812, homo loss: 0.00360 
acc_train_clean: 0.6598, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1120, loss_inner: 1.15074, loss_target: 1.13462, homo loss: 0.00398 
acc_train_clean: 0.6607, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1130, loss_inner: 1.15274, loss_target: 1.13441, homo loss: 0.00373 
acc_train_clean: 0.6601, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1140, loss_inner: 1.15045, loss_target: 1.13393, homo loss: 0.00345 
acc_train_clean: 0.6608, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1150, loss_inner: 1.14809, loss_target: 1.13527, homo loss: 0.00321 
acc_train_clean: 0.6622, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1160, loss_inner: 1.14762, loss_target: 1.13157, homo loss: 0.00323 
acc_train_clean: 0.6618, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1170, loss_inner: 1.14662, loss_target: 1.13055, homo loss: 0.00317 
acc_train_clean: 0.6613, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1180, loss_inner: 1.14953, loss_target: 1.13712, homo loss: 0.00303 
acc_train_clean: 0.6605, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1190, loss_inner: 1.14883, loss_target: 1.13420, homo loss: 0.00290 
acc_train_clean: 0.6610, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1200, loss_inner: 1.14598, loss_target: 1.13248, homo loss: 0.00271 
acc_train_clean: 0.6621, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1210, loss_inner: 1.14351, loss_target: 1.12727, homo loss: 0.00271 
acc_train_clean: 0.6616, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1220, loss_inner: 1.14315, loss_target: 1.12645, homo loss: 0.00274 
acc_train_clean: 0.6609, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1230, loss_inner: 1.14084, loss_target: 1.12483, homo loss: 0.00284 
acc_train_clean: 0.6626, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1240, loss_inner: 1.13961, loss_target: 1.12366, homo loss: 0.00272 
acc_train_clean: 0.6640, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1250, loss_inner: 1.14254, loss_target: 1.12671, homo loss: 0.00252 
acc_train_clean: 0.6634, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1260, loss_inner: 1.14048, loss_target: 1.12419, homo loss: 0.00253 
acc_train_clean: 0.6631, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1270, loss_inner: 1.13877, loss_target: 1.12261, homo loss: 0.00256 
acc_train_clean: 0.6634, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1280, loss_inner: 1.14259, loss_target: 1.12986, homo loss: 0.00280 
acc_train_clean: 0.6623, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1290, loss_inner: 1.14366, loss_target: 1.12777, homo loss: 0.00292 
acc_train_clean: 0.6631, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1300, loss_inner: 1.14122, loss_target: 1.12495, homo loss: 0.00293 
acc_train_clean: 0.6639, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1310, loss_inner: 1.13847, loss_target: 1.12210, homo loss: 0.00273 
acc_train_clean: 0.6635, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1320, loss_inner: 1.13609, loss_target: 1.12148, homo loss: 0.00263 
acc_train_clean: 0.6640, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1330, loss_inner: 1.13487, loss_target: 1.12006, homo loss: 0.00256 
acc_train_clean: 0.6639, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1340, loss_inner: 1.13421, loss_target: 1.11860, homo loss: 0.00246 
acc_train_clean: 0.6650, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1350, loss_inner: 1.13399, loss_target: 1.11820, homo loss: 0.00236 
acc_train_clean: 0.6651, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1360, loss_inner: 1.13310, loss_target: 1.11715, homo loss: 0.00245 
acc_train_clean: 0.6650, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1370, loss_inner: 1.13363, loss_target: 1.11967, homo loss: 0.00236 
acc_train_clean: 0.6656, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1380, loss_inner: 1.13796, loss_target: 1.12067, homo loss: 0.00240 
acc_train_clean: 0.6633, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1390, loss_inner: 1.13433, loss_target: 1.11845, homo loss: 0.00237 
acc_train_clean: 0.6651, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1400, loss_inner: 1.13265, loss_target: 1.11861, homo loss: 0.00222 
acc_train_clean: 0.6663, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1410, loss_inner: 1.13154, loss_target: 1.11590, homo loss: 0.00227 
acc_train_clean: 0.6649, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1420, loss_inner: 1.13033, loss_target: 1.11472, homo loss: 0.00227 
acc_train_clean: 0.6655, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1430, loss_inner: 1.13009, loss_target: 1.11894, homo loss: 0.00218 
acc_train_clean: 0.6654, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1440, loss_inner: 1.13228, loss_target: 1.11677, homo loss: 0.00233 
acc_train_clean: 0.6670, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1450, loss_inner: 1.13126, loss_target: 1.11518, homo loss: 0.00233 
acc_train_clean: 0.6661, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1460, loss_inner: 1.13010, loss_target: 1.11425, homo loss: 0.00234 
acc_train_clean: 0.6657, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1470, loss_inner: 1.12878, loss_target: 1.11288, homo loss: 0.00239 
acc_train_clean: 0.6665, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1480, loss_inner: 1.12951, loss_target: 1.11311, homo loss: 0.00236 
acc_train_clean: 0.6657, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1490, loss_inner: 1.12932, loss_target: 1.11704, homo loss: 0.00227 
acc_train_clean: 0.6663, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6341
Overall ASR: 0.9819
Flip ASR: 0.9818/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6362
Overall ASR: 0.9832
Flip ASR: 0.9831/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6445
Overall ASR: 0.9815
Flip ASR: 0.9814/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6437
Overall ASR: 0.9825
Flip ASR: 0.9824/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6335
Overall ASR: 0.9820
Flip ASR: 0.9819/16875 nodes
Overall ASR: 0.9822 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.6384
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6459
Overall ASR: 1.0000
Flip ASR: 1.0000/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6469
Overall ASR: 1.0000
Flip ASR: 1.0000/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6493
Overall ASR: 1.0000
Flip ASR: 1.0000/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6456
Overall ASR: 1.0000
Flip ASR: 1.0000/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6452
Overall ASR: 1.0000
Flip ASR: 1.0000/16875 nodes
Overall ASR: 1.0000 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.6466
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9950
accuracy on clean test nodes: 0.6338
Overall ASR: 0.9236
Flip ASR: 0.9234/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9975
accuracy on clean test nodes: 0.6369
Overall ASR: 0.9248
Flip ASR: 0.9245/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9975
accuracy on clean test nodes: 0.6379
Overall ASR: 0.9291
Flip ASR: 0.9288/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.6447
Overall ASR: 0.9370
Flip ASR: 0.9368/16875 nodes
Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.8, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=400, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9975
accuracy on clean test nodes: 0.6346
Overall ASR: 0.9333
Flip ASR: 0.9330/16875 nodes
Overall ASR: 0.9295 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.6376
Total Overall ASR: 0.9706 
Total Clean Accuracy: 0.6409
