nohup: ignoring input
Namespace(attack_method='Basic', cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='isolate', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, use_vs_number=False, vs_number=0, vs_ratio=0.001, weight_decay=0.0005)
Length of training set: 33868
Training benign model Finished!
Total time elapsed: 10.6389s
Benign CA: 0.6668
Length of training set: 33868
=== training gcn model ===
Epoch 0, training loss: 3.680744171142578
acc_val: 0.1306
Epoch 10, training loss: 2.764761447906494
acc_val: 0.2969
Epoch 20, training loss: 2.2360143661499023
acc_val: 0.4128
Epoch 30, training loss: 1.963041067123413
acc_val: 0.5069
Epoch 40, training loss: 1.8154914379119873
acc_val: 0.5446
Epoch 50, training loss: 1.7279058694839478
acc_val: 0.5764
Epoch 60, training loss: 1.6559902429580688
acc_val: 0.5905
Epoch 70, training loss: 1.6164555549621582
acc_val: 0.5989
Epoch 80, training loss: 1.5765661001205444
acc_val: 0.6054
Epoch 90, training loss: 1.560106635093689
acc_val: 0.6172
Epoch 100, training loss: 1.545020580291748
acc_val: 0.6180
Epoch 110, training loss: 1.5186837911605835
acc_val: 0.6254
Epoch 120, training loss: 1.493090033531189
acc_val: 0.6291
Epoch 130, training loss: 1.4861972332000732
acc_val: 0.6326
Epoch 140, training loss: 1.4793363809585571
acc_val: 0.6332
Epoch 150, training loss: 1.477440595626831
acc_val: 0.6377
Epoch 160, training loss: 1.4584425687789917
acc_val: 0.6389
Epoch 170, training loss: 1.4662997722625732
acc_val: 0.6329
Epoch 180, training loss: 1.4500490427017212
acc_val: 0.6374
Epoch 190, training loss: 1.4357657432556152
acc_val: 0.6411
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 11.1589s
Encoder CA on clean test nodes: 0.6484
running k-means on cuda:2..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:04, ?it/s, center_shift=1718.026978, iteration=1, tol=0.000100][running kmeans]: 1it [00:04,  4.77s/it, center_shift=1718.026978, iteration=1, tol=0.000100][running kmeans]: 1it [00:10,  4.77s/it, center_shift=276.877655, iteration=2, tol=0.000100] [running kmeans]: 2it [00:10,  5.17s/it, center_shift=276.877655, iteration=2, tol=0.000100][running kmeans]: 2it [00:14,  5.17s/it, center_shift=104.806549, iteration=3, tol=0.000100][running kmeans]: 3it [00:14,  4.88s/it, center_shift=104.806549, iteration=3, tol=0.000100][running kmeans]: 3it [00:20,  4.88s/it, center_shift=45.806492, iteration=4, tol=0.000100] [running kmeans]: 4it [00:20,  5.25s/it, center_shift=45.806492, iteration=4, tol=0.000100][running kmeans]: 4it [00:26,  5.25s/it, center_shift=24.367682, iteration=5, tol=0.000100][running kmeans]: 5it [00:26,  5.52s/it, center_shift=24.367682, iteration=5, tol=0.000100][running kmeans]: 5it [00:31,  5.52s/it, center_shift=15.861761, iteration=6, tol=0.000100][running kmeans]: 6it [00:31,  5.32s/it, center_shift=15.861761, iteration=6, tol=0.000100][running kmeans]: 6it [00:36,  5.32s/it, center_shift=11.485822, iteration=7, tol=0.000100][running kmeans]: 7it [00:36,  5.20s/it, center_shift=11.485822, iteration=7, tol=0.000100][running kmeans]: 7it [00:41,  5.20s/it, center_shift=9.673635, iteration=8, tol=0.000100] [running kmeans]: 8it [00:41,  5.29s/it, center_shift=9.673635, iteration=8, tol=0.000100][running kmeans]: 8it [00:47,  5.29s/it, center_shift=9.176660, iteration=9, tol=0.000100][running kmeans]: 9it [00:47,  5.31s/it, center_shift=9.176660, iteration=9, tol=0.000100][running kmeans]: 9it [00:53,  5.31s/it, center_shift=7.560407, iteration=10, tol=0.000100][running kmeans]: 10it [00:53,  5.55s/it, center_shift=7.560407, iteration=10, tol=0.000100][running kmeans]: 10it [00:59,  5.55s/it, center_shift=7.508652, iteration=11, tol=0.000100][running kmeans]: 11it [00:59,  5.73s/it, center_shift=7.508652, iteration=11, tol=0.000100][running kmeans]: 11it [01:04,  5.73s/it, center_shift=6.742557, iteration=12, tol=0.000100][running kmeans]: 12it [01:04,  5.43s/it, center_shift=6.742557, iteration=12, tol=0.000100][running kmeans]: 12it [01:09,  5.43s/it, center_shift=5.757279, iteration=13, tol=0.000100][running kmeans]: 13it [01:09,  5.37s/it, center_shift=5.757279, iteration=13, tol=0.000100][running kmeans]: 13it [01:15,  5.37s/it, center_shift=5.325277, iteration=14, tol=0.000100][running kmeans]: 14it [01:15,  5.42s/it, center_shift=5.325277, iteration=14, tol=0.000100][running kmeans]: 14it [01:20,  5.42s/it, center_shift=5.446662, iteration=15, tol=0.000100][running kmeans]: 15it [01:20,  5.41s/it, center_shift=5.446662, iteration=15, tol=0.000100][running kmeans]: 15it [01:24,  5.41s/it, center_shift=5.527012, iteration=16, tol=0.000100][running kmeans]: 16it [01:24,  5.02s/it, center_shift=5.527012, iteration=16, tol=0.000100][running kmeans]: 16it [01:29,  5.02s/it, center_shift=3.974898, iteration=17, tol=0.000100][running kmeans]: 17it [01:29,  4.94s/it, center_shift=3.974898, iteration=17, tol=0.000100][running kmeans]: 17it [01:33,  4.94s/it, center_shift=3.787068, iteration=18, tol=0.000100][running kmeans]: 18it [01:33,  4.80s/it, center_shift=3.787068, iteration=18, tol=0.000100][running kmeans]: 18it [01:38,  4.80s/it, center_shift=3.108082, iteration=19, tol=0.000100][running kmeans]: 19it [01:38,  4.91s/it, center_shift=3.108082, iteration=19, tol=0.000100][running kmeans]: 19it [01:44,  4.91s/it, center_shift=2.390667, iteration=20, tol=0.000100][running kmeans]: 20it [01:44,  5.16s/it, center_shift=2.390667, iteration=20, tol=0.000100][running kmeans]: 20it [01:49,  5.16s/it, center_shift=1.974791, iteration=21, tol=0.000100][running kmeans]: 21it [01:49,  5.10s/it, center_shift=1.974791, iteration=21, tol=0.000100][running kmeans]: 21it [01:55,  5.10s/it, center_shift=1.537021, iteration=22, tol=0.000100][running kmeans]: 22it [01:55,  5.20s/it, center_shift=1.537021, iteration=22, tol=0.000100][running kmeans]: 22it [02:00,  5.20s/it, center_shift=1.705242, iteration=23, tol=0.000100][running kmeans]: 23it [02:00,  5.30s/it, center_shift=1.705242, iteration=23, tol=0.000100][running kmeans]: 23it [02:06,  5.30s/it, center_shift=1.340361, iteration=24, tol=0.000100][running kmeans]: 24it [02:06,  5.48s/it, center_shift=1.340361, iteration=24, tol=0.000100][running kmeans]: 24it [02:12,  5.48s/it, center_shift=1.155089, iteration=25, tol=0.000100][running kmeans]: 25it [02:12,  5.65s/it, center_shift=1.155089, iteration=25, tol=0.000100][running kmeans]: 25it [02:17,  5.65s/it, center_shift=1.136499, iteration=26, tol=0.000100][running kmeans]: 26it [02:17,  5.40s/it, center_shift=1.136499, iteration=26, tol=0.000100][running kmeans]: 26it [02:21,  5.40s/it, center_shift=0.941957, iteration=27, tol=0.000100][running kmeans]: 27it [02:21,  5.08s/it, center_shift=0.941957, iteration=27, tol=0.000100][running kmeans]: 27it [02:27,  5.08s/it, center_shift=1.114620, iteration=28, tol=0.000100][running kmeans]: 28it [02:27,  5.23s/it, center_shift=1.114620, iteration=28, tol=0.000100][running kmeans]: 28it [02:32,  5.23s/it, center_shift=1.311048, iteration=29, tol=0.000100][running kmeans]: 29it [02:32,  5.26s/it, center_shift=1.311048, iteration=29, tol=0.000100][running kmeans]: 29it [02:36,  5.26s/it, center_shift=0.793240, iteration=30, tol=0.000100][running kmeans]: 30it [02:36,  4.92s/it, center_shift=0.793240, iteration=30, tol=0.000100][running kmeans]: 30it [02:41,  4.92s/it, center_shift=0.829098, iteration=31, tol=0.000100][running kmeans]: 31it [02:41,  4.77s/it, center_shift=0.829098, iteration=31, tol=0.000100][running kmeans]: 31it [02:46,  4.77s/it, center_shift=0.697674, iteration=32, tol=0.000100][running kmeans]: 32it [02:46,  4.87s/it, center_shift=0.697674, iteration=32, tol=0.000100][running kmeans]: 32it [02:52,  4.87s/it, center_shift=0.590629, iteration=33, tol=0.000100][running kmeans]: 33it [02:52,  5.16s/it, center_shift=0.590629, iteration=33, tol=0.000100][running kmeans]: 33it [02:57,  5.16s/it, center_shift=0.430111, iteration=34, tol=0.000100][running kmeans]: 34it [02:57,  5.11s/it, center_shift=0.430111, iteration=34, tol=0.000100][running kmeans]: 34it [03:03,  5.11s/it, center_shift=0.402161, iteration=35, tol=0.000100][running kmeans]: 35it [03:03,  5.43s/it, center_shift=0.402161, iteration=35, tol=0.000100][running kmeans]: 35it [03:08,  5.43s/it, center_shift=0.329916, iteration=36, tol=0.000100][running kmeans]: 36it [03:08,  5.26s/it, center_shift=0.329916, iteration=36, tol=0.000100][running kmeans]: 36it [03:13,  5.26s/it, center_shift=0.426903, iteration=37, tol=0.000100][running kmeans]: 37it [03:13,  5.44s/it, center_shift=0.426903, iteration=37, tol=0.000100][running kmeans]: 37it [03:19,  5.44s/it, center_shift=0.367671, iteration=38, tol=0.000100][running kmeans]: 38it [03:19,  5.40s/it, center_shift=0.367671, iteration=38, tol=0.000100][running kmeans]: 38it [03:23,  5.40s/it, center_shift=0.273826, iteration=39, tol=0.000100][running kmeans]: 39it [03:23,  5.07s/it, center_shift=0.273826, iteration=39, tol=0.000100][running kmeans]: 39it [03:27,  5.07s/it, center_shift=0.295529, iteration=40, tol=0.000100][running kmeans]: 40it [03:27,  4.77s/it, center_shift=0.295529, iteration=40, tol=0.000100][running kmeans]: 40it [03:31,  4.77s/it, center_shift=0.329299, iteration=41, tol=0.000100][running kmeans]: 41it [03:31,  4.40s/it, center_shift=0.329299, iteration=41, tol=0.000100][running kmeans]: 41it [03:35,  4.40s/it, center_shift=0.249792, iteration=42, tol=0.000100][running kmeans]: 42it [03:35,  4.42s/it, center_shift=0.249792, iteration=42, tol=0.000100][running kmeans]: 42it [03:42,  4.42s/it, center_shift=0.361509, iteration=43, tol=0.000100][running kmeans]: 43it [03:42,  5.04s/it, center_shift=0.361509, iteration=43, tol=0.000100][running kmeans]: 43it [03:47,  5.04s/it, center_shift=0.291874, iteration=44, tol=0.000100][running kmeans]: 44it [03:47,  5.07s/it, center_shift=0.291874, iteration=44, tol=0.000100][running kmeans]: 44it [03:52,  5.07s/it, center_shift=0.363865, iteration=45, tol=0.000100][running kmeans]: 45it [03:52,  5.06s/it, center_shift=0.363865, iteration=45, tol=0.000100][running kmeans]: 45it [03:56,  5.06s/it, center_shift=0.150694, iteration=46, tol=0.000100][running kmeans]: 46it [03:56,  4.91s/it, center_shift=0.150694, iteration=46, tol=0.000100][running kmeans]: 46it [04:02,  4.91s/it, center_shift=0.282893, iteration=47, tol=0.000100][running kmeans]: 47it [04:02,  5.10s/it, center_shift=0.282893, iteration=47, tol=0.000100][running kmeans]: 47it [04:07,  5.10s/it, center_shift=0.115051, iteration=48, tol=0.000100][running kmeans]: 48it [04:07,  5.06s/it, center_shift=0.115051, iteration=48, tol=0.000100][running kmeans]: 48it [04:13,  5.06s/it, center_shift=0.103482, iteration=49, tol=0.000100][running kmeans]: 49it [04:13,  5.24s/it, center_shift=0.103482, iteration=49, tol=0.000100][running kmeans]: 49it [04:18,  5.24s/it, center_shift=0.118427, iteration=50, tol=0.000100][running kmeans]: 50it [04:18,  5.35s/it, center_shift=0.118427, iteration=50, tol=0.000100][running kmeans]: 50it [04:24,  5.35s/it, center_shift=0.104597, iteration=51, tol=0.000100][running kmeans]: 51it [04:24,  5.40s/it, center_shift=0.104597, iteration=51, tol=0.000100][running kmeans]: 51it [04:29,  5.40s/it, center_shift=0.177432, iteration=52, tol=0.000100][running kmeans]: 52it [04:29,  5.34s/it, center_shift=0.177432, iteration=52, tol=0.000100][running kmeans]: 52it [04:33,  5.34s/it, center_shift=0.174317, iteration=53, tol=0.000100][running kmeans]: 53it [04:33,  4.86s/it, center_shift=0.174317, iteration=53, tol=0.000100][running kmeans]: 53it [04:37,  4.86s/it, center_shift=0.152630, iteration=54, tol=0.000100][running kmeans]: 54it [04:37,  4.63s/it, center_shift=0.152630, iteration=54, tol=0.000100][running kmeans]: 54it [04:42,  4.63s/it, center_shift=0.063923, iteration=55, tol=0.000100][running kmeans]: 55it [04:42,  4.88s/it, center_shift=0.063923, iteration=55, tol=0.000100][running kmeans]: 55it [04:47,  4.88s/it, center_shift=0.054424, iteration=56, tol=0.000100][running kmeans]: 56it [04:47,  4.86s/it, center_shift=0.054424, iteration=56, tol=0.000100][running kmeans]: 56it [04:53,  4.86s/it, center_shift=0.058584, iteration=57, tol=0.000100][running kmeans]: 57it [04:53,  5.09s/it, center_shift=0.058584, iteration=57, tol=0.000100][running kmeans]: 57it [04:57,  5.09s/it, center_shift=0.067599, iteration=58, tol=0.000100][running kmeans]: 58it [04:57,  5.01s/it, center_shift=0.067599, iteration=58, tol=0.000100][running kmeans]: 58it [05:03,  5.01s/it, center_shift=0.121508, iteration=59, tol=0.000100][running kmeans]: 59it [05:03,  5.06s/it, center_shift=0.121508, iteration=59, tol=0.000100][running kmeans]: 59it [05:07,  5.06s/it, center_shift=0.102436, iteration=60, tol=0.000100][running kmeans]: 60it [05:07,  4.93s/it, center_shift=0.102436, iteration=60, tol=0.000100][running kmeans]: 60it [05:12,  4.93s/it, center_shift=0.128116, iteration=61, tol=0.000100][running kmeans]: 61it [05:12,  5.02s/it, center_shift=0.128116, iteration=61, tol=0.000100][running kmeans]: 61it [05:17,  5.02s/it, center_shift=0.141974, iteration=62, tol=0.000100][running kmeans]: 62it [05:17,  4.97s/it, center_shift=0.141974, iteration=62, tol=0.000100][running kmeans]: 62it [05:24,  4.97s/it, center_shift=0.090724, iteration=63, tol=0.000100][running kmeans]: 63it [05:24,  5.37s/it, center_shift=0.090724, iteration=63, tol=0.000100][running kmeans]: 63it [05:29,  5.37s/it, center_shift=0.105744, iteration=64, tol=0.000100][running kmeans]: 64it [05:29,  5.38s/it, center_shift=0.105744, iteration=64, tol=0.000100][running kmeans]: 64it [05:34,  5.38s/it, center_shift=0.132564, iteration=65, tol=0.000100][running kmeans]: 65it [05:34,  5.18s/it, center_shift=0.132564, iteration=65, tol=0.000100][running kmeans]: 65it [05:39,  5.18s/it, center_shift=0.125158, iteration=66, tol=0.000100][running kmeans]: 66it [05:39,  5.33s/it, center_shift=0.125158, iteration=66, tol=0.000100][running kmeans]: 66it [05:45,  5.33s/it, center_shift=0.163270, iteration=67, tol=0.000100][running kmeans]: 67it [05:45,  5.47s/it, center_shift=0.163270, iteration=67, tol=0.000100][running kmeans]: 67it [05:52,  5.47s/it, center_shift=0.165446, iteration=68, tol=0.000100][running kmeans]: 68it [05:52,  5.84s/it, center_shift=0.165446, iteration=68, tol=0.000100][running kmeans]: 68it [05:58,  5.84s/it, center_shift=0.127832, iteration=69, tol=0.000100][running kmeans]: 69it [05:58,  5.89s/it, center_shift=0.127832, iteration=69, tol=0.000100][running kmeans]: 69it [06:04,  5.89s/it, center_shift=0.104524, iteration=70, tol=0.000100][running kmeans]: 70it [06:04,  5.95s/it, center_shift=0.104524, iteration=70, tol=0.000100][running kmeans]: 70it [06:08,  5.95s/it, center_shift=0.080529, iteration=71, tol=0.000100][running kmeans]: 71it [06:08,  5.50s/it, center_shift=0.080529, iteration=71, tol=0.000100][running kmeans]: 71it [06:13,  5.50s/it, center_shift=0.058329, iteration=72, tol=0.000100][running kmeans]: 72it [06:13,  5.32s/it, center_shift=0.058329, iteration=72, tol=0.000100][running kmeans]: 72it [06:20,  5.32s/it, center_shift=0.060623, iteration=73, tol=0.000100][running kmeans]: 73it [06:20,  5.67s/it, center_shift=0.060623, iteration=73, tol=0.000100][running kmeans]: 73it [06:25,  5.67s/it, center_shift=0.051254, iteration=74, tol=0.000100][running kmeans]: 74it [06:25,  5.52s/it, center_shift=0.051254, iteration=74, tol=0.000100][running kmeans]: 74it [06:30,  5.52s/it, center_shift=0.047241, iteration=75, tol=0.000100][running kmeans]: 75it [06:30,  5.39s/it, center_shift=0.047241, iteration=75, tol=0.000100][running kmeans]: 75it [06:35,  5.39s/it, center_shift=0.045470, iteration=76, tol=0.000100][running kmeans]: 76it [06:35,  5.33s/it, center_shift=0.045470, iteration=76, tol=0.000100][running kmeans]: 76it [06:42,  5.33s/it, center_shift=0.043535, iteration=77, tol=0.000100][running kmeans]: 77it [06:42,  5.83s/it, center_shift=0.043535, iteration=77, tol=0.000100][running kmeans]: 77it [06:48,  5.83s/it, center_shift=0.029704, iteration=78, tol=0.000100][running kmeans]: 78it [06:48,  5.92s/it, center_shift=0.029704, iteration=78, tol=0.000100][running kmeans]: 78it [06:53,  5.92s/it, center_shift=0.022321, iteration=79, tol=0.000100][running kmeans]: 79it [06:53,  5.55s/it, center_shift=0.022321, iteration=79, tol=0.000100][running kmeans]: 79it [06:58,  5.55s/it, center_shift=0.016770, iteration=80, tol=0.000100][running kmeans]: 80it [06:58,  5.39s/it, center_shift=0.016770, iteration=80, tol=0.000100][running kmeans]: 80it [07:03,  5.39s/it, center_shift=0.016256, iteration=81, tol=0.000100][running kmeans]: 81it [07:03,  5.19s/it, center_shift=0.016256, iteration=81, tol=0.000100][running kmeans]: 81it [07:08,  5.19s/it, center_shift=0.013256, iteration=82, tol=0.000100][running kmeans]: 82it [07:08,  5.06s/it, center_shift=0.013256, iteration=82, tol=0.000100][running kmeans]: 82it [07:13,  5.06s/it, center_shift=0.010872, iteration=83, tol=0.000100][running kmeans]: 83it [07:13,  5.03s/it, center_shift=0.010872, iteration=83, tol=0.000100][running kmeans]: 83it [07:17,  5.03s/it, center_shift=0.015707, iteration=84, tol=0.000100][running kmeans]: 84it [07:17,  4.87s/it, center_shift=0.015707, iteration=84, tol=0.000100][running kmeans]: 84it [07:23,  4.87s/it, center_shift=0.014800, iteration=85, tol=0.000100][running kmeans]: 85it [07:23,  5.11s/it, center_shift=0.014800, iteration=85, tol=0.000100][running kmeans]: 85it [07:27,  5.11s/it, center_shift=0.011003, iteration=86, tol=0.000100][running kmeans]: 86it [07:27,  4.91s/it, center_shift=0.011003, iteration=86, tol=0.000100][running kmeans]: 86it [07:32,  4.91s/it, center_shift=0.009617, iteration=87, tol=0.000100][running kmeans]: 87it [07:32,  4.87s/it, center_shift=0.009617, iteration=87, tol=0.000100][running kmeans]: 87it [07:36,  4.87s/it, center_shift=0.011821, iteration=88, tol=0.000100][running kmeans]: 88it [07:36,  4.71s/it, center_shift=0.011821, iteration=88, tol=0.000100][running kmeans]: 88it [07:40,  4.71s/it, center_shift=0.010878, iteration=89, tol=0.000100][running kmeans]: 89it [07:40,  4.48s/it, center_shift=0.010878, iteration=89, tol=0.000100][running kmeans]: 89it [07:44,  4.48s/it, center_shift=0.009327, iteration=90, tol=0.000100][running kmeans]: 90it [07:44,  4.39s/it, center_shift=0.009327, iteration=90, tol=0.000100][running kmeans]: 90it [07:50,  4.39s/it, center_shift=0.007820, iteration=91, tol=0.000100][running kmeans]: 91it [07:50,  4.78s/it, center_shift=0.007820, iteration=91, tol=0.000100][running kmeans]: 91it [07:55,  4.78s/it, center_shift=0.010618, iteration=92, tol=0.000100][running kmeans]: 92it [07:55,  4.84s/it, center_shift=0.010618, iteration=92, tol=0.000100][running kmeans]: 92it [08:01,  4.84s/it, center_shift=0.012336, iteration=93, tol=0.000100][running kmeans]: 93it [08:01,  5.27s/it, center_shift=0.012336, iteration=93, tol=0.000100][running kmeans]: 93it [08:06,  5.27s/it, center_shift=0.006929, iteration=94, tol=0.000100][running kmeans]: 94it [08:06,  5.01s/it, center_shift=0.006929, iteration=94, tol=0.000100][running kmeans]: 94it [08:10,  5.01s/it, center_shift=0.008316, iteration=95, tol=0.000100][running kmeans]: 95it [08:10,  4.69s/it, center_shift=0.008316, iteration=95, tol=0.000100][running kmeans]: 95it [08:14,  4.69s/it, center_shift=0.007356, iteration=96, tol=0.000100][running kmeans]: 96it [08:14,  4.58s/it, center_shift=0.007356, iteration=96, tol=0.000100][running kmeans]: 96it [08:18,  4.58s/it, center_shift=0.006066, iteration=97, tol=0.000100][running kmeans]: 97it [08:18,  4.53s/it, center_shift=0.006066, iteration=97, tol=0.000100][running kmeans]: 97it [08:23,  4.53s/it, center_shift=0.007579, iteration=98, tol=0.000100][running kmeans]: 98it [08:23,  4.63s/it, center_shift=0.007579, iteration=98, tol=0.000100][running kmeans]: 98it [08:28,  4.63s/it, center_shift=0.005631, iteration=99, tol=0.000100][running kmeans]: 99it [08:28,  4.70s/it, center_shift=0.005631, iteration=99, tol=0.000100][running kmeans]: 99it [08:34,  4.70s/it, center_shift=0.005652, iteration=100, tol=0.000100][running kmeans]: 100it [08:34,  5.04s/it, center_shift=0.005652, iteration=100, tol=0.000100][running kmeans]: 100it [08:40,  5.04s/it, center_shift=0.004379, iteration=101, tol=0.000100][running kmeans]: 101it [08:40,  5.21s/it, center_shift=0.004379, iteration=101, tol=0.000100][running kmeans]: 101it [08:44,  5.21s/it, center_shift=0.003221, iteration=102, tol=0.000100][running kmeans]: 102it [08:44,  4.87s/it, center_shift=0.003221, iteration=102, tol=0.000100][running kmeans]: 102it [08:49,  4.87s/it, center_shift=0.003217, iteration=103, tol=0.000100][running kmeans]: 103it [08:49,  4.92s/it, center_shift=0.003217, iteration=103, tol=0.000100][running kmeans]: 103it [08:53,  4.92s/it, center_shift=0.002808, iteration=104, tol=0.000100][running kmeans]: 104it [08:53,  4.61s/it, center_shift=0.002808, iteration=104, tol=0.000100][running kmeans]: 104it [08:57,  4.61s/it, center_shift=0.001573, iteration=105, tol=0.000100][running kmeans]: 105it [08:57,  4.60s/it, center_shift=0.001573, iteration=105, tol=0.000100][running kmeans]: 105it [09:02,  4.60s/it, center_shift=0.001388, iteration=106, tol=0.000100][running kmeans]: 106it [09:02,  4.61s/it, center_shift=0.001388, iteration=106, tol=0.000100][running kmeans]: 106it [09:05,  4.61s/it, center_shift=0.000920, iteration=107, tol=0.000100][running kmeans]: 107it [09:05,  4.24s/it, center_shift=0.000920, iteration=107, tol=0.000100][running kmeans]: 107it [09:10,  4.24s/it, center_shift=0.000550, iteration=108, tol=0.000100][running kmeans]: 108it [09:10,  4.39s/it, center_shift=0.000550, iteration=108, tol=0.000100][running kmeans]: 108it [09:14,  4.39s/it, center_shift=0.000565, iteration=109, tol=0.000100][running kmeans]: 109it [09:14,  4.22s/it, center_shift=0.000565, iteration=109, tol=0.000100][running kmeans]: 109it [09:17,  4.22s/it, center_shift=0.000788, iteration=110, tol=0.000100][running kmeans]: 110it [09:17,  4.04s/it, center_shift=0.000788, iteration=110, tol=0.000100][running kmeans]: 110it [09:22,  4.04s/it, center_shift=0.000856, iteration=111, tol=0.000100][running kmeans]: 111it [09:22,  4.15s/it, center_shift=0.000856, iteration=111, tol=0.000100][running kmeans]: 111it [09:27,  4.15s/it, center_shift=0.000673, iteration=112, tol=0.000100][running kmeans]: 112it [09:27,  4.33s/it, center_shift=0.000673, iteration=112, tol=0.000100][running kmeans]: 112it [09:30,  4.33s/it, center_shift=0.000679, iteration=113, tol=0.000100][running kmeans]: 113it [09:30,  4.00s/it, center_shift=0.000679, iteration=113, tol=0.000100][running kmeans]: 113it [09:34,  4.00s/it, center_shift=0.000135, iteration=114, tol=0.000100][running kmeans]: 114it [09:34,  4.08s/it, center_shift=0.000135, iteration=114, tol=0.000100][running kmeans]: 114it [09:38,  4.08s/it, center_shift=0.000130, iteration=115, tol=0.000100][running kmeans]: 115it [09:38,  4.17s/it, center_shift=0.000130, iteration=115, tol=0.000100][running kmeans]: 115it [09:42,  4.17s/it, center_shift=0.000175, iteration=116, tol=0.000100][running kmeans]: 116it [09:42,  4.05s/it, center_shift=0.000175, iteration=116, tol=0.000100][running kmeans]: 116it [09:45,  4.05s/it, center_shift=0.000157, iteration=117, tol=0.000100][running kmeans]: 117it [09:45,  3.65s/it, center_shift=0.000157, iteration=117, tol=0.000100][running kmeans]: 117it [09:49,  3.65s/it, center_shift=0.000116, iteration=118, tol=0.000100][running kmeans]: 118it [09:49,  3.90s/it, center_shift=0.000116, iteration=118, tol=0.000100][running kmeans]: 118it [09:54,  3.90s/it, center_shift=0.000077, iteration=119, tol=0.000100][running kmeans]: 119it [09:54,  4.15s/it, center_shift=0.000077, iteration=119, tol=0.000100][running kmeans]: 119it [09:54,  5.00s/it, center_shift=0.000077, iteration=119, tol=0.000100]
[ 4 28 28 ... 30 24  8]
idx_attach: tensor([141485,  69265,  85867, 114559,  17967,  14850,  48121,  56100, 165747,
         80920,  37753,  71481,  11863, 107246,  45117, 127273,  51921, 143592,
        147906, 152243,  86346, 119035,  37847, 139423,  38501,  99249,  57735,
         48454, 112903, 162171,  26469,   2597, 148118,  13705, 165754,  85761,
         15127,  53182, 117978,  44434,   9245,  11671,  32201, 108210,  40973,
        120194,  62724,  25471,  89307,  10883,  47597, 131540,  51082,  50649,
        114680, 130047,  84427,  75700, 129340, 118380,  80908,  68652,  27243,
         49625, 120137, 145764, 124037, 131367, 135129,  91463,  94953,  99212,
        105595,  30620,  22606, 131370,  56024, 102644, 136850,  63166,  52945,
         61108,  78955,  62638, 106503,    776,  92196, 146706,  34788,  44157,
        131032,  87654, 131829, 164700,  51932,  11175,  27424,   6214,  47086,
         69005,  68488,  27696,  49455, 161571,  10403, 133957,  20984,  65924,
         86085,  40001,  33192,  66533,  10930, 154510, 155452, 144369, 166684,
         91568,  93975, 128010,  10526,  37510, 161076, 108283,  36024, 163047,
         83422,  46532,  63861,   7073,  50425, 144542,  60362, 156948,  16756],
       device='cuda:2')
Epoch 0, loss_inner: 3.72632, loss_target: 3.53675, homo loss: 0.62005 
acc_train_clean: 0.0115, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 2.89101, loss_target: 2.91458, homo loss: 0.00016 
acc_train_clean: 0.2827, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 2.49678, loss_target: 2.45413, homo loss: 0.00277 
acc_train_clean: 0.3285, ASR_train_attach: 0.6074, ASR_train_outter: 0.2813
Epoch 30, loss_inner: 2.08267, loss_target: 2.03648, homo loss: 0.00035 
acc_train_clean: 0.4715, ASR_train_attach: 0.9852, ASR_train_outter: 0.7141
Epoch 40, loss_inner: 1.76433, loss_target: 1.72153, homo loss: 0.00040 
acc_train_clean: 0.5371, ASR_train_attach: 1.0000, ASR_train_outter: 0.9413
Epoch 50, loss_inner: 1.55487, loss_target: 1.52121, homo loss: 0.00004 
acc_train_clean: 0.5796, ASR_train_attach: 1.0000, ASR_train_outter: 0.9629
Epoch 60, loss_inner: 1.42813, loss_target: 1.40218, homo loss: 0.00000 
acc_train_clean: 0.6012, ASR_train_attach: 1.0000, ASR_train_outter: 0.9675
Epoch 70, loss_inner: 1.34887, loss_target: 1.32519, homo loss: 0.00000 
acc_train_clean: 0.6174, ASR_train_attach: 1.0000, ASR_train_outter: 0.9799
Epoch 80, loss_inner: 1.29403, loss_target: 1.27223, homo loss: 0.00000 
acc_train_clean: 0.6283, ASR_train_attach: 1.0000, ASR_train_outter: 0.9845
Epoch 90, loss_inner: 1.25448, loss_target: 1.23410, homo loss: 0.00001 
acc_train_clean: 0.6379, ASR_train_attach: 1.0000, ASR_train_outter: 0.9876
Epoch 100, loss_inner: 1.22400, loss_target: 1.20497, homo loss: 0.00000 
acc_train_clean: 0.6442, ASR_train_attach: 1.0000, ASR_train_outter: 0.9892
Epoch 110, loss_inner: 1.19823, loss_target: 1.17937, homo loss: 0.00000 
acc_train_clean: 0.6512, ASR_train_attach: 1.0000, ASR_train_outter: 0.9907
Epoch 120, loss_inner: 1.17928, loss_target: 1.16183, homo loss: 0.00006 
acc_train_clean: 0.6569, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 130, loss_inner: 1.16682, loss_target: 1.14926, homo loss: 0.00000 
acc_train_clean: 0.6586, ASR_train_attach: 1.0000, ASR_train_outter: 0.9938
Epoch 140, loss_inner: 1.15967, loss_target: 1.14510, homo loss: 0.00000 
acc_train_clean: 0.6631, ASR_train_attach: 1.0000, ASR_train_outter: 0.9938
Epoch 150, loss_inner: 1.15136, loss_target: 1.13690, homo loss: 0.00000 
acc_train_clean: 0.6633, ASR_train_attach: 1.0000, ASR_train_outter: 0.9954
Epoch 160, loss_inner: 1.17298, loss_target: 1.21083, homo loss: 0.01083 
acc_train_clean: 0.6640, ASR_train_attach: 1.0000, ASR_train_outter: 0.9892
Epoch 170, loss_inner: 1.35236, loss_target: 1.46362, homo loss: 0.01101 
acc_train_clean: 0.6220, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 180, loss_inner: 1.24195, loss_target: 1.26142, homo loss: 0.00091 
acc_train_clean: 0.6518, ASR_train_attach: 1.0000, ASR_train_outter: 0.9985
Epoch 190, loss_inner: 1.22721, loss_target: 1.26092, homo loss: 0.00101 
acc_train_clean: 0.6516, ASR_train_attach: 1.0000, ASR_train_outter: 0.9969
precent of left attach nodes: 0.985
target class rate on Vs: 0.9852
accuracy on clean test nodes: 0.6562
ASR: 0.9975
Flip ASR: 0.9975/16868 nodes
CA: 0.6476
