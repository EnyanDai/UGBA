Namespace(cuda=True, dataset='ogbn-arxiv', debug=True, defense_mode='none', device_id=0, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
Length of training set: 33868
Training benign model Finished!
Total time elapsed: 16.2402s
Benign CA: 0.6635
#Attach Nodes:80
Length of training set: 33868
=== training gcn model ===
Epoch 0, training loss: 3.681273937225342
acc_val: 0.1259
Epoch 10, training loss: 2.7629237174987793
acc_val: 0.2958
Epoch 20, training loss: 2.2285561561584473
acc_val: 0.4148
Epoch 30, training loss: 1.9698394536972046
acc_val: 0.5031
Epoch 40, training loss: 1.8121989965438843
acc_val: 0.5433
Epoch 50, training loss: 1.718615174293518
acc_val: 0.5718
Epoch 60, training loss: 1.6578024625778198
acc_val: 0.5864
Epoch 70, training loss: 1.612280249595642
acc_val: 0.5968
Epoch 80, training loss: 1.5811066627502441
acc_val: 0.6045
Epoch 90, training loss: 1.5515023469924927
acc_val: 0.6138
Epoch 100, training loss: 1.538948893547058
acc_val: 0.6176
Epoch 110, training loss: 1.5091153383255005
acc_val: 0.6257
Epoch 120, training loss: 1.4960966110229492
acc_val: 0.6300
Epoch 130, training loss: 1.4880499839782715
acc_val: 0.6337
Epoch 140, training loss: 1.4792424440383911
acc_val: 0.6325
Epoch 150, training loss: 1.469826340675354
acc_val: 0.6351
Epoch 160, training loss: 1.4550628662109375
acc_val: 0.6382
Epoch 170, training loss: 1.462441325187683
acc_val: 0.6332
Epoch 180, training loss: 1.4447715282440186
acc_val: 0.6413
Epoch 190, training loss: 1.447475552558899
acc_val: 0.6415
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 14.5968s
Encoder CA on clean test nodes: 0.6434
[ 4 28 28 ... 24  4  4]
idx_attach: tensor([ 26951, 104982,  16963,  ..., 106699,  25208,  67166], device='cuda:0')
