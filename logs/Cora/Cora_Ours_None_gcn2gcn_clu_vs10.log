nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:10
Length of training set: 541
=== training gcn model ===
Epoch 0, training loss: 1.9476138353347778
acc_val: 0.1000
Epoch 10, training loss: 1.8272963762283325
acc_val: 0.3222
Epoch 20, training loss: 1.6676915884017944
acc_val: 0.3370
Epoch 30, training loss: 1.4120478630065918
acc_val: 0.4444
Epoch 40, training loss: 1.1951451301574707
acc_val: 0.5444
Epoch 50, training loss: 1.0311895608901978
acc_val: 0.5963
Epoch 60, training loss: 0.8929177522659302
acc_val: 0.6815
Epoch 70, training loss: 0.7830051183700562
acc_val: 0.7111
Epoch 80, training loss: 0.7028149962425232
acc_val: 0.7519
Epoch 90, training loss: 0.6369844675064087
acc_val: 0.7963
Epoch 100, training loss: 0.6065099835395813
acc_val: 0.8556
Epoch 110, training loss: 0.48509642481803894
acc_val: 0.8296
Epoch 120, training loss: 0.4672015905380249
acc_val: 0.8222
Epoch 130, training loss: 0.48105794191360474
acc_val: 0.8222
Epoch 140, training loss: 0.43625497817993164
acc_val: 0.8148
Epoch 150, training loss: 0.3862571716308594
acc_val: 0.8111
Epoch 160, training loss: 0.37785980105400085
acc_val: 0.8185
Epoch 170, training loss: 0.34606966376304626
acc_val: 0.8111
Epoch 180, training loss: 0.29722708463668823
acc_val: 0.8148
Epoch 190, training loss: 0.31007832288742065
acc_val: 0.8148
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 2.3415s
Encoder CA on clean test nodes: 0.8074
[1 3 3 ... 2 1 1]
idx_attach: tensor([ 109,   88, 1072, 1013, 1224, 1131,  350, 2367, 2394, 1505],
       device='cuda:2')
tensor([   0,    2,    3,  ..., 2704, 2705, 2706], device='cuda:2')
Epoch 0, loss_inner: 1.94584, loss_target: 1.93106, homo loss: 0.40155 
acc_train_clean: 0.1331, ASR_train_attach: 0.2000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 1.76133, loss_target: 1.08467, homo loss: 0.13756 
acc_train_clean: 0.2902, ASR_train_attach: 0.8000, ASR_train_outter: 0.9789
Epoch 20, loss_inner: 1.59334, loss_target: 0.94238, homo loss: 0.00148 
acc_train_clean: 0.3401, ASR_train_attach: 1.0000, ASR_train_outter: 0.9866
Epoch 30, loss_inner: 1.38153, loss_target: 0.74045, homo loss: 0.00002 
acc_train_clean: 0.5878, ASR_train_attach: 0.9000, ASR_train_outter: 0.9847
Epoch 40, loss_inner: 1.15736, loss_target: 0.91580, homo loss: 0.00055 
acc_train_clean: 0.7116, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 50, loss_inner: 0.95431, loss_target: 0.57553, homo loss: 0.00000 
acc_train_clean: 0.8299, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 60, loss_inner: 0.77952, loss_target: 0.42049, homo loss: 0.00000 
acc_train_clean: 0.9076, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 70, loss_inner: 0.65464, loss_target: 0.68817, homo loss: 0.00000 
acc_train_clean: 0.9316, ASR_train_attach: 0.5000, ASR_train_outter: 0.6092
Epoch 80, loss_inner: 0.55857, loss_target: 0.35006, homo loss: 0.00000 
acc_train_clean: 0.9353, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 90, loss_inner: 0.49357, loss_target: 0.28059, homo loss: 0.00128 
acc_train_clean: 0.9445, ASR_train_attach: 0.7000, ASR_train_outter: 1.0000
Epoch 100, loss_inner: 0.43707, loss_target: 0.17935, homo loss: 0.00007 
acc_train_clean: 0.9519, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 110, loss_inner: 0.39375, loss_target: 0.15188, homo loss: 0.00000 
acc_train_clean: 0.9575, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 120, loss_inner: 0.36341, loss_target: 0.13255, homo loss: 0.00000 
acc_train_clean: 0.9612, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 130, loss_inner: 0.34258, loss_target: 0.12334, homo loss: 0.00000 
acc_train_clean: 0.9649, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 140, loss_inner: 0.32432, loss_target: 0.11754, homo loss: 0.00000 
acc_train_clean: 0.9686, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 150, loss_inner: 0.30944, loss_target: 0.11266, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 160, loss_inner: 0.29681, loss_target: 0.10841, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 170, loss_inner: 0.28582, loss_target: 0.10465, homo loss: 0.00001 
acc_train_clean: 0.9704, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 180, loss_inner: 0.27629, loss_target: 0.10154, homo loss: 0.00002 
acc_train_clean: 0.9723, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 190, loss_inner: 0.26782, loss_target: 0.09970, homo loss: 0.00006 
acc_train_clean: 0.9760, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 200, loss_inner: 0.26042, loss_target: 0.09720, homo loss: 0.00001 
acc_train_clean: 0.9760, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 210, loss_inner: 0.25388, loss_target: 0.09464, homo loss: 0.00001 
acc_train_clean: 0.9760, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 220, loss_inner: 0.24798, loss_target: 0.09307, homo loss: 0.00000 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 230, loss_inner: 0.24321, loss_target: 0.09194, homo loss: 0.00001 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 240, loss_inner: 0.23822, loss_target: 0.09091, homo loss: 0.00002 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 250, loss_inner: 0.23338, loss_target: 0.08833, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 260, loss_inner: 0.22928, loss_target: 0.08635, homo loss: 0.00000 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 270, loss_inner: 0.22567, loss_target: 0.08610, homo loss: 0.00004 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 280, loss_inner: 0.22511, loss_target: 0.09331, homo loss: 0.00087 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 290, loss_inner: 0.22197, loss_target: 0.09066, homo loss: 0.00003 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 300, loss_inner: 0.21798, loss_target: 0.08426, homo loss: 0.00002 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 310, loss_inner: 0.21555, loss_target: 0.08131, homo loss: 0.00000 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 320, loss_inner: 0.21235, loss_target: 0.07952, homo loss: 0.00001 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 330, loss_inner: 0.20960, loss_target: 0.07847, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 340, loss_inner: 0.20733, loss_target: 0.07766, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 350, loss_inner: 0.20517, loss_target: 0.07698, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 360, loss_inner: 0.20382, loss_target: 0.07715, homo loss: 0.00032 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 370, loss_inner: 0.20237, loss_target: 0.07922, homo loss: 0.00001 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 380, loss_inner: 0.20089, loss_target: 0.07749, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 390, loss_inner: 0.19963, loss_target: 0.07612, homo loss: 0.00001 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8333
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8259
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Overall ASR: 0.9963 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8356
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8593
Overall ASR: 1.0000
Flip ASR: 1.0000/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8481
Overall ASR: 1.0000
Flip ASR: 1.0000/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8593
Overall ASR: 0.9963
Flip ASR: 0.9956/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8593
Overall ASR: 1.0000
Flip ASR: 1.0000/225 nodes
Overall ASR: 0.9985 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8533
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8296
Overall ASR: 0.8044
Flip ASR: 0.7644/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8333
Overall ASR: 0.8007
Flip ASR: 0.7600/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8296
Overall ASR: 0.8155
Flip ASR: 0.7778/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8037
Overall ASR: 0.7675
Flip ASR: 0.7200/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=-1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.4, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8444
Overall ASR: 0.8487
Flip ASR: 0.8178/225 nodes
Overall ASR: 0.8074 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8281
Total Overall ASR: 0.9341 
Total Clean Accuracy: 0.8390
