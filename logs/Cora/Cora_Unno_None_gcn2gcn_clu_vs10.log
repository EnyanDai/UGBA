nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:10
idx_attach: tensor([1032, 1201,  760, 2567, 1147, 2063, 2574, 1535,  843,  801],
       device='cuda:2')
tensor([   0,    2,    3,  ..., 2704, 2705, 2706], device='cuda:2')
Epoch 0, loss_inner: 1.94620, loss_target: 1.91635, homo loss: 0.49908 
acc_train_clean: 0.1054, ASR_train_attach: 0.0000, ASR_train_outter: 0.6092
Epoch 10, loss_inner: 1.76995, loss_target: 1.12808, homo loss: 0.24303 
acc_train_clean: 0.2865, ASR_train_attach: 0.6000, ASR_train_outter: 0.9023
Epoch 20, loss_inner: 1.64411, loss_target: 1.05782, homo loss: 0.01922 
acc_train_clean: 0.2921, ASR_train_attach: 0.9000, ASR_train_outter: 0.9195
Epoch 30, loss_inner: 1.46809, loss_target: 0.83806, homo loss: 0.00004 
acc_train_clean: 0.4344, ASR_train_attach: 1.0000, ASR_train_outter: 0.9904
Epoch 40, loss_inner: 1.25764, loss_target: 0.67770, homo loss: 0.00005 
acc_train_clean: 0.6543, ASR_train_attach: 1.0000, ASR_train_outter: 0.9885
Epoch 50, loss_inner: 1.04428, loss_target: 0.58103, homo loss: 0.00151 
acc_train_clean: 0.8207, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 60, loss_inner: 0.88493, loss_target: 0.56721, homo loss: 0.00008 
acc_train_clean: 0.8743, ASR_train_attach: 0.9000, ASR_train_outter: 0.9789
Epoch 70, loss_inner: 0.73615, loss_target: 0.43382, homo loss: 0.00011 
acc_train_clean: 0.9205, ASR_train_attach: 0.9000, ASR_train_outter: 0.9789
Epoch 80, loss_inner: 0.61417, loss_target: 0.35061, homo loss: 0.00000 
acc_train_clean: 0.9298, ASR_train_attach: 0.9000, ASR_train_outter: 0.9962
Epoch 90, loss_inner: 0.52958, loss_target: 0.30096, homo loss: 0.00000 
acc_train_clean: 0.9464, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 100, loss_inner: 0.47324, loss_target: 0.27223, homo loss: 0.00001 
acc_train_clean: 0.9519, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 110, loss_inner: 0.44866, loss_target: 0.37547, homo loss: 0.00465 
acc_train_clean: 0.9519, ASR_train_attach: 0.6000, ASR_train_outter: 0.8487
Epoch 120, loss_inner: 0.40406, loss_target: 0.27324, homo loss: 0.00003 
acc_train_clean: 0.9556, ASR_train_attach: 0.7000, ASR_train_outter: 0.9789
Epoch 130, loss_inner: 0.37237, loss_target: 0.23026, homo loss: 0.00000 
acc_train_clean: 0.9630, ASR_train_attach: 0.8000, ASR_train_outter: 1.0000
Epoch 140, loss_inner: 0.35304, loss_target: 0.20702, homo loss: 0.00000 
acc_train_clean: 0.9649, ASR_train_attach: 0.7000, ASR_train_outter: 0.9962
Epoch 150, loss_inner: 0.33575, loss_target: 0.19660, homo loss: 0.00000 
acc_train_clean: 0.9649, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 160, loss_inner: 0.32080, loss_target: 0.18925, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 170, loss_inner: 0.31152, loss_target: 0.21518, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.6000, ASR_train_outter: 0.9598
Epoch 180, loss_inner: 0.29510, loss_target: 0.18754, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.9000, ASR_train_outter: 0.9962
Epoch 190, loss_inner: 0.28726, loss_target: 0.17409, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 200, loss_inner: 0.28704, loss_target: 0.16994, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 0.7000, ASR_train_outter: 1.0000
Epoch 210, loss_inner: 0.29264, loss_target: 0.22723, homo loss: 0.00005 
acc_train_clean: 0.9667, ASR_train_attach: 0.8000, ASR_train_outter: 0.9789
Epoch 220, loss_inner: 0.26480, loss_target: 0.22061, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 230, loss_inner: 0.26072, loss_target: 0.18316, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.7000, ASR_train_outter: 0.9943
Epoch 240, loss_inner: 0.26300, loss_target: 0.17492, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.7000, ASR_train_outter: 0.9943
Epoch 250, loss_inner: 0.26993, loss_target: 0.18081, homo loss: 0.00000 
acc_train_clean: 0.9667, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 260, loss_inner: 0.26537, loss_target: 0.21409, homo loss: 0.00003 
acc_train_clean: 0.9741, ASR_train_attach: 0.6000, ASR_train_outter: 0.9368
Epoch 270, loss_inner: 0.24400, loss_target: 0.16184, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 0.9923
Epoch 280, loss_inner: 0.23978, loss_target: 0.15138, homo loss: 0.00000 
acc_train_clean: 0.9760, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 290, loss_inner: 0.23880, loss_target: 0.15472, homo loss: 0.00000 
acc_train_clean: 0.9760, ASR_train_attach: 0.9000, ASR_train_outter: 0.9962
Epoch 300, loss_inner: 0.23442, loss_target: 0.14615, homo loss: 0.00001 
acc_train_clean: 0.9760, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 310, loss_inner: 0.23233, loss_target: 0.17297, homo loss: 0.00000 
acc_train_clean: 0.9760, ASR_train_attach: 0.9000, ASR_train_outter: 0.9636
Epoch 320, loss_inner: 0.23573, loss_target: 0.27631, homo loss: 0.03497 
acc_train_clean: 0.9741, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 330, loss_inner: 0.22469, loss_target: 0.17817, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 340, loss_inner: 0.24957, loss_target: 0.17578, homo loss: 0.00002 
acc_train_clean: 0.9778, ASR_train_attach: 0.6000, ASR_train_outter: 0.9943
Epoch 350, loss_inner: 0.24799, loss_target: 0.23194, homo loss: 0.00000 
acc_train_clean: 0.9667, ASR_train_attach: 1.0000, ASR_train_outter: 0.9828
Epoch 360, loss_inner: 0.22135, loss_target: 0.18302, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 0.9789
Epoch 370, loss_inner: 0.21825, loss_target: 0.14723, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 380, loss_inner: 0.21941, loss_target: 0.14117, homo loss: 0.00000 
acc_train_clean: 0.9815, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 390, loss_inner: 0.21791, loss_target: 0.13929, homo loss: 0.00000 
acc_train_clean: 0.9834, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=265, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.9410
Flip ASR: 0.9289/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=125, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.9410
Flip ASR: 0.9289/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=996, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.9299
Flip ASR: 0.9156/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=527, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8259
Overall ASR: 0.9631
Flip ASR: 0.9556/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=320, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8444
Overall ASR: 0.9631
Flip ASR: 0.9556/225 nodes
Overall ASR: 0.9476 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8363
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=781, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8630
Overall ASR: 0.6052
Flip ASR: 0.5333/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=706, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.5830
Flip ASR: 0.5067/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=778, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8444
Overall ASR: 0.6384
Flip ASR: 0.5733/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=604, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.6679
Flip ASR: 0.6044/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=133, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8259
Overall ASR: 0.6089
Flip ASR: 0.5378/225 nodes
Overall ASR: 0.6207 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8430
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=673, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.8635
Flip ASR: 0.8356/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=904, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8111
Overall ASR: 0.8635
Flip ASR: 0.8356/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=56, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8037
Overall ASR: 0.8635
Flip ASR: 0.8356/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=1, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.7889
Overall ASR: 0.8524
Flip ASR: 0.8222/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=694, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8333
Overall ASR: 0.8450
Flip ASR: 0.8133/225 nodes
Overall ASR: 0.8576 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8156
Total Overall ASR: 0.8086 
Total Clean Accuracy: 0.8316
