nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:10
idx_attach: tensor([1032, 1201,  760, 2567, 1147, 2063, 2574, 1535,  843,  801],
       device='cuda:2')
tensor([   0,    2,    3,  ..., 2704, 2705, 2706], device='cuda:2')
Epoch 0, loss_inner: 1.94620, loss_target: 1.91635, homo loss: 0.49908 
acc_train_clean: 0.1054, ASR_train_attach: 0.0000, ASR_train_outter: 0.6092
Epoch 10, loss_inner: 1.76995, loss_target: 1.12808, homo loss: 0.24303 
acc_train_clean: 0.2865, ASR_train_attach: 0.6000, ASR_train_outter: 0.9023
Epoch 20, loss_inner: 1.64411, loss_target: 1.05782, homo loss: 0.01922 
acc_train_clean: 0.2921, ASR_train_attach: 0.9000, ASR_train_outter: 0.9195
Epoch 30, loss_inner: 1.46809, loss_target: 0.83806, homo loss: 0.00004 
acc_train_clean: 0.4344, ASR_train_attach: 1.0000, ASR_train_outter: 0.9904
Epoch 40, loss_inner: 1.25765, loss_target: 0.67791, homo loss: 0.00005 
acc_train_clean: 0.6543, ASR_train_attach: 1.0000, ASR_train_outter: 0.9885
Epoch 50, loss_inner: 1.06844, loss_target: 0.79561, homo loss: 0.00026 
acc_train_clean: 0.8207, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 0.88328, loss_target: 0.52359, homo loss: 0.00000 
acc_train_clean: 0.8983, ASR_train_attach: 1.0000, ASR_train_outter: 0.9923
Epoch 70, loss_inner: 0.72343, loss_target: 0.40170, homo loss: 0.00001 
acc_train_clean: 0.9242, ASR_train_attach: 0.9000, ASR_train_outter: 0.9866
Epoch 80, loss_inner: 0.60504, loss_target: 0.32748, homo loss: 0.00003 
acc_train_clean: 0.9390, ASR_train_attach: 0.8000, ASR_train_outter: 0.9923
Epoch 90, loss_inner: 0.52666, loss_target: 0.32808, homo loss: 0.00000 
acc_train_clean: 0.9482, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 100, loss_inner: 0.46859, loss_target: 0.29309, homo loss: 0.00010 
acc_train_clean: 0.9538, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 110, loss_inner: 0.42897, loss_target: 0.24140, homo loss: 0.00000 
acc_train_clean: 0.9538, ASR_train_attach: 0.8000, ASR_train_outter: 0.9943
Epoch 120, loss_inner: 0.41298, loss_target: 0.27159, homo loss: 0.02030 
acc_train_clean: 0.9556, ASR_train_attach: 0.3000, ASR_train_outter: 0.9828
Epoch 130, loss_inner: 0.37321, loss_target: 0.25453, homo loss: 0.00000 
acc_train_clean: 0.9630, ASR_train_attach: 1.0000, ASR_train_outter: 0.9770
Epoch 140, loss_inner: 0.34767, loss_target: 0.21912, homo loss: 0.00004 
acc_train_clean: 0.9649, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 150, loss_inner: 0.32982, loss_target: 0.20116, homo loss: 0.00003 
acc_train_clean: 0.9667, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 160, loss_inner: 0.31738, loss_target: 0.19032, homo loss: 0.00000 
acc_train_clean: 0.9667, ASR_train_attach: 0.8000, ASR_train_outter: 0.9981
Epoch 170, loss_inner: 0.31671, loss_target: 0.32982, homo loss: 0.00000 
acc_train_clean: 0.9667, ASR_train_attach: 0.9000, ASR_train_outter: 0.9770
Epoch 180, loss_inner: 0.29835, loss_target: 0.19476, homo loss: 0.00002 
acc_train_clean: 0.9704, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 190, loss_inner: 0.29215, loss_target: 0.17256, homo loss: 0.00002 
acc_train_clean: 0.9686, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 200, loss_inner: 0.31015, loss_target: 0.33051, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 0.4000, ASR_train_outter: 0.7778
Epoch 210, loss_inner: 0.28497, loss_target: 0.22847, homo loss: 0.00005 
acc_train_clean: 0.9649, ASR_train_attach: 0.9000, ASR_train_outter: 0.9847
Epoch 220, loss_inner: 0.26840, loss_target: 0.18469, homo loss: 0.00002 
acc_train_clean: 0.9723, ASR_train_attach: 0.7000, ASR_train_outter: 0.9943
Epoch 230, loss_inner: 0.26015, loss_target: 0.17119, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 240, loss_inner: 0.26015, loss_target: 0.16630, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 0.8000, ASR_train_outter: 0.9962
Epoch 250, loss_inner: 0.25782, loss_target: 0.16332, homo loss: 0.00000 
acc_train_clean: 0.9723, ASR_train_attach: 0.8000, ASR_train_outter: 1.0000
Epoch 260, loss_inner: 0.26983, loss_target: 0.40277, homo loss: 0.00237 
acc_train_clean: 0.9649, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 270, loss_inner: 0.23958, loss_target: 0.19679, homo loss: 0.00000 
acc_train_clean: 0.9760, ASR_train_attach: 1.0000, ASR_train_outter: 0.9904
Epoch 280, loss_inner: 0.26741, loss_target: 0.19533, homo loss: 0.00008 
acc_train_clean: 0.9704, ASR_train_attach: 0.4000, ASR_train_outter: 0.9962
Epoch 290, loss_inner: 0.35651, loss_target: 0.41341, homo loss: 0.00000 
acc_train_clean: 0.9353, ASR_train_attach: 0.9000, ASR_train_outter: 0.9732
Epoch 300, loss_inner: 0.26100, loss_target: 0.21320, homo loss: 0.00001 
acc_train_clean: 0.9630, ASR_train_attach: 0.9000, ASR_train_outter: 0.9904
Epoch 310, loss_inner: 0.23285, loss_target: 0.17271, homo loss: 0.00000 
acc_train_clean: 0.9704, ASR_train_attach: 0.9000, ASR_train_outter: 0.9962
Epoch 320, loss_inner: 0.22989, loss_target: 0.15539, homo loss: 0.00000 
acc_train_clean: 0.9741, ASR_train_attach: 0.8000, ASR_train_outter: 0.9981
Epoch 330, loss_inner: 0.22872, loss_target: 0.14704, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 340, loss_inner: 0.22635, loss_target: 0.14310, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 350, loss_inner: 0.22390, loss_target: 0.14181, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 360, loss_inner: 0.22085, loss_target: 0.14400, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 370, loss_inner: 0.21951, loss_target: 0.14088, homo loss: 0.00000 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 1.0000
Epoch 380, loss_inner: 0.21655, loss_target: 0.13994, homo loss: 0.00018 
acc_train_clean: 0.9797, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 390, loss_inner: 0.21925, loss_target: 0.21454, homo loss: 0.00304 
acc_train_clean: 0.9778, ASR_train_attach: 0.9000, ASR_train_outter: 0.9406
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=265, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8222
Overall ASR: 0.9336
Flip ASR: 0.9200/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=125, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8296
Overall ASR: 0.9410
Flip ASR: 0.9289/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=996, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.9077
Flip ASR: 0.8889/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=527, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8259
Overall ASR: 0.9373
Flip ASR: 0.9244/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=320, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8519
Overall ASR: 0.9520
Flip ASR: 0.9422/225 nodes
Overall ASR: 0.9343 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8333
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=781, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8074
Overall ASR: 0.7601
Flip ASR: 0.7111/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=706, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.7306
Flip ASR: 0.6756/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=778, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8444
Overall ASR: 0.9410
Flip ASR: 0.9289/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=604, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8296
Overall ASR: 0.7528
Flip ASR: 0.7156/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=133, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8407
Overall ASR: 0.7528
Flip ASR: 0.7156/225 nodes
Overall ASR: 0.7875 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8319
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=673, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.8155
Flip ASR: 0.7822/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=904, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8370
Overall ASR: 0.8376
Flip ASR: 0.8044/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=56, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8259
Overall ASR: 0.8044
Flip ASR: 0.7689/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=1, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8185
Overall ASR: 0.7860
Flip ASR: 0.7467/225 nodes
Namespace(cuda=True, dataset='Cora', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.1, seed=694, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8185
Overall ASR: 0.7934
Flip ASR: 0.7556/225 nodes
Overall ASR: 0.8074 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8274
Total Overall ASR: 0.8431 
Total Clean Accuracy: 0.8309
