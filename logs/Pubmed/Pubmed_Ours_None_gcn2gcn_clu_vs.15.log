nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 10.7124s
Benign CA: 0.8554
#Attach Nodes:15
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.1248021125793457
acc_val: 0.2035
Epoch 10, training loss: 1.035003423690796
acc_val: 0.4033
Epoch 20, training loss: 0.927193284034729
acc_val: 0.4485
Epoch 30, training loss: 0.7763608694076538
acc_val: 0.6799
Epoch 40, training loss: 0.6315062642097473
acc_val: 0.8234
Epoch 50, training loss: 0.5373746156692505
acc_val: 0.8432
Epoch 60, training loss: 0.4778428375720978
acc_val: 0.8584
Epoch 70, training loss: 0.4452519416809082
acc_val: 0.8605
Epoch 80, training loss: 0.421108216047287
acc_val: 0.8650
Epoch 90, training loss: 0.39001524448394775
acc_val: 0.8681
Epoch 100, training loss: 0.3757559359073639
acc_val: 0.8666
Epoch 110, training loss: 0.36458995938301086
acc_val: 0.8711
Epoch 120, training loss: 0.3554459810256958
acc_val: 0.8732
Epoch 130, training loss: 0.3440536856651306
acc_val: 0.8701
Epoch 140, training loss: 0.3384770154953003
acc_val: 0.8721
Epoch 150, training loss: 0.3389893174171448
acc_val: 0.8747
Epoch 160, training loss: 0.3328551948070526
acc_val: 0.8747
Epoch 170, training loss: 0.31792694330215454
acc_val: 0.8782
Epoch 180, training loss: 0.31964319944381714
acc_val: 0.8747
Epoch 190, training loss: 0.32328030467033386
acc_val: 0.8721
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 9.5309s
Encoder CA on clean test nodes: 0.8554
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 7
./selected_nodes/Pubmed/Seperate/seed11/class_1.txt
[ 2622.  7012.  6767. ... 16214.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 8
./selected_nodes/Pubmed/Seperate/seed11/class_2.txt
[ 6834. 13199.   694. ...   580. 15548.  1205.]
idx_attach: tensor([ 2622,  7012,  6767,  6293,  8622, 11151, 12196,  6834, 13199,   694,
        11009, 10937,  9532, 17660, 11005], device='cuda:1')
Epoch 0, loss_inner: 1.09865, loss_target: 1.09243, homo loss: 0.48100 
acc_train_clean: 0.3467, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.95929, loss_target: 0.85183, homo loss: 0.23973 
acc_train_clean: 0.6564, ASR_train_attach: 1.0000, ASR_train_outter: 0.9810
Epoch 20, loss_inner: 0.83392, loss_target: 0.85025, homo loss: 0.22255 
acc_train_clean: 0.7991, ASR_train_attach: 0.0000, ASR_train_outter: 0.5066
Epoch 30, loss_inner: 0.69874, loss_target: 0.71061, homo loss: 0.25745 
acc_train_clean: 0.8179, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 0.59635, loss_target: 0.53667, homo loss: 0.08431 
acc_train_clean: 0.8372, ASR_train_attach: 1.0000, ASR_train_outter: 0.9924
Epoch 50, loss_inner: 0.52909, loss_target: 0.46316, homo loss: 0.07316 
acc_train_clean: 0.8463, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 60, loss_inner: 0.48766, loss_target: 0.42391, homo loss: 0.07139 
acc_train_clean: 0.8529, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 70, loss_inner: 0.46039, loss_target: 0.40106, homo loss: 0.06919 
acc_train_clean: 0.8600, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 80, loss_inner: 0.44012, loss_target: 0.38894, homo loss: 0.07597 
acc_train_clean: 0.8623, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 90, loss_inner: 0.42427, loss_target: 0.36983, homo loss: 0.07113 
acc_train_clean: 0.8661, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 100, loss_inner: 0.41151, loss_target: 0.35871, homo loss: 0.07060 
acc_train_clean: 0.8684, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 110, loss_inner: 0.40127, loss_target: 0.34950, homo loss: 0.06631 
acc_train_clean: 0.8714, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 120, loss_inner: 0.39306, loss_target: 0.35072, homo loss: 0.08524 
acc_train_clean: 0.8722, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 130, loss_inner: 0.38571, loss_target: 0.33846, homo loss: 0.07999 
acc_train_clean: 0.8750, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 140, loss_inner: 0.37945, loss_target: 0.33083, homo loss: 0.07732 
acc_train_clean: 0.8775, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 150, loss_inner: 0.37403, loss_target: 0.32611, homo loss: 0.07616 
acc_train_clean: 0.8788, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 160, loss_inner: 0.36932, loss_target: 0.32179, homo loss: 0.07564 
acc_train_clean: 0.8793, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 170, loss_inner: 0.36516, loss_target: 0.31801, homo loss: 0.07518 
acc_train_clean: 0.8808, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 180, loss_inner: 0.36143, loss_target: 0.31455, homo loss: 0.07476 
acc_train_clean: 0.8823, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 190, loss_inner: 0.35808, loss_target: 0.31140, homo loss: 0.07437 
acc_train_clean: 0.8841, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=921, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8534
Overall ASR: 0.9980
Flip ASR: 0.9974/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=703, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8529
Overall ASR: 0.9939
Flip ASR: 0.9923/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=80, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8488
Overall ASR: 0.9975
Flip ASR: 0.9968/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=91, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9990
Flip ASR: 0.9987/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=337, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.9985
Flip ASR: 0.9981/1554 nodes
Overall ASR: 0.9974 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8514
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=260, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8447
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=66, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8412
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=441, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8382
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=443, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8442
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=63, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8402
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Overall ASR: 1.0000 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8417
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=44, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8579
Overall ASR: 0.9138
Flip ASR: 0.8925/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=116, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8595
Overall ASR: 0.9163
Flip ASR: 0.8958/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=139, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8569
Overall ASR: 0.9087
Flip ASR: 0.8861/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=215, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8635
Overall ASR: 0.9097
Flip ASR: 0.8874/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=338, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8600
Overall ASR: 0.9108
Flip ASR: 0.8887/1554 nodes
Overall ASR: 0.9119 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8596
Total Overall ASR: 0.9697 
Total Clean Accuracy: 0.8509
