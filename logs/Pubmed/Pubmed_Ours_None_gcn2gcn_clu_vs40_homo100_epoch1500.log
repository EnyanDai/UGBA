nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:40
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.0969727039337158
acc_val: 0.4039
Epoch 10, training loss: 1.0288712978363037
acc_val: 0.6398
Epoch 20, training loss: 0.8768908977508545
acc_val: 0.6768
Epoch 30, training loss: 0.6742268204689026
acc_val: 0.7012
Epoch 40, training loss: 0.5647494196891785
acc_val: 0.8382
Epoch 50, training loss: 0.4839708209037781
acc_val: 0.8534
Epoch 60, training loss: 0.4659566879272461
acc_val: 0.8590
Epoch 70, training loss: 0.4117351174354553
acc_val: 0.8676
Epoch 80, training loss: 0.388569712638855
acc_val: 0.8676
Epoch 90, training loss: 0.376373827457428
acc_val: 0.8711
Epoch 100, training loss: 0.3615056872367859
acc_val: 0.8676
Epoch 110, training loss: 0.3480362296104431
acc_val: 0.8727
Epoch 120, training loss: 0.3445384204387665
acc_val: 0.8721
Epoch 130, training loss: 0.33609411120414734
acc_val: 0.8747
Epoch 140, training loss: 0.332760214805603
acc_val: 0.8732
Epoch 150, training loss: 0.327727735042572
acc_val: 0.8782
Epoch 160, training loss: 0.32861509919166565
acc_val: 0.8747
Epoch 170, training loss: 0.30818304419517517
acc_val: 0.8732
Epoch 180, training loss: 0.2986348569393158
acc_val: 0.8747
Epoch 190, training loss: 0.3012619912624359
acc_val: 0.8777
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 1.7448s
Encoder CA on clean test nodes: 0.8554
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_1.txt
[ 5104. 15916. 14578. ...  4058.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_2.txt
[11009.  2782. 11343. ...  8626. 15548.  1205.]
idx_attach: tensor([ 5104, 15916, 14578,  9040, 14315, 14910,  7647,  7098, 11534,  7803,
        10837, 18637, 19544,   821,  4899, 18597, 14851,  9145, 13907, 10814,
        11009,  2782, 11343, 14528, 19272,  6196, 16600, 17595, 17660,  9488,
         2471,  3489,  7324, 19307,  7825,   688,  2799,  6114,  4498, 13749],
       device='cuda:1')
tensor([    1,     2,     3,  ..., 19712, 19714, 19716], device='cuda:1')
Epoch 0, loss_inner: 1.09870, loss_target: 1.08898, homo loss: 0.48479 
acc_train_clean: 0.3190, ASR_train_attach: 0.9000, ASR_train_outter: 0.1268
Epoch 10, loss_inner: 0.97819, loss_target: 0.87177, homo loss: 0.19416 
acc_train_clean: 0.6635, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 20, loss_inner: 0.87688, loss_target: 0.86135, homo loss: 0.03482 
acc_train_clean: 0.7550, ASR_train_attach: 0.4500, ASR_train_outter: 0.6757
Epoch 30, loss_inner: 0.73688, loss_target: 0.68144, homo loss: 0.00007 
acc_train_clean: 0.8007, ASR_train_attach: 0.8750, ASR_train_outter: 0.8315
Epoch 40, loss_inner: 0.60793, loss_target: 0.55415, homo loss: 0.00001 
acc_train_clean: 0.8379, ASR_train_attach: 0.9000, ASR_train_outter: 0.9348
Epoch 50, loss_inner: 0.52666, loss_target: 0.48967, homo loss: 0.00000 
acc_train_clean: 0.8466, ASR_train_attach: 0.9000, ASR_train_outter: 0.9511
Epoch 60, loss_inner: 0.48266, loss_target: 0.45081, homo loss: 0.00000 
acc_train_clean: 0.8537, ASR_train_attach: 0.9000, ASR_train_outter: 0.9511
Epoch 70, loss_inner: 0.45623, loss_target: 0.42435, homo loss: 0.00000 
acc_train_clean: 0.8620, ASR_train_attach: 0.9000, ASR_train_outter: 0.9529
Epoch 80, loss_inner: 0.43740, loss_target: 0.41220, homo loss: 0.00000 
acc_train_clean: 0.8671, ASR_train_attach: 0.8500, ASR_train_outter: 0.9167
Epoch 90, loss_inner: 0.42024, loss_target: 0.39083, homo loss: 0.00003 
acc_train_clean: 0.8694, ASR_train_attach: 0.9000, ASR_train_outter: 0.9438
Epoch 100, loss_inner: 0.47375, loss_target: 0.91016, homo loss: 0.02527 
acc_train_clean: 0.8707, ASR_train_attach: 0.1000, ASR_train_outter: 0.3062
Epoch 110, loss_inner: 0.40915, loss_target: 0.42392, homo loss: 0.00000 
acc_train_clean: 0.8714, ASR_train_attach: 0.7750, ASR_train_outter: 0.8678
Epoch 120, loss_inner: 0.39313, loss_target: 0.38404, homo loss: 0.00001 
acc_train_clean: 0.8752, ASR_train_attach: 0.8750, ASR_train_outter: 0.9384
Epoch 130, loss_inner: 0.38345, loss_target: 0.36733, homo loss: 0.00000 
acc_train_clean: 0.8773, ASR_train_attach: 0.9000, ASR_train_outter: 0.9638
Epoch 140, loss_inner: 0.37751, loss_target: 0.35016, homo loss: 0.00000 
acc_train_clean: 0.8780, ASR_train_attach: 0.9750, ASR_train_outter: 0.9692
Epoch 150, loss_inner: 0.37118, loss_target: 0.34012, homo loss: 0.00000 
acc_train_clean: 0.8800, ASR_train_attach: 0.9750, ASR_train_outter: 0.9746
Epoch 160, loss_inner: 0.36563, loss_target: 0.33524, homo loss: 0.00002 
acc_train_clean: 0.8813, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 170, loss_inner: 0.36210, loss_target: 0.33098, homo loss: 0.00002 
acc_train_clean: 0.8838, ASR_train_attach: 0.9250, ASR_train_outter: 0.9692
Epoch 180, loss_inner: 0.35816, loss_target: 0.32725, homo loss: 0.00004 
acc_train_clean: 0.8854, ASR_train_attach: 0.9750, ASR_train_outter: 0.9801
Epoch 190, loss_inner: 0.35763, loss_target: 0.34583, homo loss: 0.00012 
acc_train_clean: 0.8851, ASR_train_attach: 0.8500, ASR_train_outter: 0.8949
Epoch 200, loss_inner: 0.35281, loss_target: 0.32438, homo loss: 0.00001 
acc_train_clean: 0.8849, ASR_train_attach: 0.9000, ASR_train_outter: 0.9601
Epoch 210, loss_inner: 0.34954, loss_target: 0.32042, homo loss: 0.00001 
acc_train_clean: 0.8849, ASR_train_attach: 0.9750, ASR_train_outter: 0.9728
Epoch 220, loss_inner: 0.44971, loss_target: 0.99169, homo loss: 0.00001 
acc_train_clean: 0.8874, ASR_train_attach: 0.0000, ASR_train_outter: 0.1957
Epoch 230, loss_inner: 0.37180, loss_target: 0.44273, homo loss: 0.00000 
acc_train_clean: 0.8813, ASR_train_attach: 0.6500, ASR_train_outter: 0.7663
Epoch 240, loss_inner: 0.35207, loss_target: 0.34548, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 1.0000, ASR_train_outter: 0.9565
Epoch 250, loss_inner: 0.34394, loss_target: 0.32733, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 0.8750, ASR_train_outter: 0.9420
Epoch 260, loss_inner: 0.34205, loss_target: 0.31940, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 0.8750, ASR_train_outter: 0.9674
Epoch 270, loss_inner: 0.33972, loss_target: 0.31151, homo loss: 0.00000 
acc_train_clean: 0.8876, ASR_train_attach: 0.9750, ASR_train_outter: 0.9891
Epoch 280, loss_inner: 0.33587, loss_target: 0.30877, homo loss: 0.00000 
acc_train_clean: 0.8879, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 290, loss_inner: 0.33436, loss_target: 0.30512, homo loss: 0.00000 
acc_train_clean: 0.8884, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 300, loss_inner: 0.33368, loss_target: 0.30442, homo loss: 0.00000 
acc_train_clean: 0.8884, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 310, loss_inner: 0.33260, loss_target: 0.30332, homo loss: 0.00000 
acc_train_clean: 0.8889, ASR_train_attach: 0.9250, ASR_train_outter: 0.9855
Epoch 320, loss_inner: 0.33104, loss_target: 0.30337, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 330, loss_inner: 0.33542, loss_target: 0.33882, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 0.7000, ASR_train_outter: 0.8080
Epoch 340, loss_inner: 0.33313, loss_target: 0.31109, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
Epoch 350, loss_inner: 0.33410, loss_target: 0.31987, homo loss: 0.00292 
acc_train_clean: 0.8856, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 360, loss_inner: 0.32892, loss_target: 0.31377, homo loss: 0.00001 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9746
Epoch 370, loss_inner: 0.32739, loss_target: 0.30571, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 380, loss_inner: 0.32644, loss_target: 0.29837, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 390, loss_inner: 0.32487, loss_target: 0.29563, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 400, loss_inner: 0.32413, loss_target: 0.29440, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 410, loss_inner: 0.32352, loss_target: 0.29346, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 420, loss_inner: 0.32291, loss_target: 0.29303, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 430, loss_inner: 0.32224, loss_target: 0.29352, homo loss: 0.00003 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 440, loss_inner: 0.32627, loss_target: 0.37187, homo loss: 0.01259 
acc_train_clean: 0.8889, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 450, loss_inner: 0.35165, loss_target: 0.37313, homo loss: 0.00469 
acc_train_clean: 0.8874, ASR_train_attach: 0.7750, ASR_train_outter: 0.8188
Epoch 460, loss_inner: 0.33738, loss_target: 0.34102, homo loss: 0.00000 
acc_train_clean: 0.8876, ASR_train_attach: 0.9000, ASR_train_outter: 0.9438
Epoch 470, loss_inner: 0.32722, loss_target: 0.31497, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 0.9750, ASR_train_outter: 0.9547
Epoch 480, loss_inner: 0.32475, loss_target: 0.30475, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
Epoch 490, loss_inner: 0.32322, loss_target: 0.30161, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 500, loss_inner: 0.32165, loss_target: 0.29531, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 0.9750, ASR_train_outter: 0.9837
Epoch 510, loss_inner: 0.31999, loss_target: 0.29149, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 520, loss_inner: 0.31930, loss_target: 0.29950, homo loss: 0.00002 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 530, loss_inner: 0.32179, loss_target: 0.31777, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 0.9529
Epoch 540, loss_inner: 0.31965, loss_target: 0.29392, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 0.9250, ASR_train_outter: 0.9710
Epoch 550, loss_inner: 0.31800, loss_target: 0.28885, homo loss: 0.00001 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 560, loss_inner: 0.31755, loss_target: 0.29053, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 570, loss_inner: 0.31873, loss_target: 0.29473, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 0.9250, ASR_train_outter: 0.9511
Epoch 580, loss_inner: 0.32072, loss_target: 0.31671, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 590, loss_inner: 0.32442, loss_target: 0.30426, homo loss: 0.00001 
acc_train_clean: 0.8930, ASR_train_attach: 0.9500, ASR_train_outter: 0.9692
Epoch 600, loss_inner: 0.31869, loss_target: 0.29680, homo loss: 0.00001 
acc_train_clean: 0.8920, ASR_train_attach: 0.9750, ASR_train_outter: 0.9511
Epoch 610, loss_inner: 0.31635, loss_target: 0.28972, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 620, loss_inner: 0.31621, loss_target: 0.28709, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 630, loss_inner: 0.31601, loss_target: 0.28667, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 640, loss_inner: 0.31554, loss_target: 0.28533, homo loss: 0.00003 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 650, loss_inner: 0.31522, loss_target: 0.28676, homo loss: 0.00010 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 660, loss_inner: 0.32475, loss_target: 0.31788, homo loss: 0.02284 
acc_train_clean: 0.8876, ASR_train_attach: 0.9250, ASR_train_outter: 0.9783
Epoch 670, loss_inner: 0.33268, loss_target: 0.33691, homo loss: 0.00042 
acc_train_clean: 0.8889, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 680, loss_inner: 0.32275, loss_target: 0.32395, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 0.9250, ASR_train_outter: 0.9185
Epoch 690, loss_inner: 0.31731, loss_target: 0.30344, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9750, ASR_train_outter: 0.9728
Epoch 700, loss_inner: 0.31780, loss_target: 0.29607, homo loss: 0.00001 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9746
Epoch 710, loss_inner: 0.31646, loss_target: 0.29076, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 720, loss_inner: 0.31505, loss_target: 0.29105, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 730, loss_inner: 0.31490, loss_target: 0.28802, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 740, loss_inner: 0.31427, loss_target: 0.28635, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 750, loss_inner: 0.31386, loss_target: 0.28833, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 760, loss_inner: 0.31422, loss_target: 0.28712, homo loss: 0.00008 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 770, loss_inner: 0.31400, loss_target: 0.28525, homo loss: 0.00016 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 780, loss_inner: 0.31413, loss_target: 0.28706, homo loss: 0.00002 
acc_train_clean: 0.8945, ASR_train_attach: 0.9500, ASR_train_outter: 0.9837
Epoch 790, loss_inner: 0.31343, loss_target: 0.28454, homo loss: 0.00004 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 800, loss_inner: 0.38031, loss_target: 0.34582, homo loss: 0.03136 
acc_train_clean: 0.8940, ASR_train_attach: 0.1750, ASR_train_outter: 0.8442
Epoch 810, loss_inner: 0.34100, loss_target: 0.33870, homo loss: 0.00000 
acc_train_clean: 0.8889, ASR_train_attach: 0.9750, ASR_train_outter: 0.9710
Epoch 820, loss_inner: 0.32674, loss_target: 0.32079, homo loss: 0.00000 
acc_train_clean: 0.8879, ASR_train_attach: 0.9500, ASR_train_outter: 0.9275
Epoch 830, loss_inner: 0.31726, loss_target: 0.29724, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9746
Epoch 840, loss_inner: 0.31625, loss_target: 0.28958, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 850, loss_inner: 0.31548, loss_target: 0.29064, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 860, loss_inner: 0.31438, loss_target: 0.28855, homo loss: 0.00001 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 870, loss_inner: 0.31387, loss_target: 0.28448, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 880, loss_inner: 0.31357, loss_target: 0.28594, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 890, loss_inner: 0.31378, loss_target: 0.29164, homo loss: 0.00002 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 900, loss_inner: 0.31361, loss_target: 0.28589, homo loss: 0.00004 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 910, loss_inner: 0.31331, loss_target: 0.28371, homo loss: 0.00003 
acc_train_clean: 0.8950, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 920, loss_inner: 0.31458, loss_target: 0.29867, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.8250, ASR_train_outter: 0.9130
Epoch 930, loss_inner: 0.31948, loss_target: 0.30159, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.8000, ASR_train_outter: 0.9221
Epoch 940, loss_inner: 0.32865, loss_target: 0.31302, homo loss: 0.00000 
acc_train_clean: 0.8887, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 950, loss_inner: 0.31854, loss_target: 0.29846, homo loss: 0.00001 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 960, loss_inner: 0.31486, loss_target: 0.29229, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 970, loss_inner: 0.31475, loss_target: 0.28863, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9500, ASR_train_outter: 0.9728
Epoch 980, loss_inner: 0.31393, loss_target: 0.28519, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 990, loss_inner: 0.31342, loss_target: 0.28349, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8539
Overall ASR: 0.9452
Flip ASR: 0.9311/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8498
Overall ASR: 0.9011
Flip ASR: 0.8777/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9336
Flip ASR: 0.9176/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.9417
Flip ASR: 0.9279/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.9173
Flip ASR: 0.8983/1554 nodes
Overall ASR: 0.9278 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8513
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8397
Overall ASR: 0.8818
Flip ASR: 0.8520/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8250
accuracy on clean test nodes: 0.8371
Overall ASR: 0.7860
Flip ASR: 0.7329/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8750
accuracy on clean test nodes: 0.8397
Overall ASR: 0.8225
Flip ASR: 0.7780/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8402
Overall ASR: 0.8656
Flip ASR: 0.8320/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8417
Overall ASR: 0.9047
Flip ASR: 0.8803/1554 nodes
Overall ASR: 0.8521 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8397
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8590
Overall ASR: 0.8960
Flip ASR: 0.8713/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9250
accuracy on clean test nodes: 0.8579
Overall ASR: 0.8935
Flip ASR: 0.8681/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8590
Overall ASR: 0.8910
Flip ASR: 0.8655/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8610
Overall ASR: 0.8849
Flip ASR: 0.8584/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9250
accuracy on clean test nodes: 0.8635
Overall ASR: 0.8981
Flip ASR: 0.8752/1554 nodes
Overall ASR: 0.8927 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8601
Total Overall ASR: 0.8909 
Total Clean Accuracy: 0.8504
