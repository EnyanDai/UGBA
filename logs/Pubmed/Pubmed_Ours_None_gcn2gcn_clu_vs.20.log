nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 10.7507s
Benign CA: 0.8554
#Attach Nodes:20
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.1248021125793457
acc_val: 0.2035
Epoch 10, training loss: 1.035003423690796
acc_val: 0.4033
Epoch 20, training loss: 0.927193284034729
acc_val: 0.4485
Epoch 30, training loss: 0.7763608694076538
acc_val: 0.6799
Epoch 40, training loss: 0.6315062642097473
acc_val: 0.8234
Epoch 50, training loss: 0.5373746752738953
acc_val: 0.8432
Epoch 60, training loss: 0.4778428375720978
acc_val: 0.8584
Epoch 70, training loss: 0.44524946808815
acc_val: 0.8605
Epoch 80, training loss: 0.42119720578193665
acc_val: 0.8650
Epoch 90, training loss: 0.39013704657554626
acc_val: 0.8681
Epoch 100, training loss: 0.3752492070198059
acc_val: 0.8645
Epoch 110, training loss: 0.3645612895488739
acc_val: 0.8706
Epoch 120, training loss: 0.3556129038333893
acc_val: 0.8737
Epoch 130, training loss: 0.343610018491745
acc_val: 0.8701
Epoch 140, training loss: 0.3386012315750122
acc_val: 0.8737
Epoch 150, training loss: 0.338798850774765
acc_val: 0.8747
Epoch 160, training loss: 0.3325311839580536
acc_val: 0.8757
Epoch 170, training loss: 0.3179634213447571
acc_val: 0.8772
Epoch 180, training loss: 0.3197590708732605
acc_val: 0.8752
Epoch 190, training loss: 0.3232661187648773
acc_val: 0.8721
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 9.5462s
Encoder CA on clean test nodes: 0.8539
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 10
./selected_nodes/Pubmed/Seperate/seed11/class_1.txt
[ 2622.  7012.  6767. ... 16214.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 10
./selected_nodes/Pubmed/Seperate/seed11/class_2.txt
[ 6834. 13199.   694. ...   580. 15548.  1205.]
idx_attach: tensor([ 2622,  7012,  6767,  6293,  8622, 11151, 12196,  1176, 14578, 19257,
         6834, 13199,   694, 11009, 10937,  9532, 17660, 11005,  7654,   688],
       device='cuda:1')
Epoch 0, loss_inner: 1.09867, loss_target: 1.09235, homo loss: 0.48316 
acc_train_clean: 0.3467, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.95869, loss_target: 0.85179, homo loss: 0.24212 
acc_train_clean: 0.6576, ASR_train_attach: 1.0000, ASR_train_outter: 0.9831
Epoch 20, loss_inner: 0.83098, loss_target: 0.73621, homo loss: 0.22571 
acc_train_clean: 0.8083, ASR_train_attach: 0.3500, ASR_train_outter: 0.9812
Epoch 30, loss_inner: 0.72791, loss_target: 0.91413, homo loss: 0.27903 
acc_train_clean: 0.8027, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 0.61328, loss_target: 0.53386, homo loss: 0.08118 
acc_train_clean: 0.8382, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 50, loss_inner: 0.53926, loss_target: 0.47006, homo loss: 0.07438 
acc_train_clean: 0.8473, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 60, loss_inner: 0.49203, loss_target: 0.42747, homo loss: 0.07282 
acc_train_clean: 0.8511, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 70, loss_inner: 0.46256, loss_target: 0.40234, homo loss: 0.07204 
acc_train_clean: 0.8585, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 80, loss_inner: 0.44204, loss_target: 0.38832, homo loss: 0.07229 
acc_train_clean: 0.8636, ASR_train_attach: 1.0000, ASR_train_outter: 0.9887
Epoch 90, loss_inner: 0.42583, loss_target: 0.37026, homo loss: 0.06961 
acc_train_clean: 0.8651, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 100, loss_inner: 0.41282, loss_target: 0.35881, homo loss: 0.06223 
acc_train_clean: 0.8684, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 110, loss_inner: 0.40230, loss_target: 0.35061, homo loss: 0.06199 
acc_train_clean: 0.8712, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 120, loss_inner: 0.39356, loss_target: 0.34900, homo loss: 0.07180 
acc_train_clean: 0.8724, ASR_train_attach: 1.0000, ASR_train_outter: 0.9812
Epoch 130, loss_inner: 0.38589, loss_target: 0.33564, homo loss: 0.06834 
acc_train_clean: 0.8740, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 140, loss_inner: 0.37948, loss_target: 0.32990, homo loss: 0.06650 
acc_train_clean: 0.8770, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 150, loss_inner: 0.37399, loss_target: 0.33148, homo loss: 0.07752 
acc_train_clean: 0.8780, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 160, loss_inner: 0.36902, loss_target: 0.32256, homo loss: 0.07404 
acc_train_clean: 0.8790, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 170, loss_inner: 0.36454, loss_target: 0.31737, homo loss: 0.07343 
acc_train_clean: 0.8805, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 180, loss_inner: 0.36063, loss_target: 0.31415, homo loss: 0.07283 
acc_train_clean: 0.8821, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 190, loss_inner: 0.35707, loss_target: 0.31048, homo loss: 0.07132 
acc_train_clean: 0.8844, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=921, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8478
Overall ASR: 0.9980
Flip ASR: 0.9974/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=703, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8519
Overall ASR: 0.9949
Flip ASR: 0.9936/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=80, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8493
Overall ASR: 0.9980
Flip ASR: 0.9974/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=91, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8503
Overall ASR: 0.9995
Flip ASR: 0.9994/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=337, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8498
Overall ASR: 0.9985
Flip ASR: 0.9981/1554 nodes
Overall ASR: 0.9978 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8498
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=260, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8402
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=66, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8397
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=441, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8397
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=443, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8412
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=63, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8412
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Overall ASR: 1.0000 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8404
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=44, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8620
Overall ASR: 0.8758
Flip ASR: 0.8443/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=116, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8500
accuracy on clean test nodes: 0.8605
Overall ASR: 0.8707
Flip ASR: 0.8378/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=139, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8630
Overall ASR: 0.8742
Flip ASR: 0.8423/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=215, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8500
accuracy on clean test nodes: 0.8564
Overall ASR: 0.8778
Flip ASR: 0.8468/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=338, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8595
Overall ASR: 0.8742
Flip ASR: 0.8423/1554 nodes
Overall ASR: 0.8745 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8603
Total Overall ASR: 0.9574 
Total Clean Accuracy: 0.8502
