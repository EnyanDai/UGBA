nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 9.9954s
Benign CA: 0.8554
#Attach Nodes:15
idx_attach: tensor([15043, 11176, 18495, 13856,  7735, 17027, 16900, 10353, 15081,  4018,
         4065, 17271,  1025,  9514,  7970], device='cuda:1')
Epoch 0, loss_inner: 1.09889, loss_target: 1.09238, homo loss: 0.49577 
acc_train_clean: 0.3226, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.96898, loss_target: 0.88994, homo loss: 0.22120 
acc_train_clean: 0.6548, ASR_train_attach: 0.9333, ASR_train_outter: 0.8918
Epoch 20, loss_inner: 0.83300, loss_target: 0.75521, homo loss: 0.14301 
acc_train_clean: 0.7210, ASR_train_attach: 1.0000, ASR_train_outter: 0.9013
Epoch 30, loss_inner: 0.69257, loss_target: 0.64662, homo loss: 0.07241 
acc_train_clean: 0.8199, ASR_train_attach: 0.8667, ASR_train_outter: 0.8539
Epoch 40, loss_inner: 0.58585, loss_target: 0.53428, homo loss: 0.05681 
acc_train_clean: 0.8402, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 50, loss_inner: 0.52152, loss_target: 0.50530, homo loss: 0.02113 
acc_train_clean: 0.8476, ASR_train_attach: 0.8667, ASR_train_outter: 0.8634
Epoch 60, loss_inner: 0.48206, loss_target: 0.45302, homo loss: 0.01508 
acc_train_clean: 0.8572, ASR_train_attach: 1.0000, ASR_train_outter: 0.9450
Epoch 70, loss_inner: 0.45743, loss_target: 0.45419, homo loss: 0.10052 
acc_train_clean: 0.8625, ASR_train_attach: 1.0000, ASR_train_outter: 0.9545
Epoch 80, loss_inner: 0.43775, loss_target: 0.42302, homo loss: 0.03671 
acc_train_clean: 0.8643, ASR_train_attach: 1.0000, ASR_train_outter: 0.9734
Epoch 90, loss_inner: 0.42152, loss_target: 0.40384, homo loss: 0.01917 
acc_train_clean: 0.8669, ASR_train_attach: 1.0000, ASR_train_outter: 0.9715
Epoch 100, loss_inner: 0.41047, loss_target: 0.40529, homo loss: 0.06943 
acc_train_clean: 0.8699, ASR_train_attach: 1.0000, ASR_train_outter: 0.9602
Epoch 110, loss_inner: 0.39993, loss_target: 0.40238, homo loss: 0.00307 
acc_train_clean: 0.8719, ASR_train_attach: 1.0000, ASR_train_outter: 0.8691
Epoch 120, loss_inner: 0.39139, loss_target: 0.38436, homo loss: 0.00078 
acc_train_clean: 0.8740, ASR_train_attach: 0.8667, ASR_train_outter: 0.8918
Epoch 130, loss_inner: 0.39531, loss_target: 0.55688, homo loss: 0.26557 
acc_train_clean: 0.8747, ASR_train_attach: 0.7333, ASR_train_outter: 0.9981
Epoch 140, loss_inner: 0.38407, loss_target: 0.37153, homo loss: 0.15238 
acc_train_clean: 0.8770, ASR_train_attach: 1.0000, ASR_train_outter: 0.9336
Epoch 150, loss_inner: 0.37429, loss_target: 0.36478, homo loss: 0.04998 
acc_train_clean: 0.8780, ASR_train_attach: 1.0000, ASR_train_outter: 0.9298
Epoch 160, loss_inner: 0.36952, loss_target: 0.35857, homo loss: 0.02447 
acc_train_clean: 0.8783, ASR_train_attach: 1.0000, ASR_train_outter: 0.9507
Epoch 170, loss_inner: 0.36559, loss_target: 0.35010, homo loss: 0.00707 
acc_train_clean: 0.8816, ASR_train_attach: 1.0000, ASR_train_outter: 0.9526
Epoch 180, loss_inner: 0.36996, loss_target: 0.47924, homo loss: 0.25560 
acc_train_clean: 0.8785, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 190, loss_inner: 0.36544, loss_target: 0.38183, homo loss: 0.21178 
acc_train_clean: 0.8818, ASR_train_attach: 1.0000, ASR_train_outter: 0.9677
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=921, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8473
Overall ASR: 0.9173
Flip ASR: 0.8970/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=703, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.8955
Flip ASR: 0.8694/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=80, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8478
Overall ASR: 0.9092
Flip ASR: 0.8874/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=91, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9544
Flip ASR: 0.9434/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=337, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8473
Overall ASR: 0.9168
Flip ASR: 0.8958/1554 nodes
Overall ASR: 0.9187 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8489
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=260, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8417
Overall ASR: 0.8316
Flip ASR: 0.7896/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=66, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8371
Overall ASR: 0.8357
Flip ASR: 0.7954/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=441, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8366
Overall ASR: 0.8671
Flip ASR: 0.8327/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=443, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8422
Overall ASR: 0.8220
Flip ASR: 0.7806/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=63, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8382
Overall ASR: 0.8519
Flip ASR: 0.8147/1554 nodes
Overall ASR: 0.8417 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8392
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=44, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8595
Overall ASR: 0.8768
Flip ASR: 0.8456/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=116, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9333
accuracy on clean test nodes: 0.8590
Overall ASR: 0.8671
Flip ASR: 0.8340/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=139, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8605
Overall ASR: 0.8849
Flip ASR: 0.8559/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=215, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8559
Overall ASR: 0.8803
Flip ASR: 0.8501/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=338, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8600
Overall ASR: 0.8763
Flip ASR: 0.8456/1554 nodes
Overall ASR: 0.8771 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8590
Total Overall ASR: 0.8791 
Total Clean Accuracy: 0.8490
