nohup: ignoring input
Namespace(attack_method='Basic', cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 4.0904s
Benign CA: 0.8671
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.1220154762268066
acc_val: 0.1974
Epoch 10, training loss: 1.0398703813552856
acc_val: 0.5606
Epoch 20, training loss: 0.9258168935775757
acc_val: 0.5596
Epoch 30, training loss: 0.795841634273529
acc_val: 0.7007
Epoch 40, training loss: 0.6482744216918945
acc_val: 0.8255
Epoch 50, training loss: 0.5425563454627991
acc_val: 0.8534
Epoch 60, training loss: 0.48921623826026917
acc_val: 0.8661
Epoch 70, training loss: 0.44817936420440674
acc_val: 0.8650
Epoch 80, training loss: 0.40878695249557495
acc_val: 0.8620
Epoch 90, training loss: 0.40282005071640015
acc_val: 0.8661
Epoch 100, training loss: 0.37698647379875183
acc_val: 0.8645
Epoch 110, training loss: 0.3746463656425476
acc_val: 0.8666
Epoch 120, training loss: 0.3626612722873688
acc_val: 0.8661
Epoch 130, training loss: 0.36065688729286194
acc_val: 0.8635
Epoch 140, training loss: 0.347991019487381
acc_val: 0.8661
Epoch 150, training loss: 0.33925530314445496
acc_val: 0.8686
Epoch 160, training loss: 0.33395645022392273
acc_val: 0.8605
Epoch 170, training loss: 0.3373708724975586
acc_val: 0.8666
Epoch 180, training loss: 0.32327643036842346
acc_val: 0.8645
Epoch 190, training loss: 0.3234010338783264
acc_val: 0.8640
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 2.0086s
Encoder CA on clean test nodes: 0.8828
running k-means on cuda:2..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:00, ?it/s, center_shift=1.031928, iteration=1, tol=0.000100][running kmeans]: 1it [00:00,  3.13it/s, center_shift=0.370225, iteration=2, tol=0.000100][running kmeans]: 2it [00:00,  6.24it/s, center_shift=0.370225, iteration=2, tol=0.000100][running kmeans]: 2it [00:00,  6.24it/s, center_shift=0.058309, iteration=3, tol=0.000100][running kmeans]: 3it [00:00,  4.69it/s, center_shift=0.058309, iteration=3, tol=0.000100][running kmeans]: 3it [00:00,  4.69it/s, center_shift=0.008004, iteration=4, tol=0.000100][running kmeans]: 4it [00:00,  4.02it/s, center_shift=0.008004, iteration=4, tol=0.000100][running kmeans]: 4it [00:01,  4.02it/s, center_shift=0.001647, iteration=5, tol=0.000100][running kmeans]: 5it [00:01,  4.35it/s, center_shift=0.001647, iteration=5, tol=0.000100][running kmeans]: 5it [00:01,  4.35it/s, center_shift=0.000398, iteration=6, tol=0.000100][running kmeans]: 6it [00:01,  4.43it/s, center_shift=0.000398, iteration=6, tol=0.000100][running kmeans]: 6it [00:01,  4.43it/s, center_shift=0.000140, iteration=7, tol=0.000100][running kmeans]: 7it [00:01,  5.16it/s, center_shift=0.000140, iteration=7, tol=0.000100][running kmeans]: 7it [00:01,  5.16it/s, center_shift=0.000052, iteration=8, tol=0.000100][running kmeans]: 8it [00:01,  5.48it/s, center_shift=0.000052, iteration=8, tol=0.000100]
[1 1 0 ... 2 0 2]
[1.46229    2.6694345  0.2713576  ... 1.5221521  0.23695397 1.6780208 ] [    0     7     9 ... 19693 19700 19702]
[1.46229    2.6694345  0.2713576  ... 1.5221521  0.23695397 1.6780208 ] [16388  8197     5 ... 16376 16377 16383]
idx_attach: tensor([ 2913, 16476,  5980,  8630, 18360,  7323, 12672, 12788, 13148, 16555,
        15638, 13078,  3323, 18168, 11975], device='cuda:2')
Epoch 0, loss_inner: 1.09890, loss_target: 1.09201, homo loss: 0.00000 
acc_train_clean: 0.3442, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.95899, loss_target: 0.85039, homo loss: 0.00000 
acc_train_clean: 0.6312, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 20, loss_inner: 0.81192, loss_target: 0.72148, homo loss: 0.00000 
acc_train_clean: 0.7908, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 30, loss_inner: 0.67805, loss_target: 0.79610, homo loss: 0.00000 
acc_train_clean: 0.8144, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 40, loss_inner: 0.58330, loss_target: 0.53073, homo loss: 0.00000 
acc_train_clean: 0.8303, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 50, loss_inner: 0.52257, loss_target: 0.47279, homo loss: 0.00000 
acc_train_clean: 0.8435, ASR_train_attach: 1.0000, ASR_train_outter: 0.9753
Epoch 60, loss_inner: 0.48268, loss_target: 0.43655, homo loss: 0.00000 
acc_train_clean: 0.8524, ASR_train_attach: 1.0000, ASR_train_outter: 0.9905
Epoch 70, loss_inner: 0.45469, loss_target: 0.41058, homo loss: 0.00000 
acc_train_clean: 0.8592, ASR_train_attach: 1.0000, ASR_train_outter: 0.9810
Epoch 80, loss_inner: 0.43391, loss_target: 0.39388, homo loss: 0.00000 
acc_train_clean: 0.8651, ASR_train_attach: 1.0000, ASR_train_outter: 0.9715
Epoch 90, loss_inner: 0.41800, loss_target: 0.37889, homo loss: 0.00000 
acc_train_clean: 0.8696, ASR_train_attach: 1.0000, ASR_train_outter: 0.9867
Epoch 100, loss_inner: 0.40544, loss_target: 0.44738, homo loss: 0.00000 
acc_train_clean: 0.8717, ASR_train_attach: 1.0000, ASR_train_outter: 0.9412
Epoch 110, loss_inner: 0.39538, loss_target: 0.37329, homo loss: 0.00000 
acc_train_clean: 0.8747, ASR_train_attach: 1.0000, ASR_train_outter: 0.9431
Epoch 120, loss_inner: 0.38702, loss_target: 0.35450, homo loss: 0.00000 
acc_train_clean: 0.8775, ASR_train_attach: 1.0000, ASR_train_outter: 0.9829
Epoch 130, loss_inner: 0.37998, loss_target: 0.34584, homo loss: 0.00000 
acc_train_clean: 0.8793, ASR_train_attach: 1.0000, ASR_train_outter: 0.9753
Epoch 140, loss_inner: 0.37415, loss_target: 0.35171, homo loss: 0.00000 
acc_train_clean: 0.8790, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 150, loss_inner: 0.36875, loss_target: 0.41178, homo loss: 0.00000 
acc_train_clean: 0.8828, ASR_train_attach: 1.0000, ASR_train_outter: 0.9810
Epoch 160, loss_inner: 0.36435, loss_target: 0.34030, homo loss: 0.00000 
acc_train_clean: 0.8831, ASR_train_attach: 1.0000, ASR_train_outter: 0.9810
Epoch 170, loss_inner: 0.36024, loss_target: 0.33164, homo loss: 0.00000 
acc_train_clean: 0.8844, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 180, loss_inner: 0.35667, loss_target: 0.32423, homo loss: 0.00000 
acc_train_clean: 0.8849, ASR_train_attach: 1.0000, ASR_train_outter: 0.9791
Epoch 190, loss_inner: 0.35344, loss_target: 0.33413, homo loss: 0.00000 
acc_train_clean: 0.8851, ASR_train_attach: 1.0000, ASR_train_outter: 0.9165
precent of left attach nodes: 1.000
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8671
ASR: 0.9447
Flip ASR: 0.9305/1554 nodes
CA: 0.8468
