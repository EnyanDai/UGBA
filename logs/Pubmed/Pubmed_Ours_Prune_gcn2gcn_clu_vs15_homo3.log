nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 2.5326s
Benign CA: 0.8554
#Attach Nodes:15
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.1248021125793457
acc_val: 0.2035
Epoch 10, training loss: 1.035003423690796
acc_val: 0.4033
Epoch 20, training loss: 0.9271933436393738
acc_val: 0.4485
Epoch 30, training loss: 0.7763608694076538
acc_val: 0.6799
Epoch 40, training loss: 0.6315062642097473
acc_val: 0.8234
Epoch 50, training loss: 0.5373746156692505
acc_val: 0.8432
Epoch 60, training loss: 0.4778428375720978
acc_val: 0.8584
Epoch 70, training loss: 0.4452494978904724
acc_val: 0.8605
Epoch 80, training loss: 0.42119720578193665
acc_val: 0.8650
Epoch 90, training loss: 0.39013707637786865
acc_val: 0.8681
Epoch 100, training loss: 0.3752492666244507
acc_val: 0.8645
Epoch 110, training loss: 0.3645612895488739
acc_val: 0.8706
Epoch 120, training loss: 0.35561615228652954
acc_val: 0.8737
Epoch 130, training loss: 0.343599796295166
acc_val: 0.8701
Epoch 140, training loss: 0.3385893702507019
acc_val: 0.8727
Epoch 150, training loss: 0.33884504437446594
acc_val: 0.8747
Epoch 160, training loss: 0.3325924277305603
acc_val: 0.8747
Epoch 170, training loss: 0.3178776800632477
acc_val: 0.8782
Epoch 180, training loss: 0.31976518034935
acc_val: 0.8757
Epoch 190, training loss: 0.3227226138114929
acc_val: 0.8721
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 2.1628s
Encoder CA on clean test nodes: 0.8579
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 7
./selected_nodes/Pubmed/Seperate/seed11/class_1.txt
[ 2622.  7012.  6767. ... 16214.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 8
./selected_nodes/Pubmed/Seperate/seed11/class_2.txt
[ 6834. 13199.   694. ...   580. 15548.  1205.]
idx_attach: tensor([ 2622,  7012,  6767,  6293,  8622, 11151, 12196,  6834, 13199,   694,
        11009, 10937,  9532, 17660, 11005], device='cuda:1')
Epoch 0, loss_inner: 1.09865, loss_target: 1.09243, homo loss: 0.48100 
acc_train_clean: 0.3467, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.96047, loss_target: 0.85973, homo loss: 0.21870 
acc_train_clean: 0.6576, ASR_train_attach: 0.8667, ASR_train_outter: 0.9602
Epoch 20, loss_inner: 0.81987, loss_target: 0.72998, homo loss: 0.15093 
acc_train_clean: 0.7963, ASR_train_attach: 0.8667, ASR_train_outter: 0.9450
Epoch 30, loss_inner: 0.68264, loss_target: 0.61061, homo loss: 0.11034 
acc_train_clean: 0.8291, ASR_train_attach: 1.0000, ASR_train_outter: 0.9829
Epoch 40, loss_inner: 0.58499, loss_target: 0.54275, homo loss: 0.02817 
acc_train_clean: 0.8400, ASR_train_attach: 0.8667, ASR_train_outter: 0.9051
Epoch 50, loss_inner: 0.54050, loss_target: 0.86487, homo loss: 0.02493 
acc_train_clean: 0.8478, ASR_train_attach: 0.0000, ASR_train_outter: 0.1195
Epoch 60, loss_inner: 0.48670, loss_target: 0.46065, homo loss: 0.06891 
acc_train_clean: 0.8529, ASR_train_attach: 0.8667, ASR_train_outter: 0.9070
Epoch 70, loss_inner: 0.45815, loss_target: 0.42967, homo loss: 0.00708 
acc_train_clean: 0.8603, ASR_train_attach: 0.9333, ASR_train_outter: 0.9222
Epoch 80, loss_inner: 0.43771, loss_target: 0.40638, homo loss: 0.00134 
acc_train_clean: 0.8646, ASR_train_attach: 0.9333, ASR_train_outter: 0.9355
Epoch 90, loss_inner: 0.43693, loss_target: 0.67851, homo loss: 0.00880 
acc_train_clean: 0.8674, ASR_train_attach: 0.0000, ASR_train_outter: 0.2694
Epoch 100, loss_inner: 0.41689, loss_target: 0.41553, homo loss: 0.12569 
acc_train_clean: 0.8694, ASR_train_attach: 0.3333, ASR_train_outter: 0.8254
Epoch 110, loss_inner: 0.40309, loss_target: 0.39521, homo loss: 0.00713 
acc_train_clean: 0.8727, ASR_train_attach: 0.8667, ASR_train_outter: 0.8786
Epoch 120, loss_inner: 0.39119, loss_target: 0.36358, homo loss: 0.00087 
acc_train_clean: 0.8724, ASR_train_attach: 1.0000, ASR_train_outter: 0.9488
Epoch 130, loss_inner: 0.38417, loss_target: 0.35536, homo loss: 0.00230 
acc_train_clean: 0.8762, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 140, loss_inner: 0.38203, loss_target: 0.51422, homo loss: 0.30280 
acc_train_clean: 0.8785, ASR_train_attach: 1.0000, ASR_train_outter: 0.9943
Epoch 150, loss_inner: 0.40070, loss_target: 0.55442, homo loss: 0.16419 
acc_train_clean: 0.8780, ASR_train_attach: 0.1333, ASR_train_outter: 0.5731
Epoch 160, loss_inner: 0.37302, loss_target: 0.40349, homo loss: 0.05900 
acc_train_clean: 0.8793, ASR_train_attach: 0.8667, ASR_train_outter: 0.8235
Epoch 170, loss_inner: 0.36495, loss_target: 0.34426, homo loss: 0.02000 
acc_train_clean: 0.8808, ASR_train_attach: 1.0000, ASR_train_outter: 0.9450
Epoch 180, loss_inner: 0.36115, loss_target: 0.33593, homo loss: 0.00214 
acc_train_clean: 0.8836, ASR_train_attach: 1.0000, ASR_train_outter: 0.9488
Epoch 190, loss_inner: 0.35830, loss_target: 0.33318, homo loss: 0.00019 
acc_train_clean: 0.8846, ASR_train_attach: 1.0000, ASR_train_outter: 0.9469
Epoch 200, loss_inner: 0.35532, loss_target: 0.32811, homo loss: 0.00191 
acc_train_clean: 0.8846, ASR_train_attach: 1.0000, ASR_train_outter: 0.9526
Epoch 210, loss_inner: 0.35527, loss_target: 0.41969, homo loss: 0.20558 
acc_train_clean: 0.8816, ASR_train_attach: 1.0000, ASR_train_outter: 0.9791
Epoch 220, loss_inner: 0.37179, loss_target: 0.52643, homo loss: 0.11650 
acc_train_clean: 0.8836, ASR_train_attach: 0.1333, ASR_train_outter: 0.5465
Epoch 230, loss_inner: 0.35102, loss_target: 0.33292, homo loss: 0.01884 
acc_train_clean: 0.8851, ASR_train_attach: 0.9333, ASR_train_outter: 0.9336
Epoch 240, loss_inner: 0.34635, loss_target: 0.32370, homo loss: 0.00161 
acc_train_clean: 0.8831, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 250, loss_inner: 0.34382, loss_target: 0.31789, homo loss: 0.00056 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9564
Epoch 260, loss_inner: 0.34217, loss_target: 0.31487, homo loss: 0.00092 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 0.9602
Epoch 270, loss_inner: 0.34060, loss_target: 0.31395, homo loss: 0.00147 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 0.9564
Epoch 280, loss_inner: 0.34063, loss_target: 0.34251, homo loss: 0.03631 
acc_train_clean: 0.8859, ASR_train_attach: 0.9333, ASR_train_outter: 0.8918
Epoch 290, loss_inner: 0.34026, loss_target: 0.33721, homo loss: 0.06563 
acc_train_clean: 0.8854, ASR_train_attach: 1.0000, ASR_train_outter: 0.9715
Epoch 300, loss_inner: 0.33750, loss_target: 0.31871, homo loss: 0.00818 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9829
Epoch 310, loss_inner: 0.33508, loss_target: 0.31393, homo loss: 0.00141 
acc_train_clean: 0.8874, ASR_train_attach: 1.0000, ASR_train_outter: 0.9772
Epoch 320, loss_inner: 0.33363, loss_target: 0.30672, homo loss: 0.00009 
acc_train_clean: 0.8884, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 330, loss_inner: 0.33264, loss_target: 0.30473, homo loss: 0.00377 
acc_train_clean: 0.8887, ASR_train_attach: 1.0000, ASR_train_outter: 0.9658
Epoch 340, loss_inner: 0.33288, loss_target: 0.33741, homo loss: 0.14601 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9943
Epoch 350, loss_inner: 0.33219, loss_target: 0.32655, homo loss: 0.01077 
acc_train_clean: 0.8879, ASR_train_attach: 0.8667, ASR_train_outter: 0.9108
Epoch 360, loss_inner: 0.33010, loss_target: 0.31490, homo loss: 0.00086 
acc_train_clean: 0.8899, ASR_train_attach: 0.9333, ASR_train_outter: 0.9374
Epoch 370, loss_inner: 0.32846, loss_target: 0.30791, homo loss: 0.00043 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9526
Epoch 380, loss_inner: 0.32808, loss_target: 0.30568, homo loss: 0.00026 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 0.9488
Epoch 390, loss_inner: 0.32758, loss_target: 0.31008, homo loss: 0.00004 
acc_train_clean: 0.8897, ASR_train_attach: 0.8667, ASR_train_outter: 0.9317
Epoch 400, loss_inner: 0.33060, loss_target: 0.31954, homo loss: 0.06170 
acc_train_clean: 0.8864, ASR_train_attach: 0.9333, ASR_train_outter: 0.9715
Epoch 410, loss_inner: 0.33536, loss_target: 0.41491, homo loss: 0.16597 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 420, loss_inner: 0.32824, loss_target: 0.34936, homo loss: 0.00959 
acc_train_clean: 0.8889, ASR_train_attach: 0.6000, ASR_train_outter: 0.8027
Epoch 430, loss_inner: 0.32531, loss_target: 0.30600, homo loss: 0.00055 
acc_train_clean: 0.8902, ASR_train_attach: 0.9333, ASR_train_outter: 0.9469
Epoch 440, loss_inner: 0.32332, loss_target: 0.29972, homo loss: 0.00053 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9620
Epoch 450, loss_inner: 0.32313, loss_target: 0.29867, homo loss: 0.00118 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9639
Epoch 460, loss_inner: 0.32354, loss_target: 0.30489, homo loss: 0.02039 
acc_train_clean: 0.8904, ASR_train_attach: 0.8667, ASR_train_outter: 0.9374
Epoch 470, loss_inner: 0.32417, loss_target: 0.31334, homo loss: 0.02518 
acc_train_clean: 0.8889, ASR_train_attach: 1.0000, ASR_train_outter: 0.9905
Epoch 480, loss_inner: 0.32798, loss_target: 0.34661, homo loss: 0.03131 
acc_train_clean: 0.8894, ASR_train_attach: 0.9333, ASR_train_outter: 0.9564
Epoch 490, loss_inner: 0.32233, loss_target: 0.29849, homo loss: 0.00001 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 500, loss_inner: 0.32105, loss_target: 0.30719, homo loss: 0.00631 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9772
Epoch 510, loss_inner: 0.32064, loss_target: 0.29686, homo loss: 0.00009 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9639
Epoch 520, loss_inner: 0.32180, loss_target: 0.38550, homo loss: 0.11571 
acc_train_clean: 0.8912, ASR_train_attach: 0.9333, ASR_train_outter: 0.9583
Epoch 530, loss_inner: 0.32452, loss_target: 0.30203, homo loss: 0.03199 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 0.9507
Epoch 540, loss_inner: 0.32280, loss_target: 0.30795, homo loss: 0.00300 
acc_train_clean: 0.8920, ASR_train_attach: 0.8667, ASR_train_outter: 0.9203
Epoch 550, loss_inner: 0.31913, loss_target: 0.30435, homo loss: 0.00169 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9791
Epoch 560, loss_inner: 0.31869, loss_target: 0.29802, homo loss: 0.00195 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9677
Epoch 570, loss_inner: 0.31845, loss_target: 0.29318, homo loss: 0.00016 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9620
Epoch 580, loss_inner: 0.31803, loss_target: 0.29141, homo loss: 0.00483 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9848
Epoch 590, loss_inner: 0.32696, loss_target: 0.67898, homo loss: 0.38102 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 600, loss_inner: 0.32327, loss_target: 0.40975, homo loss: 0.35733 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 610, loss_inner: 0.31847, loss_target: 0.30634, homo loss: 0.19141 
acc_train_clean: 0.8907, ASR_train_attach: 0.9333, ASR_train_outter: 0.9488
Epoch 620, loss_inner: 0.31849, loss_target: 0.31865, homo loss: 0.14804 
acc_train_clean: 0.8909, ASR_train_attach: 0.9333, ASR_train_outter: 0.9165
Epoch 630, loss_inner: 0.31724, loss_target: 0.29512, homo loss: 0.11853 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9658
Epoch 640, loss_inner: 0.31716, loss_target: 0.29213, homo loss: 0.08169 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9696
Epoch 650, loss_inner: 0.31737, loss_target: 0.34019, homo loss: 0.10619 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9791
Epoch 660, loss_inner: 0.32010, loss_target: 0.42386, homo loss: 0.18227 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 670, loss_inner: 0.31724, loss_target: 0.30908, homo loss: 0.07766 
acc_train_clean: 0.8935, ASR_train_attach: 0.9333, ASR_train_outter: 0.9431
Epoch 680, loss_inner: 0.31643, loss_target: 0.30010, homo loss: 0.04521 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9488
Epoch 690, loss_inner: 0.31584, loss_target: 0.29523, homo loss: 0.02466 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9545
Epoch 700, loss_inner: 0.31559, loss_target: 0.29357, homo loss: 0.01314 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9564
Epoch 710, loss_inner: 0.31560, loss_target: 0.29134, homo loss: 0.00674 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9602
Epoch 720, loss_inner: 0.31578, loss_target: 0.29927, homo loss: 0.00431 
acc_train_clean: 0.8932, ASR_train_attach: 0.9333, ASR_train_outter: 0.9222
Epoch 730, loss_inner: 0.31623, loss_target: 0.30047, homo loss: 0.02986 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9829
Epoch 740, loss_inner: 0.32362, loss_target: 0.40855, homo loss: 0.21761 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9848
Epoch 750, loss_inner: 0.31858, loss_target: 0.30074, homo loss: 0.11634 
acc_train_clean: 0.8897, ASR_train_attach: 0.9333, ASR_train_outter: 0.9374
Epoch 760, loss_inner: 0.31580, loss_target: 0.29606, homo loss: 0.05445 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9602
Epoch 770, loss_inner: 0.31490, loss_target: 0.30183, homo loss: 0.01969 
acc_train_clean: 0.8942, ASR_train_attach: 0.9333, ASR_train_outter: 0.9013
Epoch 780, loss_inner: 0.31466, loss_target: 0.28804, homo loss: 0.01034 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9734
Epoch 790, loss_inner: 0.31476, loss_target: 0.28650, homo loss: 0.00420 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9772
Epoch 800, loss_inner: 0.31441, loss_target: 0.28663, homo loss: 0.00191 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9753
Epoch 810, loss_inner: 0.31741, loss_target: 0.44447, homo loss: 0.20398 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9943
Epoch 820, loss_inner: 0.31579, loss_target: 0.29757, homo loss: 0.10694 
acc_train_clean: 0.8915, ASR_train_attach: 0.9333, ASR_train_outter: 0.9545
Epoch 830, loss_inner: 0.31604, loss_target: 0.29671, homo loss: 0.02721 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9545
Epoch 840, loss_inner: 0.31433, loss_target: 0.29517, homo loss: 0.00280 
acc_train_clean: 0.8927, ASR_train_attach: 0.9333, ASR_train_outter: 0.9469
Epoch 850, loss_inner: 0.31389, loss_target: 0.28872, homo loss: 0.00114 
acc_train_clean: 0.8940, ASR_train_attach: 0.9333, ASR_train_outter: 0.9696
Epoch 860, loss_inner: 0.31473, loss_target: 0.32695, homo loss: 0.04149 
acc_train_clean: 0.8927, ASR_train_attach: 0.9333, ASR_train_outter: 0.9583
Epoch 870, loss_inner: 0.31859, loss_target: 0.34241, homo loss: 0.00281 
acc_train_clean: 0.8927, ASR_train_attach: 0.4667, ASR_train_outter: 0.7324
Epoch 880, loss_inner: 0.31610, loss_target: 0.31954, homo loss: 0.00476 
acc_train_clean: 0.8955, ASR_train_attach: 0.9333, ASR_train_outter: 0.9279
Epoch 890, loss_inner: 0.31462, loss_target: 0.30136, homo loss: 0.00107 
acc_train_clean: 0.8935, ASR_train_attach: 0.9333, ASR_train_outter: 0.9469
Epoch 900, loss_inner: 0.31338, loss_target: 0.28994, homo loss: 0.00124 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9620
Epoch 910, loss_inner: 0.31648, loss_target: 0.34780, homo loss: 0.11145 
acc_train_clean: 0.8904, ASR_train_attach: 0.9333, ASR_train_outter: 0.9127
Epoch 920, loss_inner: 0.32046, loss_target: 0.32038, homo loss: 0.05220 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9924
Epoch 930, loss_inner: 0.31583, loss_target: 0.29490, homo loss: 0.00431 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9715
Epoch 940, loss_inner: 0.31406, loss_target: 0.30159, homo loss: 0.00074 
acc_train_clean: 0.8925, ASR_train_attach: 0.9333, ASR_train_outter: 0.9374
Epoch 950, loss_inner: 0.31317, loss_target: 0.28762, homo loss: 0.00035 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9677
Epoch 960, loss_inner: 0.31331, loss_target: 0.28695, homo loss: 0.00020 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9677
Epoch 970, loss_inner: 0.31332, loss_target: 0.28779, homo loss: 0.03534 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9867
Epoch 980, loss_inner: 0.32454, loss_target: 0.61179, homo loss: 0.36074 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9943
Epoch 990, loss_inner: 0.31607, loss_target: 0.29750, homo loss: 0.22984 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9810
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=921, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8519
Overall ASR: 0.8453
Flip ASR: 0.8089/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=703, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8524
Overall ASR: 0.8235
Flip ASR: 0.7819/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=80, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8534
Overall ASR: 0.8611
Flip ASR: 0.8282/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=91, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9333
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9072
Flip ASR: 0.8829/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=337, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8519
Overall ASR: 0.8534
Flip ASR: 0.8192/1554 nodes
Overall ASR: 0.8581 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8522
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=260, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8351
Overall ASR: 0.7880
Flip ASR: 0.7387/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=66, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8427
Overall ASR: 0.7819
Flip ASR: 0.7259/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=441, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8382
Overall ASR: 0.8088
Flip ASR: 0.7593/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=443, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9333
accuracy on clean test nodes: 0.8351
Overall ASR: 0.8955
Flip ASR: 0.8681/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=63, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8371
Overall ASR: 0.6937
Flip ASR: 0.6178/1554 nodes
Overall ASR: 0.7936 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8376
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=44, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8640
Overall ASR: 0.8220
Flip ASR: 0.7780/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=116, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8630
Overall ASR: 0.8286
Flip ASR: 0.7857/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=139, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8650
Overall ASR: 0.8164
Flip ASR: 0.7703/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=215, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8640
Overall ASR: 0.8296
Flip ASR: 0.7864/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=338, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1000, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8630
Overall ASR: 0.8261
Flip ASR: 0.7812/1554 nodes
Overall ASR: 0.8245 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8638
Total Overall ASR: 0.8254 
Total Clean Accuracy: 0.8512
