nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 7.8299s
Benign CA: 0.8554
#Attach Nodes:15
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.1248021125793457
acc_val: 0.2035
Epoch 10, training loss: 1.0350035429000854
acc_val: 0.4033
Epoch 20, training loss: 0.9271933436393738
acc_val: 0.4485
Epoch 30, training loss: 0.7763608694076538
acc_val: 0.6799
Epoch 40, training loss: 0.6315062642097473
acc_val: 0.8234
Epoch 50, training loss: 0.5373746752738953
acc_val: 0.8432
Epoch 60, training loss: 0.4778428375720978
acc_val: 0.8584
Epoch 70, training loss: 0.4452494978904724
acc_val: 0.8605
Epoch 80, training loss: 0.42119720578193665
acc_val: 0.8650
Epoch 90, training loss: 0.39013704657554626
acc_val: 0.8681
Epoch 100, training loss: 0.3752492070198059
acc_val: 0.8645
Epoch 110, training loss: 0.3645612299442291
acc_val: 0.8706
Epoch 120, training loss: 0.35561615228652954
acc_val: 0.8737
Epoch 130, training loss: 0.343599796295166
acc_val: 0.8701
Epoch 140, training loss: 0.3385893702507019
acc_val: 0.8727
Epoch 150, training loss: 0.33884504437446594
acc_val: 0.8747
Epoch 160, training loss: 0.3325934410095215
acc_val: 0.8747
Epoch 170, training loss: 0.3178926706314087
acc_val: 0.8782
Epoch 180, training loss: 0.3197433054447174
acc_val: 0.8757
Epoch 190, training loss: 0.32259878516197205
acc_val: 0.8711
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 2.7547s
Encoder CA on clean test nodes: 0.8579
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 7
./selected_nodes/Pubmed/Seperate/seed11/class_1.txt
[ 2622.  7012.  6767. ... 16214.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 8
./selected_nodes/Pubmed/Seperate/seed11/class_2.txt
[ 6834. 13199.   694. ...   580. 15548.  1205.]
idx_attach: tensor([ 2622,  7012,  6767,  6293,  8622, 11151, 12196,  6834, 13199,   694,
        11009, 10937,  9532, 17660, 11005], device='cuda:1')
Epoch 0, loss_inner: 1.09865, loss_target: 1.09243, homo loss: 0.48100 
acc_train_clean: 0.3467, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.96047, loss_target: 0.85973, homo loss: 0.21870 
acc_train_clean: 0.6576, ASR_train_attach: 0.8667, ASR_train_outter: 0.9602
Epoch 20, loss_inner: 0.81987, loss_target: 0.72998, homo loss: 0.15093 
acc_train_clean: 0.7963, ASR_train_attach: 0.8667, ASR_train_outter: 0.9450
Epoch 30, loss_inner: 0.68264, loss_target: 0.61061, homo loss: 0.11034 
acc_train_clean: 0.8291, ASR_train_attach: 1.0000, ASR_train_outter: 0.9829
Epoch 40, loss_inner: 0.58499, loss_target: 0.54275, homo loss: 0.02817 
acc_train_clean: 0.8400, ASR_train_attach: 0.8667, ASR_train_outter: 0.9051
Epoch 50, loss_inner: 0.54057, loss_target: 0.86677, homo loss: 0.02495 
acc_train_clean: 0.8478, ASR_train_attach: 0.0000, ASR_train_outter: 0.1176
Epoch 60, loss_inner: 0.48669, loss_target: 0.46033, homo loss: 0.06888 
acc_train_clean: 0.8529, ASR_train_attach: 0.8667, ASR_train_outter: 0.9070
Epoch 70, loss_inner: 0.45815, loss_target: 0.42943, homo loss: 0.00714 
acc_train_clean: 0.8603, ASR_train_attach: 0.9333, ASR_train_outter: 0.9241
Epoch 80, loss_inner: 0.43767, loss_target: 0.40562, homo loss: 0.00152 
acc_train_clean: 0.8646, ASR_train_attach: 0.9333, ASR_train_outter: 0.9431
Epoch 90, loss_inner: 0.42288, loss_target: 0.40791, homo loss: 0.00418 
acc_train_clean: 0.8676, ASR_train_attach: 0.8667, ASR_train_outter: 0.8899
Epoch 100, loss_inner: 0.41295, loss_target: 0.54235, homo loss: 0.28098 
acc_train_clean: 0.8699, ASR_train_attach: 1.0000, ASR_train_outter: 0.9943
Epoch 110, loss_inner: 0.40233, loss_target: 0.37785, homo loss: 0.08763 
acc_train_clean: 0.8724, ASR_train_attach: 1.0000, ASR_train_outter: 0.9848
Epoch 120, loss_inner: 0.39275, loss_target: 0.36658, homo loss: 0.01486 
acc_train_clean: 0.8734, ASR_train_attach: 1.0000, ASR_train_outter: 0.9564
Epoch 130, loss_inner: 0.38397, loss_target: 0.35573, homo loss: 0.00084 
acc_train_clean: 0.8760, ASR_train_attach: 1.0000, ASR_train_outter: 0.9450
Epoch 140, loss_inner: 0.37844, loss_target: 0.34954, homo loss: 0.00028 
acc_train_clean: 0.8778, ASR_train_attach: 1.0000, ASR_train_outter: 0.9469
Epoch 150, loss_inner: 0.37359, loss_target: 0.34514, homo loss: 0.01516 
acc_train_clean: 0.8788, ASR_train_attach: 0.9333, ASR_train_outter: 0.9620
Epoch 160, loss_inner: 0.37165, loss_target: 0.34969, homo loss: 0.10943 
acc_train_clean: 0.8793, ASR_train_attach: 1.0000, ASR_train_outter: 0.9848
Epoch 170, loss_inner: 0.36668, loss_target: 0.36669, homo loss: 0.00838 
acc_train_clean: 0.8805, ASR_train_attach: 0.8667, ASR_train_outter: 0.8748
Epoch 180, loss_inner: 0.36110, loss_target: 0.33689, homo loss: 0.00177 
acc_train_clean: 0.8826, ASR_train_attach: 1.0000, ASR_train_outter: 0.9526
Epoch 190, loss_inner: 0.35781, loss_target: 0.33139, homo loss: 0.00031 
acc_train_clean: 0.8828, ASR_train_attach: 1.0000, ASR_train_outter: 0.9526
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=921, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.8798
Flip ASR: 0.8546/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=703, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8667
accuracy on clean test nodes: 0.8534
Overall ASR: 0.8540
Flip ASR: 0.8237/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=80, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8503
Overall ASR: 0.8803
Flip ASR: 0.8546/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=91, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=15, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8539
Overall ASR: 0.9234
Flip ASR: 0.9041/1554 nodes
