nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=11, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 3.7022s
Benign CA: 0.8554
#Attach Nodes:20
idx_attach: tensor([15043, 11176, 18495, 13856,  7735, 17027, 16900, 10353, 15081,  4018,
         4065, 17271,  1025,  9514,  7970,  8997,  9593, 19110, 16170, 10267],
       device='cuda:1')
Epoch 0, loss_inner: 1.09890, loss_target: 1.09172, homo loss: 0.49232 
acc_train_clean: 0.3226, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.96484, loss_target: 0.86116, homo loss: 0.24146 
acc_train_clean: 0.6528, ASR_train_attach: 1.0000, ASR_train_outter: 0.9774
Epoch 20, loss_inner: 0.83706, loss_target: 0.86028, homo loss: 0.23346 
acc_train_clean: 0.7786, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 30, loss_inner: 0.69916, loss_target: 0.64148, homo loss: 0.23828 
acc_train_clean: 0.8136, ASR_train_attach: 1.0000, ASR_train_outter: 0.9887
Epoch 40, loss_inner: 0.58936, loss_target: 0.53994, homo loss: 0.21454 
acc_train_clean: 0.8377, ASR_train_attach: 1.0000, ASR_train_outter: 0.9680
Epoch 50, loss_inner: 0.51984, loss_target: 0.47996, homo loss: 0.19727 
acc_train_clean: 0.8481, ASR_train_attach: 1.0000, ASR_train_outter: 0.9586
Epoch 60, loss_inner: 0.48006, loss_target: 0.44548, homo loss: 0.17702 
acc_train_clean: 0.8542, ASR_train_attach: 1.0000, ASR_train_outter: 0.9568
Epoch 70, loss_inner: 0.45582, loss_target: 0.44744, homo loss: 0.22519 
acc_train_clean: 0.8615, ASR_train_attach: 1.0000, ASR_train_outter: 0.9699
Epoch 80, loss_inner: 0.43521, loss_target: 0.41137, homo loss: 0.13886 
acc_train_clean: 0.8643, ASR_train_attach: 1.0000, ASR_train_outter: 0.9549
Epoch 90, loss_inner: 0.41947, loss_target: 0.39701, homo loss: 0.10418 
acc_train_clean: 0.8679, ASR_train_attach: 1.0000, ASR_train_outter: 0.9436
Epoch 100, loss_inner: 0.41355, loss_target: 0.47190, homo loss: 0.29867 
acc_train_clean: 0.8694, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
Epoch 110, loss_inner: 0.39986, loss_target: 0.38725, homo loss: 0.19667 
acc_train_clean: 0.8712, ASR_train_attach: 1.0000, ASR_train_outter: 0.9079
Epoch 120, loss_inner: 0.38929, loss_target: 0.36833, homo loss: 0.14741 
acc_train_clean: 0.8732, ASR_train_attach: 1.0000, ASR_train_outter: 0.9624
Epoch 130, loss_inner: 0.38189, loss_target: 0.35900, homo loss: 0.11787 
acc_train_clean: 0.8762, ASR_train_attach: 1.0000, ASR_train_outter: 0.9605
Epoch 140, loss_inner: 0.37625, loss_target: 0.35339, homo loss: 0.08679 
acc_train_clean: 0.8778, ASR_train_attach: 1.0000, ASR_train_outter: 0.9605
Epoch 150, loss_inner: 0.37291, loss_target: 0.36222, homo loss: 0.12063 
acc_train_clean: 0.8778, ASR_train_attach: 1.0000, ASR_train_outter: 0.9718
Epoch 160, loss_inner: 0.36835, loss_target: 0.36291, homo loss: 0.11080 
acc_train_clean: 0.8808, ASR_train_attach: 1.0000, ASR_train_outter: 0.9530
Epoch 170, loss_inner: 0.36305, loss_target: 0.34609, homo loss: 0.06632 
acc_train_clean: 0.8805, ASR_train_attach: 1.0000, ASR_train_outter: 0.9549
Epoch 180, loss_inner: 0.36930, loss_target: 0.50148, homo loss: 0.35016 
acc_train_clean: 0.8821, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
Epoch 190, loss_inner: 0.36038, loss_target: 0.35609, homo loss: 0.25462 
acc_train_clean: 0.8833, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=921, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8463
Overall ASR: 0.4630
Flip ASR: 0.3378/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=703, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8524
Overall ASR: 0.4589
Flip ASR: 0.3346/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=80, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8483
Overall ASR: 0.4630
Flip ASR: 0.3385/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=91, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8544
Overall ASR: 0.4670
Flip ASR: 0.3462/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=337, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8488
Overall ASR: 0.4610
Flip ASR: 0.3366/1554 nodes
Overall ASR: 0.4626 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8500
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=260, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8341
Overall ASR: 0.4493
Flip ASR: 0.3282/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=66, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8316
Overall ASR: 0.4523
Flip ASR: 0.3301/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=441, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8356
Overall ASR: 0.4594
Flip ASR: 0.3378/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=443, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8356
Overall ASR: 0.4513
Flip ASR: 0.3333/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=63, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8290
Overall ASR: 0.4518
Flip ASR: 0.3288/1554 nodes
Overall ASR: 0.4528 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8332
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=44, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8625
Overall ASR: 0.4604
Flip ASR: 0.3353/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=116, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8625
Overall ASR: 0.4584
Flip ASR: 0.3333/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=139, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8635
Overall ASR: 0.4630
Flip ASR: 0.3378/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=215, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8635
Overall ASR: 0.4604
Flip ASR: 0.3359/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=338, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5500
accuracy on clean test nodes: 0.8630
Overall ASR: 0.4559
Flip ASR: 0.3314/1554 nodes
Overall ASR: 0.4596 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8630
Total Overall ASR: 0.4584 
Total Clean Accuracy: 0.8487
