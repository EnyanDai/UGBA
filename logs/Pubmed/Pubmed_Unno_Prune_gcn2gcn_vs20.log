nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:20
idx_attach: tensor([ 2407, 14892, 10532, 11865, 10343,  4477,  6124, 13501, 16064, 16288,
        13241, 19092,  3261,  1473,   773,  4570,   744, 19660,    41, 17647],
       device='cuda:1')
Epoch 0, loss_inner: 1.10025, loss_target: 1.09438, homo loss: 0.50574 
acc_train_clean: 0.2584, ASR_train_attach: 0.0500, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.98743, loss_target: 0.88395, homo loss: 0.08261 
acc_train_clean: 0.6320, ASR_train_attach: 0.9000, ASR_train_outter: 0.9737
Epoch 20, loss_inner: 0.85907, loss_target: 0.75879, homo loss: 0.07555 
acc_train_clean: 0.6901, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 30, loss_inner: 0.71323, loss_target: 0.62436, homo loss: 0.06997 
acc_train_clean: 0.8215, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
Epoch 40, loss_inner: 0.60044, loss_target: 0.53587, homo loss: 0.05569 
acc_train_clean: 0.8377, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 50, loss_inner: 0.53150, loss_target: 0.48751, homo loss: 0.03424 
acc_train_clean: 0.8468, ASR_train_attach: 0.9500, ASR_train_outter: 0.9793
Epoch 60, loss_inner: 0.48844, loss_target: 0.43598, homo loss: 0.03201 
acc_train_clean: 0.8559, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 70, loss_inner: 0.45923, loss_target: 0.41026, homo loss: 0.01814 
acc_train_clean: 0.8615, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
Epoch 80, loss_inner: 0.43706, loss_target: 0.39023, homo loss: 0.00208 
acc_train_clean: 0.8646, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 90, loss_inner: 0.41964, loss_target: 0.37228, homo loss: 0.00009 
acc_train_clean: 0.8681, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 100, loss_inner: 0.40685, loss_target: 0.36012, homo loss: 0.00000 
acc_train_clean: 0.8714, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 110, loss_inner: 0.39635, loss_target: 0.34914, homo loss: 0.00000 
acc_train_clean: 0.8724, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 120, loss_inner: 0.38762, loss_target: 0.34042, homo loss: 0.00001 
acc_train_clean: 0.8747, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 130, loss_inner: 0.38045, loss_target: 0.33377, homo loss: 0.00001 
acc_train_clean: 0.8778, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 140, loss_inner: 0.37434, loss_target: 0.32790, homo loss: 0.00001 
acc_train_clean: 0.8785, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 150, loss_inner: 0.36905, loss_target: 0.32269, homo loss: 0.00001 
acc_train_clean: 0.8805, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 160, loss_inner: 0.36447, loss_target: 0.31908, homo loss: 0.00014 
acc_train_clean: 0.8821, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 170, loss_inner: 0.36075, loss_target: 0.31535, homo loss: 0.00001 
acc_train_clean: 0.8795, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 180, loss_inner: 0.35677, loss_target: 0.31201, homo loss: 0.00002 
acc_train_clean: 0.8838, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 190, loss_inner: 0.35361, loss_target: 0.30934, homo loss: 0.00014 
acc_train_clean: 0.8838, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 200, loss_inner: 0.35398, loss_target: 0.45163, homo loss: 0.07681 
acc_train_clean: 0.8785, ASR_train_attach: 0.9000, ASR_train_outter: 0.9981
Epoch 210, loss_inner: 0.35722, loss_target: 1.91365, homo loss: 0.08372 
acc_train_clean: 0.8818, ASR_train_attach: 1.0000, ASR_train_outter: 0.2500
Epoch 220, loss_inner: 0.40465, loss_target: 1.03370, homo loss: 0.10989 
acc_train_clean: 0.8615, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 230, loss_inner: 0.51742, loss_target: 3.65279, homo loss: 0.14059 
acc_train_clean: 0.8123, ASR_train_attach: 1.0000, ASR_train_outter: 0.4004
Epoch 240, loss_inner: 0.61495, loss_target: 1.71766, homo loss: 0.19531 
acc_train_clean: 0.7461, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 250, loss_inner: 0.52823, loss_target: 2.43570, homo loss: 0.20114 
acc_train_clean: 0.8199, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 260, loss_inner: 0.47273, loss_target: 9.87827, homo loss: 0.19619 
acc_train_clean: 0.8428, ASR_train_attach: 1.0000, ASR_train_outter: 0.8835
Epoch 270, loss_inner: 0.90667, loss_target: 7.94457, homo loss: 0.16278 
acc_train_clean: 0.8557, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 280, loss_inner: 1.14934, loss_target: 10.69869, homo loss: 0.16110 
acc_train_clean: 0.8658, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 290, loss_inner: 0.52047, loss_target: 5.27570, homo loss: 0.14057 
acc_train_clean: 0.8658, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 300, loss_inner: 0.72380, loss_target: 22.81034, homo loss: 0.15548 
acc_train_clean: 0.8618, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 310, loss_inner: 0.50688, loss_target: 44.16710, homo loss: 0.17618 
acc_train_clean: 0.8625, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 320, loss_inner: 0.52592, loss_target: 51.81512, homo loss: 0.18888 
acc_train_clean: 0.8592, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 330, loss_inner: 0.64638, loss_target: 51.29818, homo loss: 0.22386 
acc_train_clean: 0.8590, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 340, loss_inner: 0.98349, loss_target: 48.77182, homo loss: 0.25861 
acc_train_clean: 0.8585, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 350, loss_inner: 0.71821, loss_target: 83.52575, homo loss: 0.27787 
acc_train_clean: 0.8699, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 360, loss_inner: 1.94681, loss_target: 129.66823, homo loss: 0.26527 
acc_train_clean: 0.8694, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 370, loss_inner: 2.92959, loss_target: 48.93613, homo loss: 0.18465 
acc_train_clean: 0.8681, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 380, loss_inner: 0.46732, loss_target: 189.77069, homo loss: 0.17842 
acc_train_clean: 0.8628, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 390, loss_inner: 1.42810, loss_target: 136.68678, homo loss: 0.16859 
acc_train_clean: 0.8625, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9995
Flip ASR: 0.9994/1554 nodes
Overall ASR: 0.9995 (GCN model, Seed: 10)
Overall Clean Accuracy: 0.8513
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8376
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Overall ASR: 1.0000 (GAT model, Seed: 10)
Overall Clean Accuracy: 0.8376
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=20, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8635
Overall ASR: 0.9508
Flip ASR: 0.9382/1554 nodes
Overall ASR: 0.9508 (GraphSage model, Seed: 10)
Overall Clean Accuracy: 0.8635
Total Overall ASR: 0.9834 
Total Clean Accuracy: 0.8508
