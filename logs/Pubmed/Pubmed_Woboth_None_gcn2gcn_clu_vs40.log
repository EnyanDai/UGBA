nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:40
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.0969727039337158
acc_val: 0.4039
Epoch 10, training loss: 1.0288714170455933
acc_val: 0.6398
Epoch 20, training loss: 0.8768908977508545
acc_val: 0.6768
Epoch 30, training loss: 0.6742265820503235
acc_val: 0.7012
Epoch 40, training loss: 0.5647508502006531
acc_val: 0.8376
Epoch 50, training loss: 0.4839770495891571
acc_val: 0.8534
Epoch 60, training loss: 0.46598020195961
acc_val: 0.8590
Epoch 70, training loss: 0.41184496879577637
acc_val: 0.8666
Epoch 80, training loss: 0.38867178559303284
acc_val: 0.8676
Epoch 90, training loss: 0.3762263059616089
acc_val: 0.8711
Epoch 100, training loss: 0.3615362048149109
acc_val: 0.8676
Epoch 110, training loss: 0.34779754281044006
acc_val: 0.8727
Epoch 120, training loss: 0.34485769271850586
acc_val: 0.8737
Epoch 130, training loss: 0.33629605174064636
acc_val: 0.8732
Epoch 140, training loss: 0.3328101933002472
acc_val: 0.8747
Epoch 150, training loss: 0.3277325928211212
acc_val: 0.8777
Epoch 160, training loss: 0.32859721779823303
acc_val: 0.8757
Epoch 170, training loss: 0.30819016695022583
acc_val: 0.8737
Epoch 180, training loss: 0.29885607957839966
acc_val: 0.8747
Epoch 190, training loss: 0.301382839679718
acc_val: 0.8772
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 1.6093s
Encoder CA on clean test nodes: 0.8569
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_1.txt
[ 5104. 15916. 14578. ...  4058.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_2.txt
[11009.  2782. 11343. ...  8626. 15548.  1205.]
idx_attach: tensor([ 5104, 15916, 14578,  9040, 14315, 14910,  7647,  7098, 11534,  7803,
        10837, 18637, 19544,   821,  4899, 18597, 14851,  9145, 13907, 10814,
        11009,  2782, 11343, 14528, 19272,  6196, 16600, 17595, 17660,  9488,
         2471,  3489,  7324, 19307,  7825,   688,  2799,  6114,  4498, 13749],
       device='cuda:1')
Epoch 0, loss_inner: 1.09870, loss_target: 1.08898, homo loss: 0.00000 
acc_train_clean: 0.3190, ASR_train_attach: 0.9000, ASR_train_outter: 0.1268
Epoch 10, loss_inner: 0.96888, loss_target: 0.86375, homo loss: 0.00000 
acc_train_clean: 0.6566, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 20, loss_inner: 0.83616, loss_target: 0.74669, homo loss: 0.00000 
acc_train_clean: 0.7705, ASR_train_attach: 0.9750, ASR_train_outter: 0.9909
Epoch 30, loss_inner: 0.70261, loss_target: 0.64919, homo loss: 0.00000 
acc_train_clean: 0.8212, ASR_train_attach: 0.9750, ASR_train_outter: 0.9891
Epoch 40, loss_inner: 0.59849, loss_target: 0.54818, homo loss: 0.00000 
acc_train_clean: 0.8395, ASR_train_attach: 0.9250, ASR_train_outter: 0.9728
Epoch 50, loss_inner: 0.53334, loss_target: 0.54513, homo loss: 0.00000 
acc_train_clean: 0.8455, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 0.50018, loss_target: 0.47403, homo loss: 0.00000 
acc_train_clean: 0.8547, ASR_train_attach: 0.8250, ASR_train_outter: 0.9076
Epoch 70, loss_inner: 0.47029, loss_target: 0.44387, homo loss: 0.00000 
acc_train_clean: 0.8567, ASR_train_attach: 0.9250, ASR_train_outter: 0.9692
Epoch 80, loss_inner: 0.44545, loss_target: 0.41278, homo loss: 0.00000 
acc_train_clean: 0.8625, ASR_train_attach: 0.9000, ASR_train_outter: 0.9620
Epoch 90, loss_inner: 0.42707, loss_target: 0.39533, homo loss: 0.00000 
acc_train_clean: 0.8669, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
Epoch 100, loss_inner: 0.41348, loss_target: 0.39129, homo loss: 0.00000 
acc_train_clean: 0.8691, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 110, loss_inner: 0.40271, loss_target: 0.37213, homo loss: 0.00000 
acc_train_clean: 0.8714, ASR_train_attach: 0.8750, ASR_train_outter: 0.9420
Epoch 120, loss_inner: 0.39440, loss_target: 0.37493, homo loss: 0.00000 
acc_train_clean: 0.8722, ASR_train_attach: 0.8750, ASR_train_outter: 0.9004
Epoch 130, loss_inner: 0.39492, loss_target: 0.50541, homo loss: 0.00000 
acc_train_clean: 0.8689, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 140, loss_inner: 0.38420, loss_target: 0.36688, homo loss: 0.00000 
acc_train_clean: 0.8747, ASR_train_attach: 0.8500, ASR_train_outter: 0.9330
Epoch 150, loss_inner: 0.37501, loss_target: 0.34743, homo loss: 0.00000 
acc_train_clean: 0.8780, ASR_train_attach: 0.8750, ASR_train_outter: 0.9493
Epoch 160, loss_inner: 0.36903, loss_target: 0.33658, homo loss: 0.00000 
acc_train_clean: 0.8795, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
Epoch 170, loss_inner: 0.36520, loss_target: 0.34041, homo loss: 0.00000 
acc_train_clean: 0.8793, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 180, loss_inner: 0.36092, loss_target: 0.33089, homo loss: 0.00000 
acc_train_clean: 0.8826, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 190, loss_inner: 0.39712, loss_target: 0.40866, homo loss: 0.00000 
acc_train_clean: 0.8813, ASR_train_attach: 0.1250, ASR_train_outter: 0.6938
Epoch 200, loss_inner: 0.37796, loss_target: 0.48123, homo loss: 0.00000 
acc_train_clean: 0.8788, ASR_train_attach: 0.5250, ASR_train_outter: 0.5743
Epoch 210, loss_inner: 0.36070, loss_target: 0.34241, homo loss: 0.00000 
acc_train_clean: 0.8803, ASR_train_attach: 0.8750, ASR_train_outter: 0.9384
Epoch 220, loss_inner: 0.35323, loss_target: 0.33735, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 0.9250, ASR_train_outter: 0.9638
Epoch 230, loss_inner: 0.34856, loss_target: 0.32357, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 1.0000, ASR_train_outter: 0.9764
Epoch 240, loss_inner: 0.34498, loss_target: 0.31677, homo loss: 0.00000 
acc_train_clean: 0.8851, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 250, loss_inner: 0.34307, loss_target: 0.31221, homo loss: 0.00000 
acc_train_clean: 0.8861, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 260, loss_inner: 0.34107, loss_target: 0.30886, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 270, loss_inner: 0.33958, loss_target: 0.30667, homo loss: 0.00000 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 280, loss_inner: 0.33815, loss_target: 0.30910, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 290, loss_inner: 0.33657, loss_target: 0.30451, homo loss: 0.00000 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 300, loss_inner: 0.33521, loss_target: 0.30256, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 310, loss_inner: 0.33384, loss_target: 0.30250, homo loss: 0.00000 
acc_train_clean: 0.8876, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 320, loss_inner: 0.33573, loss_target: 0.30397, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 0.8500, ASR_train_outter: 0.9620
Epoch 330, loss_inner: 0.43436, loss_target: 1.37565, homo loss: 0.00000 
acc_train_clean: 0.8646, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 340, loss_inner: 0.39596, loss_target: 0.75547, homo loss: 0.00000 
acc_train_clean: 0.8666, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 350, loss_inner: 0.35673, loss_target: 0.39234, homo loss: 0.00000 
acc_train_clean: 0.8757, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 360, loss_inner: 0.34182, loss_target: 0.30464, homo loss: 0.00000 
acc_train_clean: 0.8808, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 370, loss_inner: 0.33624, loss_target: 0.29214, homo loss: 0.00000 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 380, loss_inner: 0.33240, loss_target: 0.28845, homo loss: 0.00000 
acc_train_clean: 0.8856, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 390, loss_inner: 0.32975, loss_target: 0.28644, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 400, loss_inner: 0.32805, loss_target: 0.28516, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 410, loss_inner: 0.32664, loss_target: 0.28389, homo loss: 0.00000 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 420, loss_inner: 0.32546, loss_target: 0.28275, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 430, loss_inner: 0.32446, loss_target: 0.28212, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 440, loss_inner: 0.32357, loss_target: 0.28124, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 450, loss_inner: 0.32280, loss_target: 0.28029, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 460, loss_inner: 0.32208, loss_target: 0.28027, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 470, loss_inner: 0.32139, loss_target: 0.27908, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 480, loss_inner: 0.32078, loss_target: 0.27852, homo loss: 0.00000 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 490, loss_inner: 0.32021, loss_target: 0.27795, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 500, loss_inner: 0.31970, loss_target: 0.27779, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 510, loss_inner: 0.31920, loss_target: 0.27718, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 520, loss_inner: 0.31873, loss_target: 0.27679, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 530, loss_inner: 0.31830, loss_target: 0.27648, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 540, loss_inner: 0.31789, loss_target: 0.27615, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 550, loss_inner: 0.31751, loss_target: 0.27573, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 560, loss_inner: 0.31715, loss_target: 0.27546, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 570, loss_inner: 0.31681, loss_target: 0.27526, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 580, loss_inner: 0.31649, loss_target: 0.27503, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 590, loss_inner: 0.31619, loss_target: 0.27468, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 600, loss_inner: 0.31594, loss_target: 0.27552, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 610, loss_inner: 0.31573, loss_target: 0.27447, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 620, loss_inner: 0.31543, loss_target: 0.27393, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 630, loss_inner: 0.31515, loss_target: 0.27381, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 640, loss_inner: 0.31493, loss_target: 0.27360, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 650, loss_inner: 0.31473, loss_target: 0.27382, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 660, loss_inner: 0.31464, loss_target: 0.27342, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 670, loss_inner: 0.31432, loss_target: 0.27306, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 680, loss_inner: 0.31413, loss_target: 0.27288, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 690, loss_inner: 0.31396, loss_target: 0.27278, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 700, loss_inner: 0.31387, loss_target: 0.27336, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 710, loss_inner: 0.31370, loss_target: 0.27272, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 720, loss_inner: 0.31353, loss_target: 0.27241, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 730, loss_inner: 0.31340, loss_target: 0.27225, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 740, loss_inner: 0.31334, loss_target: 0.27209, homo loss: 0.00000 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 750, loss_inner: 0.31317, loss_target: 0.27209, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 760, loss_inner: 0.31302, loss_target: 0.27190, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 770, loss_inner: 0.31291, loss_target: 0.27188, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 780, loss_inner: 0.31280, loss_target: 0.27159, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 790, loss_inner: 0.31260, loss_target: 0.27165, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 800, loss_inner: 0.31264, loss_target: 0.27164, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 810, loss_inner: 0.31264, loss_target: 0.27140, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 820, loss_inner: 0.31251, loss_target: 0.27102, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 830, loss_inner: 0.31237, loss_target: 0.27078, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 840, loss_inner: 0.31230, loss_target: 0.27112, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 850, loss_inner: 0.31220, loss_target: 0.27084, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 860, loss_inner: 0.31212, loss_target: 0.27062, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 870, loss_inner: 0.31206, loss_target: 0.27052, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 880, loss_inner: 0.31206, loss_target: 0.27059, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 890, loss_inner: 0.31195, loss_target: 0.27034, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 900, loss_inner: 0.31189, loss_target: 0.27037, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 910, loss_inner: 0.31184, loss_target: 0.27034, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 920, loss_inner: 0.31178, loss_target: 0.27030, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 930, loss_inner: 0.31173, loss_target: 0.27022, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 940, loss_inner: 0.31169, loss_target: 0.27076, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 950, loss_inner: 0.31199, loss_target: 0.27073, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 960, loss_inner: 0.31179, loss_target: 0.27131, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 970, loss_inner: 0.31156, loss_target: 0.27011, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 980, loss_inner: 0.31154, loss_target: 0.27024, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 990, loss_inner: 0.31149, loss_target: 0.27006, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1000, loss_inner: 0.31145, loss_target: 0.26998, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1010, loss_inner: 0.31142, loss_target: 0.26996, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1020, loss_inner: 0.31139, loss_target: 0.26992, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1030, loss_inner: 0.31135, loss_target: 0.26988, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1040, loss_inner: 0.31132, loss_target: 0.26997, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1050, loss_inner: 0.31130, loss_target: 0.27018, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1060, loss_inner: 0.31127, loss_target: 0.27070, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1070, loss_inner: 0.31127, loss_target: 0.27036, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1080, loss_inner: 0.31124, loss_target: 0.27013, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1090, loss_inner: 0.31122, loss_target: 0.27008, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1100, loss_inner: 0.31142, loss_target: 0.27073, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1110, loss_inner: 0.31115, loss_target: 0.26990, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1120, loss_inner: 0.31116, loss_target: 0.26967, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1130, loss_inner: 0.31112, loss_target: 0.26974, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1140, loss_inner: 0.31109, loss_target: 0.26967, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1150, loss_inner: 0.31105, loss_target: 0.27084, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1160, loss_inner: 0.31117, loss_target: 0.27001, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1170, loss_inner: 0.31112, loss_target: 0.26982, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1180, loss_inner: 0.31105, loss_target: 0.26971, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1190, loss_inner: 0.31101, loss_target: 0.26961, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1200, loss_inner: 0.31103, loss_target: 0.26982, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1210, loss_inner: 0.31119, loss_target: 0.27033, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1220, loss_inner: 0.31097, loss_target: 0.26971, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1230, loss_inner: 0.31096, loss_target: 0.26955, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1240, loss_inner: 0.31095, loss_target: 0.26956, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1250, loss_inner: 0.31100, loss_target: 0.26963, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1260, loss_inner: 0.31090, loss_target: 0.26945, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1270, loss_inner: 0.31092, loss_target: 0.26949, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1280, loss_inner: 0.31091, loss_target: 0.26955, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1290, loss_inner: 0.31090, loss_target: 0.26950, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1300, loss_inner: 0.31089, loss_target: 0.26946, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1310, loss_inner: 0.31087, loss_target: 0.26944, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1320, loss_inner: 0.31088, loss_target: 0.26959, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1330, loss_inner: 0.31128, loss_target: 0.27340, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1340, loss_inner: 0.31083, loss_target: 0.26925, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1350, loss_inner: 0.31084, loss_target: 0.26933, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1360, loss_inner: 0.31084, loss_target: 0.26948, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1370, loss_inner: 0.31084, loss_target: 0.26943, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1380, loss_inner: 0.31084, loss_target: 0.26954, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1390, loss_inner: 0.31082, loss_target: 0.26947, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1400, loss_inner: 0.31081, loss_target: 0.26946, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1410, loss_inner: 0.31108, loss_target: 0.26970, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1420, loss_inner: 0.31079, loss_target: 0.27032, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1430, loss_inner: 0.31088, loss_target: 0.26964, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1440, loss_inner: 0.31080, loss_target: 0.26930, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1450, loss_inner: 0.31080, loss_target: 0.26931, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1460, loss_inner: 0.31080, loss_target: 0.26942, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1470, loss_inner: 0.31079, loss_target: 0.26936, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1480, loss_inner: 0.31078, loss_target: 0.26934, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1490, loss_inner: 0.31078, loss_target: 0.26933, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1500, loss_inner: 0.31077, loss_target: 0.26932, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1510, loss_inner: 0.31076, loss_target: 0.26931, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1520, loss_inner: 0.31076, loss_target: 0.26931, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1530, loss_inner: 0.31076, loss_target: 0.26937, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1540, loss_inner: 0.31075, loss_target: 0.26932, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1550, loss_inner: 0.31075, loss_target: 0.26932, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1560, loss_inner: 0.31076, loss_target: 0.26984, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1570, loss_inner: 0.31098, loss_target: 0.27261, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1580, loss_inner: 0.31086, loss_target: 0.26941, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1590, loss_inner: 0.31094, loss_target: 0.27130, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1600, loss_inner: 0.31075, loss_target: 0.26938, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1610, loss_inner: 0.31077, loss_target: 0.26946, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1620, loss_inner: 0.31076, loss_target: 0.26930, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1630, loss_inner: 0.31075, loss_target: 0.26951, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1640, loss_inner: 0.31074, loss_target: 0.26943, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1650, loss_inner: 0.31074, loss_target: 0.26999, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1660, loss_inner: 0.31074, loss_target: 0.26926, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1670, loss_inner: 0.31073, loss_target: 0.26927, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1680, loss_inner: 0.31073, loss_target: 0.26941, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1690, loss_inner: 0.31073, loss_target: 0.26962, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1700, loss_inner: 0.31075, loss_target: 0.26999, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1710, loss_inner: 0.31074, loss_target: 0.26994, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1720, loss_inner: 0.31073, loss_target: 0.26951, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1730, loss_inner: 0.31074, loss_target: 0.26989, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1740, loss_inner: 0.31071, loss_target: 0.26930, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1750, loss_inner: 0.31074, loss_target: 0.26996, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1760, loss_inner: 0.31071, loss_target: 0.26919, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1770, loss_inner: 0.31081, loss_target: 0.26930, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1780, loss_inner: 0.31070, loss_target: 0.26978, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1790, loss_inner: 0.31075, loss_target: 0.26913, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1800, loss_inner: 0.31072, loss_target: 0.26939, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1810, loss_inner: 0.31073, loss_target: 0.26941, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1820, loss_inner: 0.31079, loss_target: 0.26947, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1830, loss_inner: 0.31072, loss_target: 0.26924, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1840, loss_inner: 0.31071, loss_target: 0.26937, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1850, loss_inner: 0.31071, loss_target: 0.26927, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1860, loss_inner: 0.31071, loss_target: 0.26935, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1870, loss_inner: 0.31072, loss_target: 0.26945, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1880, loss_inner: 0.31070, loss_target: 0.26921, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1890, loss_inner: 0.31080, loss_target: 0.27072, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1900, loss_inner: 0.31155, loss_target: 0.27273, homo loss: 0.00000 
acc_train_clean: 0.8950, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1910, loss_inner: 0.31076, loss_target: 0.26940, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1920, loss_inner: 0.31073, loss_target: 0.26940, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1930, loss_inner: 0.31073, loss_target: 0.26918, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1940, loss_inner: 0.31073, loss_target: 0.26942, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1950, loss_inner: 0.31076, loss_target: 0.27361, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1960, loss_inner: 0.31076, loss_target: 0.27039, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1970, loss_inner: 0.31071, loss_target: 0.26936, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1980, loss_inner: 0.31070, loss_target: 0.26953, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1990, loss_inner: 0.31071, loss_target: 0.26931, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8524
Overall ASR: 0.9985
Flip ASR: 0.9981/1554 nodes
Overall ASR: 0.9985 (GCN model, Seed: 10)
Overall Clean Accuracy: 0.8524
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8382
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Overall ASR: 1.0000 (GAT model, Seed: 10)
Overall Clean Accuracy: 0.8382
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8584
Overall ASR: 0.8818
Flip ASR: 0.8526/1554 nodes
Overall ASR: 0.8818 (GraphSage model, Seed: 10)
Overall Clean Accuracy: 0.8584
Total Overall ASR: 0.9601 
Total Clean Accuracy: 0.8497
