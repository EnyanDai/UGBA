nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 9.7830s
Benign CA: 0.8554
#Attach Nodes:10
idx_attach: tensor([15043, 11176, 18495, 13856,  7735, 17027, 16900, 10353, 15081,  4018],
       device='cuda:1')
Epoch 0, loss_inner: 1.09889, loss_target: 1.09265, homo loss: 0.49375 
acc_train_clean: 0.3226, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 0.96978, loss_target: 0.89195, homo loss: 0.22823 
acc_train_clean: 0.6556, ASR_train_attach: 0.9000, ASR_train_outter: 0.8927
Epoch 20, loss_inner: 0.83073, loss_target: 0.74799, homo loss: 0.14859 
acc_train_clean: 0.7335, ASR_train_attach: 1.0000, ASR_train_outter: 0.9291
Epoch 30, loss_inner: 0.68747, loss_target: 0.66942, homo loss: 0.04964 
acc_train_clean: 0.8209, ASR_train_attach: 0.9000, ASR_train_outter: 0.7222
Epoch 40, loss_inner: 0.58027, loss_target: 0.59303, homo loss: 0.02358 
acc_train_clean: 0.8402, ASR_train_attach: 0.8000, ASR_train_outter: 0.6590
Epoch 50, loss_inner: 0.51584, loss_target: 0.48931, homo loss: 0.00384 
acc_train_clean: 0.8499, ASR_train_attach: 1.0000, ASR_train_outter: 0.9100
Epoch 60, loss_inner: 0.48324, loss_target: 0.60786, homo loss: 0.07778 
acc_train_clean: 0.8549, ASR_train_attach: 0.2000, ASR_train_outter: 0.3123
Epoch 70, loss_inner: 0.45299, loss_target: 0.45165, homo loss: 0.00826 
acc_train_clean: 0.8615, ASR_train_attach: 0.9000, ASR_train_outter: 0.8602
Epoch 80, loss_inner: 0.43187, loss_target: 0.40723, homo loss: 0.00106 
acc_train_clean: 0.8656, ASR_train_attach: 1.0000, ASR_train_outter: 0.9444
Epoch 90, loss_inner: 0.41947, loss_target: 0.52405, homo loss: 0.00063 
acc_train_clean: 0.8671, ASR_train_attach: 0.6000, ASR_train_outter: 0.4617
Epoch 100, loss_inner: 0.40751, loss_target: 0.41357, homo loss: 0.14276 
acc_train_clean: 0.8701, ASR_train_attach: 0.9000, ASR_train_outter: 0.8046
Epoch 110, loss_inner: 0.39599, loss_target: 0.38336, homo loss: 0.03264 
acc_train_clean: 0.8719, ASR_train_attach: 1.0000, ASR_train_outter: 0.9157
Epoch 120, loss_inner: 0.38762, loss_target: 0.36630, homo loss: 0.00153 
acc_train_clean: 0.8742, ASR_train_attach: 1.0000, ASR_train_outter: 0.9540
Epoch 130, loss_inner: 0.38125, loss_target: 0.36749, homo loss: 0.00005 
acc_train_clean: 0.8765, ASR_train_attach: 1.0000, ASR_train_outter: 0.9119
Epoch 140, loss_inner: 0.38049, loss_target: 0.53758, homo loss: 0.23292 
acc_train_clean: 0.8765, ASR_train_attach: 1.0000, ASR_train_outter: 0.9674
Epoch 150, loss_inner: 0.37319, loss_target: 0.36421, homo loss: 0.12069 
acc_train_clean: 0.8785, ASR_train_attach: 1.0000, ASR_train_outter: 0.9674
Epoch 160, loss_inner: 0.36700, loss_target: 0.35518, homo loss: 0.03455 
acc_train_clean: 0.8800, ASR_train_attach: 1.0000, ASR_train_outter: 0.9502
Epoch 170, loss_inner: 0.36246, loss_target: 0.34539, homo loss: 0.00075 
acc_train_clean: 0.8823, ASR_train_attach: 1.0000, ASR_train_outter: 0.9330
Epoch 180, loss_inner: 0.35892, loss_target: 0.33686, homo loss: 0.00022 
acc_train_clean: 0.8836, ASR_train_attach: 1.0000, ASR_train_outter: 0.9502
Epoch 190, loss_inner: 0.35592, loss_target: 0.33112, homo loss: 0.00047 
acc_train_clean: 0.8846, ASR_train_attach: 1.0000, ASR_train_outter: 0.9559
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=921, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8498
Overall ASR: 0.5644
Flip ASR: 0.4633/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=703, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8529
Overall ASR: 0.4939
Flip ASR: 0.3771/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=80, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.6405
Flip ASR: 0.5573/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=91, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8503
Overall ASR: 0.6587
Flip ASR: 0.5811/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=337, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8503
Overall ASR: 0.5745
Flip ASR: 0.4768/1554 nodes
Overall ASR: 0.5864 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8509
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=260, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.6000
accuracy on clean test nodes: 0.8387
Overall ASR: 0.3337
Flip ASR: 0.1892/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=66, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.6000
accuracy on clean test nodes: 0.8371
Overall ASR: 0.3798
Flip ASR: 0.2368/1554 nodes
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=441, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.4000
accuracy on clean test nodes: 0.8387
Overall ASR: 0.2941
Flip ASR: 0.1499/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=443, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.4000
accuracy on clean test nodes: 0.8361
Overall ASR: 0.2961
Flip ASR: 0.1519/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=63, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.6000
accuracy on clean test nodes: 0.8376
Overall ASR: 0.3824
Flip ASR: 0.2413/1554 nodes
Overall ASR: 0.3372 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8376
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=44, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8595
Overall ASR: 0.6212
Flip ASR: 0.5290/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=116, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8605
Overall ASR: 0.6146
Flip ASR: 0.5199/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=139, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.8615
Overall ASR: 0.6166
Flip ASR: 0.5232/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=215, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8579
Overall ASR: 0.6313
Flip ASR: 0.5412/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=3.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=338, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7000
accuracy on clean test nodes: 0.8605
Overall ASR: 0.6004
Flip ASR: 0.5039/1554 nodes
Overall ASR: 0.6168 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8600
Total Overall ASR: 0.5135 
Total Clean Accuracy: 0.8495
