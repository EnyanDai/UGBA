nohup: ignoring input
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=11, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
Length of training set: 3943
Training benign model Finished!
Total time elapsed: 2.4951s
Benign CA: 0.8554
#Attach Nodes:120
idx_attach: tensor([15043, 11176, 18495, 13856,  7735, 17027, 16900, 10353, 15081,  4018,
         4065, 17271,  1025,  9514,  7970,  8997,  9593, 19110, 16170, 10267,
         4135, 12907, 17633,  1512, 15716, 16566,  9525,   378, 13898,   249,
        13238, 15191, 13783,  5275, 14931, 19011, 16362,  1484,  3456, 14990,
        10455, 10221,  5535,  6725,  5383, 19243, 14552, 13781,  2516,  8741,
        18391, 16902, 17186, 13196,  5105, 12865, 18031, 19386,  5164,  3766,
        10049, 11912,  4776, 19265, 16292, 10825, 18858, 14313,  6118,  7308,
        13817, 17564,  3344, 19605,  9322,  5519, 14680,  6459, 13386,  8650,
         8190, 12762,   164,  2827, 13237, 16938, 13932,  3872, 19094,  9644,
         7680,  9814,  2066,  9387, 14912,  4041, 18629,  8621,   246,  1431,
        13693, 18533,  8753,  1244,  5626,  7648,    11,  6113,  6290,  5389,
        16639, 19615,  9524,  9101, 10964, 11859,  4595, 13671, 10687, 12661],
       device='cuda:3')
Epoch 0, loss_inner: 1.09899, loss_target: 1.08372, homo loss: 0.49544 
acc_train_clean: 0.3226, ASR_train_attach: 0.0083, ASR_train_outter: 0.8259
Epoch 10, loss_inner: 0.96421, loss_target: 0.85880, homo loss: 0.23044 
acc_train_clean: 0.6176, ASR_train_attach: 1.0000, ASR_train_outter: 0.9968
Epoch 20, loss_inner: 0.90999, loss_target: 0.99335, homo loss: 0.23642 
acc_train_clean: 0.6383, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 30, loss_inner: 0.83341, loss_target: 0.75743, homo loss: 0.22882 
acc_train_clean: 0.6670, ASR_train_attach: 0.9583, ASR_train_outter: 0.9478
Epoch 40, loss_inner: 0.78250, loss_target: 0.70598, homo loss: 0.22634 
acc_train_clean: 0.7403, ASR_train_attach: 0.9917, ASR_train_outter: 0.9921
Epoch 50, loss_inner: 0.72566, loss_target: 0.65354, homo loss: 0.20944 
acc_train_clean: 0.7971, ASR_train_attach: 0.9917, ASR_train_outter: 0.9858
Epoch 60, loss_inner: 0.67164, loss_target: 0.61565, homo loss: 0.21042 
acc_train_clean: 0.8159, ASR_train_attach: 0.9917, ASR_train_outter: 0.9889
Epoch 70, loss_inner: 0.64156, loss_target: 0.65451, homo loss: 0.26101 
acc_train_clean: 0.8179, ASR_train_attach: 1.0000, ASR_train_outter: 0.9905
Epoch 80, loss_inner: 0.57818, loss_target: 0.52916, homo loss: 0.20578 
acc_train_clean: 0.8405, ASR_train_attach: 0.9833, ASR_train_outter: 0.9636
Epoch 90, loss_inner: 0.54047, loss_target: 0.49555, homo loss: 0.18377 
acc_train_clean: 0.8430, ASR_train_attach: 0.9417, ASR_train_outter: 0.9430
Epoch 100, loss_inner: 0.50968, loss_target: 0.47240, homo loss: 0.15721 
acc_train_clean: 0.8471, ASR_train_attach: 0.9417, ASR_train_outter: 0.9241
Epoch 110, loss_inner: 0.48290, loss_target: 0.44186, homo loss: 0.16986 
acc_train_clean: 0.8491, ASR_train_attach: 0.9583, ASR_train_outter: 0.9684
Epoch 120, loss_inner: 0.46882, loss_target: 0.44497, homo loss: 0.19326 
acc_train_clean: 0.8521, ASR_train_attach: 1.0000, ASR_train_outter: 0.9905
Epoch 130, loss_inner: 0.45022, loss_target: 0.42000, homo loss: 0.17173 
acc_train_clean: 0.8554, ASR_train_attach: 0.9833, ASR_train_outter: 0.9763
Epoch 140, loss_inner: 0.43477, loss_target: 0.40170, homo loss: 0.14790 
acc_train_clean: 0.8603, ASR_train_attach: 0.9500, ASR_train_outter: 0.9509
Epoch 150, loss_inner: 0.42338, loss_target: 0.39200, homo loss: 0.12857 
acc_train_clean: 0.8630, ASR_train_attach: 0.9500, ASR_train_outter: 0.9494
Epoch 160, loss_inner: 0.42043, loss_target: 0.40620, homo loss: 0.18696 
acc_train_clean: 0.8651, ASR_train_attach: 0.9500, ASR_train_outter: 0.9557
Epoch 170, loss_inner: 0.40827, loss_target: 0.38098, homo loss: 0.15315 
acc_train_clean: 0.8633, ASR_train_attach: 0.9750, ASR_train_outter: 0.9699
Epoch 180, loss_inner: 0.39998, loss_target: 0.37295, homo loss: 0.12283 
acc_train_clean: 0.8684, ASR_train_attach: 0.9500, ASR_train_outter: 0.9446
Epoch 190, loss_inner: 0.43421, loss_target: 0.53531, homo loss: 0.32868 
acc_train_clean: 0.8623, ASR_train_attach: 1.0000, ASR_train_outter: 0.9968
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=921, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3083
accuracy on clean test nodes: 0.8402
Overall ASR: 0.2672
Flip ASR: 0.0972/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=703, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3250
accuracy on clean test nodes: 0.8468
Overall ASR: 0.2683
Flip ASR: 0.0978/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=80, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3083
accuracy on clean test nodes: 0.8453
Overall ASR: 0.2652
Flip ASR: 0.0978/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=91, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3083
accuracy on clean test nodes: 0.8483
Overall ASR: 0.2657
Flip ASR: 0.0997/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=337, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3250
accuracy on clean test nodes: 0.8447
Overall ASR: 0.2662
Flip ASR: 0.0985/1554 nodes
Overall ASR: 0.2665 (GCN model, Seed: 337)
Overall Clean Accuracy: 0.8451
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=260, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3167
/home/mfl5681/project-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
accuracy on clean test nodes: 0.8305
Overall ASR: 0.2612
Flip ASR: 0.0965/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=66, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3000
accuracy on clean test nodes: 0.8280
Overall ASR: 0.2591
Flip ASR: 0.0927/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=441, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.2917
accuracy on clean test nodes: 0.8371
Overall ASR: 0.2591
Flip ASR: 0.0927/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=443, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.2917
accuracy on clean test nodes: 0.8270
Overall ASR: 0.2688
Flip ASR: 0.1017/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=63, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.2500
accuracy on clean test nodes: 0.8275
Overall ASR: 0.2495
Flip ASR: 0.0811/1554 nodes
Overall ASR: 0.2595 (GAT model, Seed: 63)
Overall Clean Accuracy: 0.8300
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=44, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3167
accuracy on clean test nodes: 0.8579
Overall ASR: 0.2688
Flip ASR: 0.0985/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=116, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3333
accuracy on clean test nodes: 0.8615
Overall ASR: 0.2688
Flip ASR: 0.0991/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=139, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3333
accuracy on clean test nodes: 0.8620
Overall ASR: 0.2662
Flip ASR: 0.0965/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=215, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3250
accuracy on clean test nodes: 0.8579
Overall ASR: 0.2662
Flip ASR: 0.0985/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='prune', device_id=3, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.3, seed=338, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=120, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3333
accuracy on clean test nodes: 0.8625
Overall ASR: 0.2672
Flip ASR: 0.0972/1554 nodes
Overall ASR: 0.2674 (GraphSage model, Seed: 338)
Overall Clean Accuracy: 0.8604
Total Overall ASR: 0.2645 
Total Clean Accuracy: 0.8452
