nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:40
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.0969727039337158
acc_val: 0.4039
Epoch 10, training loss: 1.0288712978363037
acc_val: 0.6398
Epoch 20, training loss: 0.8768908977508545
acc_val: 0.6768
Epoch 30, training loss: 0.6742267608642578
acc_val: 0.7012
Epoch 40, training loss: 0.5647497177124023
acc_val: 0.8382
Epoch 50, training loss: 0.48399069905281067
acc_val: 0.8534
Epoch 60, training loss: 0.4659076929092407
acc_val: 0.8590
Epoch 70, training loss: 0.41182130575180054
acc_val: 0.8666
Epoch 80, training loss: 0.3886343240737915
acc_val: 0.8671
Epoch 90, training loss: 0.3762364089488983
acc_val: 0.8711
Epoch 100, training loss: 0.3614898920059204
acc_val: 0.8671
Epoch 110, training loss: 0.3478553891181946
acc_val: 0.8732
Epoch 120, training loss: 0.344593346118927
acc_val: 0.8737
Epoch 130, training loss: 0.3361172378063202
acc_val: 0.8737
Epoch 140, training loss: 0.33280423283576965
acc_val: 0.8742
Epoch 150, training loss: 0.3275914788246155
acc_val: 0.8777
Epoch 160, training loss: 0.32874298095703125
acc_val: 0.8752
Epoch 170, training loss: 0.30834898352622986
acc_val: 0.8737
Epoch 180, training loss: 0.29875051975250244
acc_val: 0.8747
Epoch 190, training loss: 0.300942063331604
acc_val: 0.8772
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 1.7344s
Encoder CA on clean test nodes: 0.8544
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_1.txt
[ 5104. 15916. 14578. ...  4058.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_2.txt
[11009.  2782. 11343. ...  8626. 15548.  1205.]
idx_attach: tensor([ 5104, 15916, 14578,  9040, 14315, 14910,  7647,  7098, 11534,  7803,
        10837, 18637, 19544,   821,  4899, 18597, 14851,  9145, 13907, 10814,
        11009,  2782, 11343, 14528, 19272,  6196, 16600, 17595, 17660,  9488,
         2471,  3489,  7324, 19307,  7825,   688,  2799,  6114,  4498, 13749],
       device='cuda:1')
tensor([    1,     2,     3,  ..., 19712, 19714, 19716], device='cuda:1')
Epoch 0, loss_inner: 1.09870, loss_target: 1.08898, homo loss: 0.00000 
acc_train_clean: 0.3190, ASR_train_attach: 0.9000, ASR_train_outter: 0.1268
Epoch 10, loss_inner: 0.96888, loss_target: 0.86375, homo loss: 0.00000 
acc_train_clean: 0.6566, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 20, loss_inner: 0.83616, loss_target: 0.74669, homo loss: 0.00000 
acc_train_clean: 0.7705, ASR_train_attach: 0.9750, ASR_train_outter: 0.9909
Epoch 30, loss_inner: 0.70261, loss_target: 0.64919, homo loss: 0.00000 
acc_train_clean: 0.8212, ASR_train_attach: 0.9750, ASR_train_outter: 0.9891
Epoch 40, loss_inner: 0.59849, loss_target: 0.54818, homo loss: 0.00000 
acc_train_clean: 0.8395, ASR_train_attach: 0.9250, ASR_train_outter: 0.9728
Epoch 50, loss_inner: 0.53334, loss_target: 0.54513, homo loss: 0.00000 
acc_train_clean: 0.8455, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 60, loss_inner: 0.50018, loss_target: 0.47403, homo loss: 0.00000 
acc_train_clean: 0.8547, ASR_train_attach: 0.8250, ASR_train_outter: 0.9076
Epoch 70, loss_inner: 0.47029, loss_target: 0.44384, homo loss: 0.00000 
acc_train_clean: 0.8567, ASR_train_attach: 0.9250, ASR_train_outter: 0.9692
Epoch 80, loss_inner: 0.44545, loss_target: 0.41276, homo loss: 0.00000 
acc_train_clean: 0.8628, ASR_train_attach: 0.9000, ASR_train_outter: 0.9620
Epoch 90, loss_inner: 0.42716, loss_target: 0.39235, homo loss: 0.00000 
acc_train_clean: 0.8671, ASR_train_attach: 0.9750, ASR_train_outter: 0.9692
Epoch 100, loss_inner: 0.41386, loss_target: 0.40182, homo loss: 0.00000 
acc_train_clean: 0.8681, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 110, loss_inner: 0.40249, loss_target: 0.37490, homo loss: 0.00000 
acc_train_clean: 0.8717, ASR_train_attach: 0.9250, ASR_train_outter: 0.9710
Epoch 120, loss_inner: 0.39328, loss_target: 0.36163, homo loss: 0.00000 
acc_train_clean: 0.8727, ASR_train_attach: 0.9750, ASR_train_outter: 0.9746
Epoch 130, loss_inner: 0.38819, loss_target: 0.40698, homo loss: 0.00000 
acc_train_clean: 0.8734, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 140, loss_inner: 0.38187, loss_target: 0.36420, homo loss: 0.00000 
acc_train_clean: 0.8765, ASR_train_attach: 0.8500, ASR_train_outter: 0.9004
Epoch 150, loss_inner: 0.37346, loss_target: 0.34842, homo loss: 0.00000 
acc_train_clean: 0.8773, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 160, loss_inner: 0.37051, loss_target: 0.37129, homo loss: 0.00000 
acc_train_clean: 0.8785, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 170, loss_inner: 0.36721, loss_target: 0.34325, homo loss: 0.00000 
acc_train_clean: 0.8803, ASR_train_attach: 0.8750, ASR_train_outter: 0.9493
Epoch 180, loss_inner: 0.36367, loss_target: 0.34245, homo loss: 0.00000 
acc_train_clean: 0.8808, ASR_train_attach: 0.8500, ASR_train_outter: 0.9275
Epoch 190, loss_inner: 0.35784, loss_target: 0.32872, homo loss: 0.00000 
acc_train_clean: 0.8838, ASR_train_attach: 0.9000, ASR_train_outter: 0.9728
Epoch 200, loss_inner: 0.35475, loss_target: 0.32292, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 210, loss_inner: 0.35400, loss_target: 0.35798, homo loss: 0.00000 
acc_train_clean: 0.8800, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 220, loss_inner: 0.38640, loss_target: 0.34052, homo loss: 0.00000 
acc_train_clean: 0.8755, ASR_train_attach: 0.4250, ASR_train_outter: 0.9620
Epoch 230, loss_inner: 0.42496, loss_target: 0.78189, homo loss: 0.00000 
acc_train_clean: 0.8623, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 240, loss_inner: 0.37978, loss_target: 0.56395, homo loss: 0.00000 
acc_train_clean: 0.8701, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 250, loss_inner: 0.35484, loss_target: 0.34434, homo loss: 0.00000 
acc_train_clean: 0.8785, ASR_train_attach: 0.9250, ASR_train_outter: 0.9728
Epoch 260, loss_inner: 0.34942, loss_target: 0.32800, homo loss: 0.00000 
acc_train_clean: 0.8818, ASR_train_attach: 0.8750, ASR_train_outter: 0.9638
Epoch 270, loss_inner: 0.34469, loss_target: 0.31677, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 0.9750, ASR_train_outter: 0.9783
Epoch 280, loss_inner: 0.34206, loss_target: 0.31495, homo loss: 0.00000 
acc_train_clean: 0.8833, ASR_train_attach: 0.9750, ASR_train_outter: 0.9728
Epoch 290, loss_inner: 0.33979, loss_target: 0.31144, homo loss: 0.00000 
acc_train_clean: 0.8849, ASR_train_attach: 0.9250, ASR_train_outter: 0.9656
Epoch 300, loss_inner: 0.33804, loss_target: 0.30773, homo loss: 0.00000 
acc_train_clean: 0.8879, ASR_train_attach: 0.9500, ASR_train_outter: 0.9674
Epoch 310, loss_inner: 0.33685, loss_target: 0.31390, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 320, loss_inner: 0.33512, loss_target: 0.30478, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 330, loss_inner: 0.33332, loss_target: 0.30057, homo loss: 0.00000 
acc_train_clean: 0.8866, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 340, loss_inner: 0.33280, loss_target: 0.30693, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 350, loss_inner: 0.38460, loss_target: 0.31156, homo loss: 0.00000 
acc_train_clean: 0.8833, ASR_train_attach: 0.3250, ASR_train_outter: 0.9783
Epoch 360, loss_inner: 0.53331, loss_target: 2.11618, homo loss: 0.00000 
acc_train_clean: 0.8516, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 370, loss_inner: 0.41168, loss_target: 0.66667, homo loss: 0.00000 
acc_train_clean: 0.8562, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 380, loss_inner: 0.38789, loss_target: 0.71741, homo loss: 0.00000 
acc_train_clean: 0.8696, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 390, loss_inner: 0.35061, loss_target: 0.33599, homo loss: 0.00000 
acc_train_clean: 0.8798, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 400, loss_inner: 0.34296, loss_target: 0.30614, homo loss: 0.00000 
acc_train_clean: 0.8831, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 410, loss_inner: 0.33725, loss_target: 0.30028, homo loss: 0.00000 
acc_train_clean: 0.8849, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 420, loss_inner: 0.33349, loss_target: 0.29614, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 430, loss_inner: 0.33107, loss_target: 0.29151, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 440, loss_inner: 0.32934, loss_target: 0.28895, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 450, loss_inner: 0.32787, loss_target: 0.28690, homo loss: 0.00000 
acc_train_clean: 0.8887, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 460, loss_inner: 0.32649, loss_target: 0.28495, homo loss: 0.00000 
acc_train_clean: 0.8887, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 470, loss_inner: 0.32531, loss_target: 0.28363, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 480, loss_inner: 0.32430, loss_target: 0.28256, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 490, loss_inner: 0.32342, loss_target: 0.28207, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 500, loss_inner: 0.32259, loss_target: 0.28080, homo loss: 0.00000 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 510, loss_inner: 0.32185, loss_target: 0.28013, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 520, loss_inner: 0.32119, loss_target: 0.27959, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 530, loss_inner: 0.32057, loss_target: 0.27894, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 540, loss_inner: 0.32006, loss_target: 0.28050, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 550, loss_inner: 0.31948, loss_target: 0.27777, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 560, loss_inner: 0.31899, loss_target: 0.27779, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 570, loss_inner: 0.31852, loss_target: 0.27703, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 580, loss_inner: 0.31809, loss_target: 0.27664, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 590, loss_inner: 0.31769, loss_target: 0.27628, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 600, loss_inner: 0.31732, loss_target: 0.27602, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 610, loss_inner: 0.31696, loss_target: 0.27563, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 620, loss_inner: 0.31662, loss_target: 0.27534, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 630, loss_inner: 0.31631, loss_target: 0.27503, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 640, loss_inner: 0.31601, loss_target: 0.27473, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 650, loss_inner: 0.31574, loss_target: 0.27523, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 660, loss_inner: 0.31548, loss_target: 0.27430, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 670, loss_inner: 0.31522, loss_target: 0.27409, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 680, loss_inner: 0.31498, loss_target: 0.27389, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 690, loss_inner: 0.31476, loss_target: 0.27366, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 700, loss_inner: 0.31458, loss_target: 0.27346, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 710, loss_inner: 0.31446, loss_target: 0.27329, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 720, loss_inner: 0.31421, loss_target: 0.27318, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 730, loss_inner: 0.31401, loss_target: 0.27295, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 740, loss_inner: 0.31385, loss_target: 0.27291, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 750, loss_inner: 0.31368, loss_target: 0.27276, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 760, loss_inner: 0.31354, loss_target: 0.27258, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 770, loss_inner: 0.31351, loss_target: 0.27264, homo loss: 0.00000 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 780, loss_inner: 0.31324, loss_target: 0.27240, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 790, loss_inner: 0.31313, loss_target: 0.27227, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 800, loss_inner: 0.31300, loss_target: 0.27314, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 810, loss_inner: 0.31291, loss_target: 0.27224, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 820, loss_inner: 0.31279, loss_target: 0.27208, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 830, loss_inner: 0.31270, loss_target: 0.27192, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 840, loss_inner: 0.31261, loss_target: 0.27179, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 850, loss_inner: 0.31254, loss_target: 0.27175, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 860, loss_inner: 0.31242, loss_target: 0.27164, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 870, loss_inner: 0.31233, loss_target: 0.27163, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 880, loss_inner: 0.31227, loss_target: 0.27151, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 890, loss_inner: 0.31241, loss_target: 0.27239, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 900, loss_inner: 0.31218, loss_target: 0.27154, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 910, loss_inner: 0.31207, loss_target: 0.27144, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 920, loss_inner: 0.31198, loss_target: 0.27132, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 930, loss_inner: 0.31191, loss_target: 0.27126, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 940, loss_inner: 0.31185, loss_target: 0.27121, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 950, loss_inner: 0.31180, loss_target: 0.27118, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 960, loss_inner: 0.31177, loss_target: 0.27120, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 970, loss_inner: 0.31185, loss_target: 0.27128, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 980, loss_inner: 0.31167, loss_target: 0.27102, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 990, loss_inner: 0.31160, loss_target: 0.27106, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1000, loss_inner: 0.31157, loss_target: 0.27103, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1010, loss_inner: 0.31152, loss_target: 0.27093, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1020, loss_inner: 0.31149, loss_target: 0.27086, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1030, loss_inner: 0.31152, loss_target: 0.27100, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1040, loss_inner: 0.31143, loss_target: 0.27100, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1050, loss_inner: 0.31140, loss_target: 0.27098, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1060, loss_inner: 0.31133, loss_target: 0.27078, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1070, loss_inner: 0.31193, loss_target: 0.27323, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1080, loss_inner: 0.31113, loss_target: 0.27066, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1090, loss_inner: 0.31154, loss_target: 0.27123, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1100, loss_inner: 0.31135, loss_target: 0.27090, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1110, loss_inner: 0.31124, loss_target: 0.27080, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1120, loss_inner: 0.31121, loss_target: 0.27045, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1130, loss_inner: 0.31118, loss_target: 0.27046, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1140, loss_inner: 0.31112, loss_target: 0.27000, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1150, loss_inner: 0.31110, loss_target: 0.27009, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1160, loss_inner: 0.31108, loss_target: 0.27002, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1170, loss_inner: 0.31106, loss_target: 0.27010, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1180, loss_inner: 0.31104, loss_target: 0.26996, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1190, loss_inner: 0.31102, loss_target: 0.26992, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1200, loss_inner: 0.31100, loss_target: 0.26988, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1210, loss_inner: 0.31099, loss_target: 0.26991, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1220, loss_inner: 0.31099, loss_target: 0.26986, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1230, loss_inner: 0.31096, loss_target: 0.27071, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1240, loss_inner: 0.31093, loss_target: 0.27012, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1250, loss_inner: 0.31091, loss_target: 0.26990, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1260, loss_inner: 0.31091, loss_target: 0.26981, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1270, loss_inner: 0.31089, loss_target: 0.26986, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1280, loss_inner: 0.31088, loss_target: 0.26981, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1290, loss_inner: 0.31095, loss_target: 0.26986, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1300, loss_inner: 0.31085, loss_target: 0.27000, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1310, loss_inner: 0.31084, loss_target: 0.26969, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1320, loss_inner: 0.31085, loss_target: 0.26984, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1330, loss_inner: 0.31082, loss_target: 0.26995, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1340, loss_inner: 0.31082, loss_target: 0.26974, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1350, loss_inner: 0.31080, loss_target: 0.26980, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1360, loss_inner: 0.31133, loss_target: 0.27072, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1370, loss_inner: 0.31102, loss_target: 0.27220, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1380, loss_inner: 0.31079, loss_target: 0.26945, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1390, loss_inner: 0.31080, loss_target: 0.26980, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1400, loss_inner: 0.31078, loss_target: 0.26966, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1410, loss_inner: 0.31077, loss_target: 0.26958, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1420, loss_inner: 0.31076, loss_target: 0.26959, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1430, loss_inner: 0.31076, loss_target: 0.26960, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1440, loss_inner: 0.31075, loss_target: 0.26957, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1450, loss_inner: 0.31074, loss_target: 0.26957, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1460, loss_inner: 0.31073, loss_target: 0.26965, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1470, loss_inner: 0.31073, loss_target: 0.26955, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1480, loss_inner: 0.31072, loss_target: 0.26961, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1490, loss_inner: 0.31074, loss_target: 0.26964, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8483
Overall ASR: 0.9975
Flip ASR: 0.9968/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8503
Overall ASR: 0.9924
Flip ASR: 0.9903/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.9939
Flip ASR: 0.9923/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8498
Overall ASR: 0.9965
Flip ASR: 0.9955/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9965
Flip ASR: 0.9955/1554 nodes
Overall ASR: 0.9953 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8501
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8366
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8250
accuracy on clean test nodes: 0.8376
Overall ASR: 0.7855
Flip ASR: 0.7368/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8376
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8422
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8397
Overall ASR: 1.0000
Flip ASR: 1.0000/1554 nodes
Overall ASR: 0.9571 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8388
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8595
Overall ASR: 0.9513
Flip ASR: 0.9395/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8605
Overall ASR: 0.9488
Flip ASR: 0.9369/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8590
Overall ASR: 0.9528
Flip ASR: 0.9408/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9250
accuracy on clean test nodes: 0.8579
Overall ASR: 0.9493
Flip ASR: 0.9376/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=0.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=1500, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9250
accuracy on clean test nodes: 0.8559
Overall ASR: 0.9513
Flip ASR: 0.9389/1554 nodes
Overall ASR: 0.9507 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8585
Total Overall ASR: 0.9677 
Total Clean Accuracy: 0.8491
