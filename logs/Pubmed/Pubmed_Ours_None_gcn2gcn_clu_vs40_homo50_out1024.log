nohup: ignoring input
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.x
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.tx
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.allx
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.y
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.ty
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.ally
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.graph
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.test.index
Processing...
Done!
#Attach Nodes:40
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.0969727039337158
acc_val: 0.4039
Epoch 10, training loss: 1.0288714170455933
acc_val: 0.6398
Epoch 20, training loss: 0.8768908977508545
acc_val: 0.6768
Epoch 30, training loss: 0.6742267608642578
acc_val: 0.7012
Epoch 40, training loss: 0.5647497177124023
acc_val: 0.8382
Epoch 50, training loss: 0.48399069905281067
acc_val: 0.8534
Epoch 60, training loss: 0.4659076929092407
acc_val: 0.8590
Epoch 70, training loss: 0.4118213653564453
acc_val: 0.8666
Epoch 80, training loss: 0.3886343240737915
acc_val: 0.8671
Epoch 90, training loss: 0.3762349784374237
acc_val: 0.8711
Epoch 100, training loss: 0.36148884892463684
acc_val: 0.8671
Epoch 110, training loss: 0.34778904914855957
acc_val: 0.8732
Epoch 120, training loss: 0.3447827100753784
acc_val: 0.8737
Epoch 130, training loss: 0.33630719780921936
acc_val: 0.8737
Epoch 140, training loss: 0.3328453302383423
acc_val: 0.8742
Epoch 150, training loss: 0.3276333808898926
acc_val: 0.8777
Epoch 160, training loss: 0.3284984827041626
acc_val: 0.8762
Epoch 170, training loss: 0.30831700563430786
acc_val: 0.8737
Epoch 180, training loss: 0.2987300157546997
acc_val: 0.8752
Epoch 190, training loss: 0.3011932373046875
acc_val: 0.8782
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 1.9150s
Encoder CA on clean test nodes: 0.8544
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_1.txt
[ 5104. 15916. 14578. ...  4058.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_2.txt
[11009.  2782. 11343. ...  8626. 15548.  1205.]
idx_attach: tensor([ 5104, 15916, 14578,  9040, 14315, 14910,  7647,  7098, 11534,  7803,
        10837, 18637, 19544,   821,  4899, 18597, 14851,  9145, 13907, 10814,
        11009,  2782, 11343, 14528, 19272,  6196, 16600, 17595, 17660,  9488,
         2471,  3489,  7324, 19307,  7825,   688,  2799,  6114,  4498, 13749],
       device='cuda:1')
tensor([    1,     2,     3,  ..., 19712, 19714, 19716], device='cuda:1')
Epoch 0, loss_inner: 1.09870, loss_target: 1.09145, homo loss: 0.48566 
acc_train_clean: 0.3190, ASR_train_attach: 0.9000, ASR_train_outter: 0.1447
Epoch 10, loss_inner: 0.97801, loss_target: 0.79191, homo loss: 0.20409 
acc_train_clean: 0.6627, ASR_train_attach: 1.0000, ASR_train_outter: 0.9953
Epoch 20, loss_inner: 0.87307, loss_target: 0.82962, homo loss: 0.07718 
acc_train_clean: 0.7548, ASR_train_attach: 0.4750, ASR_train_outter: 0.7143
Epoch 30, loss_inner: 0.73284, loss_target: 0.61190, homo loss: 0.00254 
acc_train_clean: 0.8024, ASR_train_attach: 0.8500, ASR_train_outter: 0.9229
Epoch 40, loss_inner: 0.60588, loss_target: 0.51212, homo loss: 0.00003 
acc_train_clean: 0.8379, ASR_train_attach: 0.9000, ASR_train_outter: 0.9521
Epoch 50, loss_inner: 0.52501, loss_target: 0.44591, homo loss: 0.00000 
acc_train_clean: 0.8468, ASR_train_attach: 0.9250, ASR_train_outter: 0.9652
Epoch 60, loss_inner: 0.48184, loss_target: 0.46604, homo loss: 0.03187 
acc_train_clean: 0.8542, ASR_train_attach: 1.0000, ASR_train_outter: 0.9972
Epoch 70, loss_inner: 0.46107, loss_target: 0.40961, homo loss: 0.00072 
acc_train_clean: 0.8618, ASR_train_attach: 0.9250, ASR_train_outter: 0.9812
Epoch 80, loss_inner: 0.44212, loss_target: 0.38601, homo loss: 0.00001 
acc_train_clean: 0.8623, ASR_train_attach: 0.9000, ASR_train_outter: 0.9727
Epoch 90, loss_inner: 0.42334, loss_target: 0.36273, homo loss: 0.00001 
acc_train_clean: 0.8669, ASR_train_attach: 0.9000, ASR_train_outter: 0.9662
Epoch 100, loss_inner: 0.40884, loss_target: 0.34738, homo loss: 0.00000 
acc_train_clean: 0.8707, ASR_train_attach: 0.9750, ASR_train_outter: 0.9765
Epoch 110, loss_inner: 0.39921, loss_target: 0.33767, homo loss: 0.00000 
acc_train_clean: 0.8722, ASR_train_attach: 0.9000, ASR_train_outter: 0.9718
Epoch 120, loss_inner: 0.39178, loss_target: 0.33803, homo loss: 0.00000 
acc_train_clean: 0.8750, ASR_train_attach: 0.8750, ASR_train_outter: 0.9539
Epoch 130, loss_inner: 0.39402, loss_target: 0.53291, homo loss: 0.08749 
acc_train_clean: 0.8732, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 140, loss_inner: 0.39110, loss_target: 0.39045, homo loss: 0.00019 
acc_train_clean: 0.8762, ASR_train_attach: 0.7500, ASR_train_outter: 0.8496
Epoch 150, loss_inner: 0.37972, loss_target: 0.34463, homo loss: 0.00000 
acc_train_clean: 0.8793, ASR_train_attach: 0.9000, ASR_train_outter: 0.9521
Epoch 160, loss_inner: 0.36988, loss_target: 0.32335, homo loss: 0.00000 
acc_train_clean: 0.8816, ASR_train_attach: 0.8750, ASR_train_outter: 0.9690
Epoch 170, loss_inner: 0.36469, loss_target: 0.31161, homo loss: 0.00000 
acc_train_clean: 0.8818, ASR_train_attach: 0.9500, ASR_train_outter: 0.9718
Epoch 180, loss_inner: 0.36146, loss_target: 0.30589, homo loss: 0.00003 
acc_train_clean: 0.8846, ASR_train_attach: 0.9750, ASR_train_outter: 0.9784
Epoch 190, loss_inner: 0.35835, loss_target: 0.30299, homo loss: 0.00001 
acc_train_clean: 0.8851, ASR_train_attach: 0.9250, ASR_train_outter: 0.9727
Epoch 200, loss_inner: 0.36816, loss_target: 0.39917, homo loss: 0.00001 
acc_train_clean: 0.8790, ASR_train_attach: 0.6250, ASR_train_outter: 0.7820
Epoch 210, loss_inner: 0.36275, loss_target: 0.34111, homo loss: 0.00034 
acc_train_clean: 0.8800, ASR_train_attach: 1.0000, ASR_train_outter: 0.9906
Epoch 220, loss_inner: 0.35157, loss_target: 0.31598, homo loss: 0.00001 
acc_train_clean: 0.8818, ASR_train_attach: 1.0000, ASR_train_outter: 0.9784
Epoch 230, loss_inner: 0.34733, loss_target: 0.29852, homo loss: 0.00000 
acc_train_clean: 0.8859, ASR_train_attach: 0.9250, ASR_train_outter: 0.9633
Epoch 240, loss_inner: 0.34609, loss_target: 0.29154, homo loss: 0.00001 
acc_train_clean: 0.8859, ASR_train_attach: 0.9750, ASR_train_outter: 0.9812
Epoch 250, loss_inner: 0.34452, loss_target: 0.29176, homo loss: 0.00000 
acc_train_clean: 0.8866, ASR_train_attach: 0.9250, ASR_train_outter: 0.9765
Epoch 260, loss_inner: 0.34227, loss_target: 0.28764, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 0.9750, ASR_train_outter: 0.9774
Epoch 270, loss_inner: 0.34683, loss_target: 0.32724, homo loss: 0.00756 
acc_train_clean: 0.8841, ASR_train_attach: 0.8500, ASR_train_outter: 0.9840
Epoch 280, loss_inner: 0.34721, loss_target: 0.31915, homo loss: 0.00408 
acc_train_clean: 0.8884, ASR_train_attach: 0.9500, ASR_train_outter: 0.9521
Epoch 290, loss_inner: 0.34060, loss_target: 0.30674, homo loss: 0.00001 
acc_train_clean: 0.8869, ASR_train_attach: 0.9250, ASR_train_outter: 0.9737
Epoch 300, loss_inner: 0.33655, loss_target: 0.29313, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 0.9500, ASR_train_outter: 0.9624
Epoch 310, loss_inner: 0.33519, loss_target: 0.28254, homo loss: 0.00000 
acc_train_clean: 0.8889, ASR_train_attach: 0.9750, ASR_train_outter: 0.9840
Epoch 320, loss_inner: 0.33388, loss_target: 0.28742, homo loss: 0.00001 
acc_train_clean: 0.8887, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 330, loss_inner: 0.33279, loss_target: 0.27752, homo loss: 0.00001 
acc_train_clean: 0.8884, ASR_train_attach: 0.9750, ASR_train_outter: 0.9878
Epoch 340, loss_inner: 0.33113, loss_target: 0.27968, homo loss: 0.00014 
acc_train_clean: 0.8889, ASR_train_attach: 0.9750, ASR_train_outter: 0.9953
Epoch 350, loss_inner: 0.34094, loss_target: 0.42578, homo loss: 0.11196 
acc_train_clean: 0.8826, ASR_train_attach: 0.9750, ASR_train_outter: 0.9944
Epoch 360, loss_inner: 0.35889, loss_target: 0.32901, homo loss: 0.00028 
acc_train_clean: 0.8788, ASR_train_attach: 0.8500, ASR_train_outter: 0.9492
Epoch 370, loss_inner: 0.34158, loss_target: 0.31336, homo loss: 0.00000 
acc_train_clean: 0.8844, ASR_train_attach: 0.9250, ASR_train_outter: 0.9680
Epoch 380, loss_inner: 0.33140, loss_target: 0.29247, homo loss: 0.00001 
acc_train_clean: 0.8864, ASR_train_attach: 0.9500, ASR_train_outter: 0.9718
Epoch 390, loss_inner: 0.32821, loss_target: 0.27689, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 400, loss_inner: 0.32726, loss_target: 0.27156, homo loss: 0.00001 
acc_train_clean: 0.8887, ASR_train_attach: 0.9750, ASR_train_outter: 0.9906
Epoch 410, loss_inner: 0.32666, loss_target: 0.27448, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 0.9250, ASR_train_outter: 0.9718
Epoch 420, loss_inner: 0.32481, loss_target: 0.26893, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9915
Epoch 430, loss_inner: 0.34978, loss_target: 0.47947, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 0.4000, ASR_train_outter: 0.6645
Epoch 440, loss_inner: 0.33970, loss_target: 0.31593, homo loss: 0.00404 
acc_train_clean: 0.8841, ASR_train_attach: 0.8250, ASR_train_outter: 0.9370
Epoch 450, loss_inner: 0.33797, loss_target: 0.34503, homo loss: 0.00000 
acc_train_clean: 0.8864, ASR_train_attach: 0.8000, ASR_train_outter: 0.8684
Epoch 460, loss_inner: 0.32699, loss_target: 0.29479, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 0.9250, ASR_train_outter: 0.9662
Epoch 470, loss_inner: 0.32444, loss_target: 0.28227, homo loss: 0.00001 
acc_train_clean: 0.8899, ASR_train_attach: 0.9500, ASR_train_outter: 0.9756
Epoch 480, loss_inner: 0.32327, loss_target: 0.27143, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9868
Epoch 490, loss_inner: 0.32165, loss_target: 0.26741, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 500, loss_inner: 0.32116, loss_target: 0.26754, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 0.9250, ASR_train_outter: 0.9821
Epoch 510, loss_inner: 0.32192, loss_target: 0.28675, homo loss: 0.00000 
acc_train_clean: 0.8882, ASR_train_attach: 0.9750, ASR_train_outter: 0.9727
Epoch 520, loss_inner: 0.33732, loss_target: 0.33499, homo loss: 0.00006 
acc_train_clean: 0.8816, ASR_train_attach: 1.0000, ASR_train_outter: 0.9859
Epoch 530, loss_inner: 0.33368, loss_target: 0.31455, homo loss: 0.00003 
acc_train_clean: 0.8854, ASR_train_attach: 0.8750, ASR_train_outter: 0.9633
Epoch 540, loss_inner: 0.32586, loss_target: 0.29623, homo loss: 0.00001 
acc_train_clean: 0.8874, ASR_train_attach: 0.9000, ASR_train_outter: 0.9615
Epoch 550, loss_inner: 0.32223, loss_target: 0.28357, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 0.9000, ASR_train_outter: 0.9633
Epoch 560, loss_inner: 0.32075, loss_target: 0.27086, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9793
Epoch 570, loss_inner: 0.31931, loss_target: 0.26869, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9750, ASR_train_outter: 0.9915
Epoch 580, loss_inner: 0.31842, loss_target: 0.26667, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 0.9750, ASR_train_outter: 0.9925
Epoch 590, loss_inner: 0.32346, loss_target: 0.34028, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 0.7250, ASR_train_outter: 0.8524
Epoch 600, loss_inner: 0.33651, loss_target: 0.31512, homo loss: 0.00331 
acc_train_clean: 0.8854, ASR_train_attach: 1.0000, ASR_train_outter: 0.9662
Epoch 610, loss_inner: 0.33596, loss_target: 0.31040, homo loss: 0.00000 
acc_train_clean: 0.8846, ASR_train_attach: 0.9500, ASR_train_outter: 0.9633
Epoch 620, loss_inner: 0.32381, loss_target: 0.29593, homo loss: 0.00000 
acc_train_clean: 0.8884, ASR_train_attach: 0.9500, ASR_train_outter: 0.9727
Epoch 630, loss_inner: 0.32098, loss_target: 0.28087, homo loss: 0.00002 
acc_train_clean: 0.8892, ASR_train_attach: 0.9500, ASR_train_outter: 0.9690
Epoch 640, loss_inner: 0.32014, loss_target: 0.27415, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 0.9500, ASR_train_outter: 0.9718
Epoch 650, loss_inner: 0.31896, loss_target: 0.29034, homo loss: 0.00012 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9972
Epoch 660, loss_inner: 0.31843, loss_target: 0.30738, homo loss: 0.00025 
acc_train_clean: 0.8912, ASR_train_attach: 0.9750, ASR_train_outter: 0.9991
Epoch 670, loss_inner: 0.31763, loss_target: 0.27140, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9750, ASR_train_outter: 0.9850
Epoch 680, loss_inner: 0.31754, loss_target: 0.27155, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 0.9500, ASR_train_outter: 0.9831
Epoch 690, loss_inner: 0.41242, loss_target: 2.11688, homo loss: 0.23143 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 700, loss_inner: 0.33283, loss_target: 0.31554, homo loss: 0.09820 
acc_train_clean: 0.8882, ASR_train_attach: 0.8250, ASR_train_outter: 0.9201
Epoch 710, loss_inner: 0.32877, loss_target: 0.29975, homo loss: 0.00120 
acc_train_clean: 0.8909, ASR_train_attach: 0.8500, ASR_train_outter: 0.9596
Epoch 720, loss_inner: 0.32195, loss_target: 0.30100, homo loss: 0.00004 
acc_train_clean: 0.8925, ASR_train_attach: 0.9000, ASR_train_outter: 0.9596
Epoch 730, loss_inner: 0.31901, loss_target: 0.29213, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9500, ASR_train_outter: 0.9784
Epoch 740, loss_inner: 0.31771, loss_target: 0.28006, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9718
Epoch 750, loss_inner: 0.31697, loss_target: 0.27464, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9756
Epoch 760, loss_inner: 0.31679, loss_target: 0.27178, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 0.9500, ASR_train_outter: 0.9699
Epoch 770, loss_inner: 0.31637, loss_target: 0.26929, homo loss: 0.00001 
acc_train_clean: 0.8937, ASR_train_attach: 0.9500, ASR_train_outter: 0.9756
Epoch 780, loss_inner: 0.31594, loss_target: 0.28216, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9709
Epoch 790, loss_inner: 0.31834, loss_target: 0.35682, homo loss: 0.00502 
acc_train_clean: 0.8904, ASR_train_attach: 0.9750, ASR_train_outter: 0.9887
Epoch 800, loss_inner: 0.35250, loss_target: 0.49516, homo loss: 0.00104 
acc_train_clean: 0.8937, ASR_train_attach: 0.3500, ASR_train_outter: 0.6908
Epoch 810, loss_inner: 0.32850, loss_target: 0.29620, homo loss: 0.00006 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9756
Epoch 820, loss_inner: 0.32020, loss_target: 0.29399, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9000, ASR_train_outter: 0.9615
Epoch 830, loss_inner: 0.31826, loss_target: 0.28153, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 0.9000, ASR_train_outter: 0.9511
Epoch 840, loss_inner: 0.31689, loss_target: 0.27082, homo loss: 0.00001 
acc_train_clean: 0.8925, ASR_train_attach: 0.9750, ASR_train_outter: 0.9840
Epoch 850, loss_inner: 0.31606, loss_target: 0.26795, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 0.9750, ASR_train_outter: 0.9850
Epoch 860, loss_inner: 0.31546, loss_target: 0.26590, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9750, ASR_train_outter: 0.9812
Epoch 870, loss_inner: 0.31521, loss_target: 0.26510, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.9750, ASR_train_outter: 0.9821
Epoch 880, loss_inner: 0.31507, loss_target: 0.26446, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9831
Epoch 890, loss_inner: 0.31498, loss_target: 0.26422, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9500, ASR_train_outter: 0.9812
Epoch 900, loss_inner: 0.31671, loss_target: 0.28300, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.8250, ASR_train_outter: 0.9173
Epoch 910, loss_inner: 0.34228, loss_target: 0.74650, homo loss: 0.17043 
acc_train_clean: 0.8864, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 920, loss_inner: 0.32992, loss_target: 0.34173, homo loss: 0.01210 
acc_train_clean: 0.8902, ASR_train_attach: 0.6750, ASR_train_outter: 0.8806
Epoch 930, loss_inner: 0.32209, loss_target: 0.32378, homo loss: 0.00057 
acc_train_clean: 0.8894, ASR_train_attach: 0.9500, ASR_train_outter: 0.9737
Epoch 940, loss_inner: 0.31793, loss_target: 0.29311, homo loss: 0.00002 
acc_train_clean: 0.8922, ASR_train_attach: 0.9500, ASR_train_outter: 0.9746
Epoch 950, loss_inner: 0.31590, loss_target: 0.28500, homo loss: 0.00001 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9652
Epoch 960, loss_inner: 0.31481, loss_target: 0.27736, homo loss: 0.00001 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9821
Epoch 970, loss_inner: 0.31454, loss_target: 0.27020, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9793
Epoch 980, loss_inner: 0.31419, loss_target: 0.26601, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9868
Epoch 990, loss_inner: 0.31381, loss_target: 0.26409, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9750, ASR_train_outter: 0.9878
Epoch 1000, loss_inner: 0.31360, loss_target: 0.26280, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9878
Epoch 1010, loss_inner: 0.31347, loss_target: 0.26176, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9868
Epoch 1020, loss_inner: 0.31340, loss_target: 0.26101, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9868
Epoch 1030, loss_inner: 0.31332, loss_target: 0.26064, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1040, loss_inner: 0.31336, loss_target: 0.26083, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 0.9500, ASR_train_outter: 0.9840
Epoch 1050, loss_inner: 0.31466, loss_target: 0.27885, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 0.8500, ASR_train_outter: 0.9211
Epoch 1060, loss_inner: 0.32271, loss_target: 0.31907, homo loss: 0.00105 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9953
Epoch 1070, loss_inner: 0.32769, loss_target: 0.31740, homo loss: 0.00047 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9765
Epoch 1080, loss_inner: 0.31853, loss_target: 0.30265, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 0.9250, ASR_train_outter: 0.9699
Epoch 1090, loss_inner: 0.31525, loss_target: 0.28558, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9500, ASR_train_outter: 0.9596
Epoch 1100, loss_inner: 0.31500, loss_target: 0.27076, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 0.9500, ASR_train_outter: 0.9784
Epoch 1110, loss_inner: 0.31405, loss_target: 0.26583, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1120, loss_inner: 0.31309, loss_target: 0.26332, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9750, ASR_train_outter: 0.9840
Epoch 1130, loss_inner: 0.31286, loss_target: 0.26214, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1140, loss_inner: 0.31288, loss_target: 0.26120, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9887
Epoch 1150, loss_inner: 0.31281, loss_target: 0.26064, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 0.9750, ASR_train_outter: 0.9887
Epoch 1160, loss_inner: 0.31276, loss_target: 0.26041, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 0.9750, ASR_train_outter: 0.9878
Epoch 1170, loss_inner: 0.31270, loss_target: 0.26023, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1180, loss_inner: 0.31264, loss_target: 0.25994, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9868
Epoch 1190, loss_inner: 0.31257, loss_target: 0.25972, homo loss: 0.00002 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9868
Epoch 1200, loss_inner: 0.31238, loss_target: 0.25956, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1210, loss_inner: 0.31222, loss_target: 0.25938, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1220, loss_inner: 0.31196, loss_target: 0.26681, homo loss: 0.00006 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9878
Epoch 1230, loss_inner: 0.33848, loss_target: 0.34396, homo loss: 0.03907 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9972
Epoch 1240, loss_inner: 0.33655, loss_target: 0.33112, homo loss: 0.00502 
acc_train_clean: 0.8907, ASR_train_attach: 0.9000, ASR_train_outter: 0.9765
Epoch 1250, loss_inner: 0.32744, loss_target: 0.31807, homo loss: 0.00019 
acc_train_clean: 0.8894, ASR_train_attach: 0.8750, ASR_train_outter: 0.9455
Epoch 1260, loss_inner: 0.32063, loss_target: 0.29875, homo loss: 0.00001 
acc_train_clean: 0.8917, ASR_train_attach: 0.9250, ASR_train_outter: 0.9549
Epoch 1270, loss_inner: 0.31848, loss_target: 0.28894, homo loss: 0.00001 
acc_train_clean: 0.8925, ASR_train_attach: 0.8750, ASR_train_outter: 0.9586
Epoch 1280, loss_inner: 0.31626, loss_target: 0.27962, homo loss: 0.00001 
acc_train_clean: 0.8927, ASR_train_attach: 0.9500, ASR_train_outter: 0.9690
Epoch 1290, loss_inner: 0.31509, loss_target: 0.27380, homo loss: 0.00001 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9727
Epoch 1300, loss_inner: 0.31438, loss_target: 0.26914, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9765
Epoch 1310, loss_inner: 0.31397, loss_target: 0.26639, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9821
Epoch 1320, loss_inner: 0.31374, loss_target: 0.26563, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.9500, ASR_train_outter: 0.9840
Epoch 1330, loss_inner: 0.31411, loss_target: 0.27028, homo loss: 0.00002 
acc_train_clean: 0.8940, ASR_train_attach: 0.9250, ASR_train_outter: 0.9624
Epoch 1340, loss_inner: 0.31418, loss_target: 0.27101, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9250, ASR_train_outter: 0.9690
Epoch 1350, loss_inner: 0.31395, loss_target: 0.26547, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9500, ASR_train_outter: 0.9859
Epoch 1360, loss_inner: 0.31337, loss_target: 0.26751, homo loss: 0.00001 
acc_train_clean: 0.8925, ASR_train_attach: 0.9500, ASR_train_outter: 0.9746
Epoch 1370, loss_inner: 0.31284, loss_target: 0.28793, homo loss: 0.00024 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 1380, loss_inner: 0.31838, loss_target: 0.30548, homo loss: 0.00020 
acc_train_clean: 0.8968, ASR_train_attach: 0.8000, ASR_train_outter: 0.8665
Epoch 1390, loss_inner: 0.31425, loss_target: 0.28259, homo loss: 0.00041 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9915
Epoch 1400, loss_inner: 0.31420, loss_target: 0.28621, homo loss: 0.00010 
acc_train_clean: 0.8935, ASR_train_attach: 0.9250, ASR_train_outter: 0.9737
Epoch 1410, loss_inner: 0.31340, loss_target: 0.26410, homo loss: 0.00001 
acc_train_clean: 0.8940, ASR_train_attach: 0.9750, ASR_train_outter: 0.9840
Epoch 1420, loss_inner: 0.31326, loss_target: 0.26329, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 0.9500, ASR_train_outter: 0.9831
Epoch 1430, loss_inner: 0.31249, loss_target: 0.25992, homo loss: 0.00001 
acc_train_clean: 0.8955, ASR_train_attach: 0.9750, ASR_train_outter: 0.9915
Epoch 1440, loss_inner: 0.31181, loss_target: 0.26518, homo loss: 0.00003 
acc_train_clean: 0.8953, ASR_train_attach: 1.0000, ASR_train_outter: 0.9962
Epoch 1450, loss_inner: 0.34262, loss_target: 0.68972, homo loss: 0.06738 
acc_train_clean: 0.8808, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 1460, loss_inner: 0.33216, loss_target: 0.34387, homo loss: 0.00022 
acc_train_clean: 0.8861, ASR_train_attach: 0.9750, ASR_train_outter: 0.9981
Epoch 1470, loss_inner: 0.32433, loss_target: 0.31947, homo loss: 0.00003 
acc_train_clean: 0.8899, ASR_train_attach: 0.8000, ASR_train_outter: 0.9107
Epoch 1480, loss_inner: 0.31711, loss_target: 0.28585, homo loss: 0.00001 
acc_train_clean: 0.8937, ASR_train_attach: 0.9500, ASR_train_outter: 0.9699
Epoch 1490, loss_inner: 0.31552, loss_target: 0.27047, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9500, ASR_train_outter: 0.9765
Epoch 1500, loss_inner: 0.31477, loss_target: 0.26531, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9500, ASR_train_outter: 0.9850
Epoch 1510, loss_inner: 0.31402, loss_target: 0.26341, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 0.9500, ASR_train_outter: 0.9868
Epoch 1520, loss_inner: 0.31315, loss_target: 0.26673, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9944
Epoch 1530, loss_inner: 0.31307, loss_target: 0.28102, homo loss: 0.00011 
acc_train_clean: 0.8953, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1540, loss_inner: 0.31453, loss_target: 0.29041, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9000, ASR_train_outter: 0.9549
Epoch 1550, loss_inner: 0.31406, loss_target: 0.27491, homo loss: 0.00034 
acc_train_clean: 0.8942, ASR_train_attach: 0.9000, ASR_train_outter: 0.9756
Epoch 1560, loss_inner: 0.31552, loss_target: 0.30590, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 0.8500, ASR_train_outter: 0.9530
Epoch 1570, loss_inner: 0.31354, loss_target: 0.26918, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.9750, ASR_train_outter: 0.9784
Epoch 1580, loss_inner: 0.31342, loss_target: 0.26566, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 0.9500, ASR_train_outter: 0.9709
Epoch 1590, loss_inner: 0.33413, loss_target: 0.46962, homo loss: 0.00093 
acc_train_clean: 0.8945, ASR_train_attach: 0.3250, ASR_train_outter: 0.5968
Epoch 1600, loss_inner: 0.32327, loss_target: 0.37271, homo loss: 0.00161 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9991
Epoch 1610, loss_inner: 0.32122, loss_target: 0.28926, homo loss: 0.00003 
acc_train_clean: 0.8922, ASR_train_attach: 0.9750, ASR_train_outter: 0.9803
Epoch 1620, loss_inner: 0.31618, loss_target: 0.28274, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9500, ASR_train_outter: 0.9774
Epoch 1630, loss_inner: 0.31525, loss_target: 0.27075, homo loss: 0.00001 
acc_train_clean: 0.8948, ASR_train_attach: 0.9500, ASR_train_outter: 0.9699
Epoch 1640, loss_inner: 0.31419, loss_target: 0.26252, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9750, ASR_train_outter: 0.9859
Epoch 1650, loss_inner: 0.31386, loss_target: 0.26894, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.9500, ASR_train_outter: 0.9633
Epoch 1660, loss_inner: 0.31263, loss_target: 0.27213, homo loss: 0.00003 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9981
Epoch 1670, loss_inner: 0.31291, loss_target: 0.26594, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 0.9750, ASR_train_outter: 0.9756
Epoch 1680, loss_inner: 0.31432, loss_target: 0.28581, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 0.8500, ASR_train_outter: 0.9333
Epoch 1690, loss_inner: 0.32730, loss_target: 0.44036, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 0.4250, ASR_train_outter: 0.6917
Epoch 1700, loss_inner: 0.32164, loss_target: 0.49237, homo loss: 0.01443 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1710, loss_inner: 0.32191, loss_target: 0.28826, homo loss: 0.00064 
acc_train_clean: 0.8920, ASR_train_attach: 0.9000, ASR_train_outter: 0.9652
Epoch 1720, loss_inner: 0.31885, loss_target: 0.29835, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 0.9250, ASR_train_outter: 0.9342
Epoch 1730, loss_inner: 0.31446, loss_target: 0.26903, homo loss: 0.00002 
acc_train_clean: 0.8925, ASR_train_attach: 0.9750, ASR_train_outter: 0.9850
Epoch 1740, loss_inner: 0.31397, loss_target: 0.26307, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9944
Epoch 1750, loss_inner: 0.31300, loss_target: 0.25740, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 0.9750, ASR_train_outter: 0.9897
Epoch 1760, loss_inner: 0.31238, loss_target: 0.25579, homo loss: 0.00001 
acc_train_clean: 0.8948, ASR_train_attach: 0.9750, ASR_train_outter: 0.9906
Epoch 1770, loss_inner: 0.31239, loss_target: 0.25572, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9897
Epoch 1780, loss_inner: 0.31245, loss_target: 0.25608, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 0.9750, ASR_train_outter: 0.9897
Epoch 1790, loss_inner: 0.31248, loss_target: 0.25657, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9878
Epoch 1800, loss_inner: 0.31236, loss_target: 0.25737, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 0.9750, ASR_train_outter: 0.9925
Epoch 1810, loss_inner: 0.31445, loss_target: 0.36107, homo loss: 0.00481 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1820, loss_inner: 0.33053, loss_target: 0.31893, homo loss: 0.00613 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9972
Epoch 1830, loss_inner: 0.34181, loss_target: 0.31777, homo loss: 0.00012 
acc_train_clean: 0.8859, ASR_train_attach: 1.0000, ASR_train_outter: 0.9925
Epoch 1840, loss_inner: 0.32244, loss_target: 0.29629, homo loss: 0.00000 
acc_train_clean: 0.8882, ASR_train_attach: 0.9500, ASR_train_outter: 0.9774
Epoch 1850, loss_inner: 0.31903, loss_target: 0.28030, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9727
Epoch 1860, loss_inner: 0.31732, loss_target: 0.27258, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9500, ASR_train_outter: 0.9624
Epoch 1870, loss_inner: 0.31545, loss_target: 0.26692, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9831
Epoch 1880, loss_inner: 0.31445, loss_target: 0.26706, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 0.9750, ASR_train_outter: 0.9821
Epoch 1890, loss_inner: 0.31558, loss_target: 0.28449, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 0.8750, ASR_train_outter: 0.9201
Epoch 1900, loss_inner: 0.31450, loss_target: 0.27079, homo loss: 0.00002 
acc_train_clean: 0.8940, ASR_train_attach: 0.9250, ASR_train_outter: 0.9756
Epoch 1910, loss_inner: 0.31383, loss_target: 0.26264, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9840
Epoch 1920, loss_inner: 0.31428, loss_target: 0.33190, homo loss: 0.00159 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1930, loss_inner: 0.32896, loss_target: 0.31427, homo loss: 0.02526 
acc_train_clean: 0.8899, ASR_train_attach: 0.9750, ASR_train_outter: 0.9925
Epoch 1940, loss_inner: 0.32231, loss_target: 0.30807, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9925
Epoch 1950, loss_inner: 0.31737, loss_target: 0.28359, homo loss: 0.00027 
acc_train_clean: 0.8909, ASR_train_attach: 0.9750, ASR_train_outter: 0.9887
Epoch 1960, loss_inner: 0.31625, loss_target: 0.27546, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 0.9250, ASR_train_outter: 0.9727
Epoch 1970, loss_inner: 0.31534, loss_target: 0.26910, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9500, ASR_train_outter: 0.9840
Epoch 1980, loss_inner: 0.31436, loss_target: 0.26559, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9750, ASR_train_outter: 0.9831
Epoch 1990, loss_inner: 0.31363, loss_target: 0.26332, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9750, ASR_train_outter: 0.9812
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8529
Overall ASR: 0.9336
Flip ASR: 0.9157/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8549
Overall ASR: 0.8971
Flip ASR: 0.8739/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8508
Overall ASR: 0.9143
Flip ASR: 0.8951/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8519
Overall ASR: 0.9275
Flip ASR: 0.9099/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8503
Overall ASR: 0.9077
Flip ASR: 0.8867/1554 nodes
Overall ASR: 0.9160 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8522
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8397
Overall ASR: 0.8580
Flip ASR: 0.8243/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.6500
accuracy on clean test nodes: 0.8382
Overall ASR: 0.6638
Flip ASR: 0.5830/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8376
Overall ASR: 0.9006
Flip ASR: 0.8764/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8376
Overall ASR: 0.8266
Flip ASR: 0.7844/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8397
Overall ASR: 0.8773
Flip ASR: 0.8475/1554 nodes
Overall ASR: 0.8253 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8386
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8595
Overall ASR: 0.9001
Flip ASR: 0.8790/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8610
Overall ASR: 0.8879
Flip ASR: 0.8629/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8630
Overall ASR: 0.8976
Flip ASR: 0.8752/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8750
accuracy on clean test nodes: 0.8605
Overall ASR: 0.8732
Flip ASR: 0.8456/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=1, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=50.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.8, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8595
Overall ASR: 0.8818
Flip ASR: 0.8578/1554 nodes
Overall ASR: 0.8881 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8607
Total Overall ASR: 0.8765 
Total Clean Accuracy: 0.8505
