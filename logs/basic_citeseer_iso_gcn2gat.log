nohup: ignoring input
/home/project-graph-backdoor/Backdoor/models/GAT.py:59: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(clean_test_nodes_num=200, cuda=True, dataset='citeseer', debug=True, defense_mode='isolate', device_id=5, dropout=0.5, epochs=200, hidden=32, homo_boost_thrd=0.6, homo_loss_weight=0.0, load_benign_model=True, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=10, target_class=0, target_test_nodes_num=200, test_model='GAT', thrd=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Loading benign GCN model Finished!
Benign CA: 0.7100
Benign CA on clean test nodes: 0.6450
3327
200
Epoch 0, training loss: 1.8009929656982422
acc_train_clean: 0.1479, acc_train_attach: 0.1304
Epoch 10, training loss: 0.2316441386938095
acc_train_clean: 0.9437, acc_train_attach: 1.0000
Epoch 20, training loss: 0.07828576862812042
acc_train_clean: 0.9771, acc_train_attach: 1.0000
Epoch 30, training loss: 0.052232276648283005
acc_train_clean: 0.9854, acc_train_attach: 1.0000
Epoch 40, training loss: 0.0490339919924736
acc_train_clean: 0.9833, acc_train_attach: 1.0000
Epoch 50, training loss: 0.05806906521320343
acc_train_clean: 0.9854, acc_train_attach: 1.0000
Epoch 60, training loss: 0.049943070858716965
acc_train_clean: 0.9896, acc_train_attach: 1.0000
Epoch 70, training loss: 0.06182968243956566
acc_train_clean: 0.9875, acc_train_attach: 0.9565
Epoch 80, training loss: 0.07196316123008728
acc_train_clean: 0.9792, acc_train_attach: 0.9565
Epoch 90, training loss: 0.047797609120607376
acc_train_clean: 0.9938, acc_train_attach: 0.9565
Epoch 100, training loss: 0.04625001922249794
acc_train_clean: 0.9896, acc_train_attach: 1.0000
Epoch 110, training loss: 0.04627875238656998
acc_train_clean: 0.9875, acc_train_attach: 1.0000
Epoch 120, training loss: 0.04752368479967117
acc_train_clean: 0.9875, acc_train_attach: 1.0000
Epoch 130, training loss: 0.03499792143702507
acc_train_clean: 0.9896, acc_train_attach: 1.0000
Epoch 140, training loss: 0.03851507976651192
acc_train_clean: 0.9875, acc_train_attach: 1.0000
Epoch 150, training loss: 0.03788169473409653
acc_train_clean: 0.9875, acc_train_attach: 1.0000
Epoch 160, training loss: 0.04336542263627052
acc_train_clean: 0.9875, acc_train_attach: 1.0000
Epoch 170, training loss: 0.03220749273896217
acc_train_clean: 0.9938, acc_train_attach: 0.9565
Epoch 180, training loss: 0.03228910267353058
acc_train_clean: 0.9917, acc_train_attach: 1.0000
Epoch 190, training loss: 0.03837831690907478
acc_train_clean: 0.9896, acc_train_attach: 1.0000
tensor([[   0,  628],
        [   1, 1097],
        [   2, 3285],
        ...,
        [3387, 1152],
        [3390, 1945],
        [3393, 1366]])
503
274
4454 2342
set()
=== training gcn model ===
Epoch 0, training loss: 1.869087815284729
acc_val: 0.4150
Epoch 10, training loss: 0.7988760471343994
acc_val: 0.6350
Epoch 20, training loss: 0.6787344217300415
acc_val: 0.6125
Epoch 30, training loss: 0.49556803703308105
acc_val: 0.6400
Epoch 40, training loss: 0.6050446033477783
acc_val: 0.6350
Epoch 50, training loss: 0.650266706943512
acc_val: 0.6250
Epoch 60, training loss: 0.5719447731971741
acc_val: 0.6300
Epoch 70, training loss: 0.5771983861923218
acc_val: 0.6500
Epoch 80, training loss: 0.5747926235198975
acc_val: 0.6350
Epoch 90, training loss: 0.6722148060798645
acc_val: 0.6150
Epoch 100, training loss: 0.6777650713920593
acc_val: 0.6325
Epoch 110, training loss: 0.6199994087219238
acc_val: 0.6175
Epoch 120, training loss: 0.5835607647895813
acc_val: 0.6200
Epoch 130, training loss: 0.6631028652191162
acc_val: 0.6350
Epoch 140, training loss: 0.58824622631073
acc_val: 0.6075
Epoch 150, training loss: 0.685255765914917
acc_val: 0.6050
Epoch 160, training loss: 0.7110093832015991
acc_val: 0.5950
Epoch 170, training loss: 0.6990103721618652
acc_val: 0.6125
Epoch 180, training loss: 0.5624392628669739
acc_val: 0.6025
Epoch 190, training loss: 0.6858659982681274
acc_val: 0.6150
=== picking the best model according to the performance on validation ===
target class rate on Vs: 0.0870
accuracy on clean test nodes: 0.6950
ASR: 0.0100
CA: 0.6700
