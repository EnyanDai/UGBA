nohup: ignoring input
WARNING:root:The OGB package is out of date. Your version is 1.3.3, while the latest version is 1.3.4.
1
2
Namespace(attack_method='Basic', cuda=True, dataset='Reddit2', debug=True, defense_mode='none', device_id=0, dis_weight=1.0, dropout=0.5, epochs=200, hidden=128, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='cluster', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Loading benign GCN model Finished!
Benign CA: 0.3497
Length of training set: 46593
=== training gcn model ===
Epoch 0, training loss: 3.716425657272339
acc_val: 0.0479
Epoch 10, training loss: 3.406393527984619
acc_val: 0.1268
Epoch 20, training loss: 3.125899076461792
acc_val: 0.1518
Epoch 30, training loss: 2.947035789489746
acc_val: 0.2123
Epoch 40, training loss: 2.864265203475952
acc_val: 0.2358
Epoch 50, training loss: 2.6674692630767822
acc_val: 0.3146
Epoch 60, training loss: 2.3652701377868652
acc_val: 0.3833
Epoch 70, training loss: 2.1955161094665527
acc_val: 0.4443
Epoch 80, training loss: 2.0924556255340576
acc_val: 0.4627
Epoch 90, training loss: 2.0256638526916504
acc_val: 0.4736
Epoch 100, training loss: 1.9892898797988892
acc_val: 0.4709
Epoch 110, training loss: 1.9690766334533691
acc_val: 0.4829
Epoch 120, training loss: 1.9285783767700195
acc_val: 0.4896
Epoch 130, training loss: 1.9154058694839478
acc_val: 0.4951
Epoch 140, training loss: 1.8970781564712524
acc_val: 0.4971
Epoch 150, training loss: 1.8856998682022095
acc_val: 0.5018
Epoch 160, training loss: 1.8694742918014526
acc_val: 0.5040
Epoch 170, training loss: 1.8630313873291016
acc_val: 0.5073
Epoch 180, training loss: 1.857529878616333
acc_val: 0.5047
Epoch 190, training loss: 1.8526662588119507
acc_val: 0.5076
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 95.3971s
Encoder CA on clean test nodes: 0.5087
running k-means on cuda:0..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:01, ?it/s, center_shift=724.917175, iteration=1, tol=0.000100][running kmeans]: 1it [00:01,  1.24s/it, center_shift=724.917175, iteration=1, tol=0.000100][running kmeans]: 1it [00:02,  1.24s/it, center_shift=165.710419, iteration=2, tol=0.000100][running kmeans]: 2it [00:02,  1.28s/it, center_shift=165.710419, iteration=2, tol=0.000100][running kmeans]: 2it [00:03,  1.28s/it, center_shift=59.363922, iteration=3, tol=0.000100] [running kmeans]: 3it [00:03,  1.32s/it, center_shift=59.363922, iteration=3, tol=0.000100][running kmeans]: 3it [00:05,  1.32s/it, center_shift=39.042152, iteration=4, tol=0.000100][running kmeans]: 4it [00:05,  1.34s/it, center_shift=39.042152, iteration=4, tol=0.000100][running kmeans]: 4it [00:06,  1.34s/it, center_shift=31.845732, iteration=5, tol=0.000100][running kmeans]: 5it [00:06,  1.38s/it, center_shift=31.845732, iteration=5, tol=0.000100][running kmeans]: 5it [00:08,  1.38s/it, center_shift=26.142353, iteration=6, tol=0.000100][running kmeans]: 6it [00:08,  1.42s/it, center_shift=26.142353, iteration=6, tol=0.000100][running kmeans]: 6it [00:09,  1.42s/it, center_shift=24.382013, iteration=7, tol=0.000100][running kmeans]: 7it [00:09,  1.38s/it, center_shift=24.382013, iteration=7, tol=0.000100][running kmeans]: 7it [00:10,  1.38s/it, center_shift=19.378284, iteration=8, tol=0.000100][running kmeans]: 8it [00:10,  1.39s/it, center_shift=19.378284, iteration=8, tol=0.000100][running kmeans]: 8it [00:12,  1.39s/it, center_shift=14.155643, iteration=9, tol=0.000100][running kmeans]: 9it [00:12,  1.39s/it, center_shift=14.155643, iteration=9, tol=0.000100][running kmeans]: 9it [00:13,  1.39s/it, center_shift=10.334481, iteration=10, tol=0.000100][running kmeans]: 10it [00:13,  1.39s/it, center_shift=10.334481, iteration=10, tol=0.000100][running kmeans]: 10it [00:15,  1.39s/it, center_shift=7.485923, iteration=11, tol=0.000100] [running kmeans]: 11it [00:15,  1.38s/it, center_shift=7.485923, iteration=11, tol=0.000100][running kmeans]: 11it [00:16,  1.38s/it, center_shift=6.099754, iteration=12, tol=0.000100][running kmeans]: 12it [00:16,  1.35s/it, center_shift=6.099754, iteration=12, tol=0.000100][running kmeans]: 12it [00:17,  1.35s/it, center_shift=4.946199, iteration=13, tol=0.000100][running kmeans]: 13it [00:17,  1.35s/it, center_shift=4.946199, iteration=13, tol=0.000100][running kmeans]: 13it [00:18,  1.35s/it, center_shift=4.300060, iteration=14, tol=0.000100][running kmeans]: 14it [00:18,  1.32s/it, center_shift=4.300060, iteration=14, tol=0.000100][running kmeans]: 14it [00:20,  1.32s/it, center_shift=3.534971, iteration=15, tol=0.000100][running kmeans]: 15it [00:20,  1.32s/it, center_shift=3.534971, iteration=15, tol=0.000100][running kmeans]: 15it [00:21,  1.32s/it, center_shift=2.965557, iteration=16, tol=0.000100][running kmeans]: 16it [00:21,  1.33s/it, center_shift=2.965557, iteration=16, tol=0.000100][running kmeans]: 16it [00:22,  1.33s/it, center_shift=2.290971, iteration=17, tol=0.000100][running kmeans]: 17it [00:22,  1.33s/it, center_shift=2.290971, iteration=17, tol=0.000100][running kmeans]: 17it [00:24,  1.33s/it, center_shift=1.809826, iteration=18, tol=0.000100][running kmeans]: 18it [00:24,  1.34s/it, center_shift=1.809826, iteration=18, tol=0.000100][running kmeans]: 18it [00:25,  1.34s/it, center_shift=1.591601, iteration=19, tol=0.000100][running kmeans]: 19it [00:25,  1.36s/it, center_shift=1.591601, iteration=19, tol=0.000100][running kmeans]: 19it [00:27,  1.36s/it, center_shift=1.313705, iteration=20, tol=0.000100][running kmeans]: 20it [00:27,  1.36s/it, center_shift=1.313705, iteration=20, tol=0.000100][running kmeans]: 20it [00:28,  1.36s/it, center_shift=1.155841, iteration=21, tol=0.000100][running kmeans]: 21it [00:28,  1.38s/it, center_shift=1.155841, iteration=21, tol=0.000100][running kmeans]: 21it [00:29,  1.38s/it, center_shift=0.975919, iteration=22, tol=0.000100][running kmeans]: 22it [00:29,  1.36s/it, center_shift=0.975919, iteration=22, tol=0.000100][running kmeans]: 22it [00:31,  1.36s/it, center_shift=0.809247, iteration=23, tol=0.000100][running kmeans]: 23it [00:31,  1.36s/it, center_shift=0.809247, iteration=23, tol=0.000100][running kmeans]: 23it [00:32,  1.36s/it, center_shift=0.663832, iteration=24, tol=0.000100][running kmeans]: 24it [00:32,  1.40s/it, center_shift=0.663832, iteration=24, tol=0.000100][running kmeans]: 24it [00:34,  1.40s/it, center_shift=0.601344, iteration=25, tol=0.000100][running kmeans]: 25it [00:34,  1.41s/it, center_shift=0.601344, iteration=25, tol=0.000100][running kmeans]: 25it [00:35,  1.41s/it, center_shift=0.559720, iteration=26, tol=0.000100][running kmeans]: 26it [00:35,  1.41s/it, center_shift=0.559720, iteration=26, tol=0.000100][running kmeans]: 26it [00:36,  1.41s/it, center_shift=0.450605, iteration=27, tol=0.000100][running kmeans]: 27it [00:36,  1.42s/it, center_shift=0.450605, iteration=27, tol=0.000100][running kmeans]: 27it [00:38,  1.42s/it, center_shift=0.308306, iteration=28, tol=0.000100][running kmeans]: 28it [00:38,  1.40s/it, center_shift=0.308306, iteration=28, tol=0.000100][running kmeans]: 28it [00:39,  1.40s/it, center_shift=0.310513, iteration=29, tol=0.000100][running kmeans]: 29it [00:39,  1.40s/it, center_shift=0.310513, iteration=29, tol=0.000100][running kmeans]: 29it [00:41,  1.40s/it, center_shift=0.283563, iteration=30, tol=0.000100][running kmeans]: 30it [00:41,  1.40s/it, center_shift=0.283563, iteration=30, tol=0.000100][running kmeans]: 30it [00:42,  1.40s/it, center_shift=0.277445, iteration=31, tol=0.000100][running kmeans]: 31it [00:42,  1.42s/it, center_shift=0.277445, iteration=31, tol=0.000100][running kmeans]: 31it [00:43,  1.42s/it, center_shift=0.266792, iteration=32, tol=0.000100][running kmeans]: 32it [00:43,  1.41s/it, center_shift=0.266792, iteration=32, tol=0.000100][running kmeans]: 32it [00:45,  1.41s/it, center_shift=0.308664, iteration=33, tol=0.000100][running kmeans]: 33it [00:45,  1.42s/it, center_shift=0.308664, iteration=33, tol=0.000100][running kmeans]: 33it [00:46,  1.42s/it, center_shift=0.347964, iteration=34, tol=0.000100][running kmeans]: 34it [00:46,  1.40s/it, center_shift=0.347964, iteration=34, tol=0.000100][running kmeans]: 34it [00:48,  1.40s/it, center_shift=0.376213, iteration=35, tol=0.000100][running kmeans]: 35it [00:48,  1.42s/it, center_shift=0.376213, iteration=35, tol=0.000100][running kmeans]: 35it [00:49,  1.42s/it, center_shift=0.378607, iteration=36, tol=0.000100][running kmeans]: 36it [00:49,  1.42s/it, center_shift=0.378607, iteration=36, tol=0.000100][running kmeans]: 36it [00:51,  1.42s/it, center_shift=0.314222, iteration=37, tol=0.000100][running kmeans]: 37it [00:51,  1.41s/it, center_shift=0.314222, iteration=37, tol=0.000100][running kmeans]: 37it [00:52,  1.41s/it, center_shift=0.400338, iteration=38, tol=0.000100][running kmeans]: 38it [00:52,  1.41s/it, center_shift=0.400338, iteration=38, tol=0.000100][running kmeans]: 38it [00:53,  1.41s/it, center_shift=0.472416, iteration=39, tol=0.000100][running kmeans]: 39it [00:53,  1.43s/it, center_shift=0.472416, iteration=39, tol=0.000100][running kmeans]: 39it [00:55,  1.43s/it, center_shift=0.561725, iteration=40, tol=0.000100][running kmeans]: 40it [00:55,  1.48s/it, center_shift=0.561725, iteration=40, tol=0.000100][running kmeans]: 40it [00:57,  1.48s/it, center_shift=0.723401, iteration=41, tol=0.000100][running kmeans]: 41it [00:57,  1.49s/it, center_shift=0.723401, iteration=41, tol=0.000100][running kmeans]: 41it [00:58,  1.49s/it, center_shift=0.852322, iteration=42, tol=0.000100][running kmeans]: 42it [00:58,  1.46s/it, center_shift=0.852322, iteration=42, tol=0.000100][running kmeans]: 42it [00:59,  1.46s/it, center_shift=0.855229, iteration=43, tol=0.000100][running kmeans]: 43it [00:59,  1.42s/it, center_shift=0.855229, iteration=43, tol=0.000100][running kmeans]: 43it [01:01,  1.42s/it, center_shift=0.848962, iteration=44, tol=0.000100][running kmeans]: 44it [01:01,  1.43s/it, center_shift=0.848962, iteration=44, tol=0.000100][running kmeans]: 44it [01:02,  1.43s/it, center_shift=0.769246, iteration=45, tol=0.000100][running kmeans]: 45it [01:02,  1.40s/it, center_shift=0.769246, iteration=45, tol=0.000100][running kmeans]: 45it [01:03,  1.40s/it, center_shift=0.696390, iteration=46, tol=0.000100][running kmeans]: 46it [01:03,  1.39s/it, center_shift=0.696390, iteration=46, tol=0.000100][running kmeans]: 46it [01:05,  1.39s/it, center_shift=0.578209, iteration=47, tol=0.000100][running kmeans]: 47it [01:05,  1.39s/it, center_shift=0.578209, iteration=47, tol=0.000100][running kmeans]: 47it [01:06,  1.39s/it, center_shift=0.491082, iteration=48, tol=0.000100][running kmeans]: 48it [01:06,  1.39s/it, center_shift=0.491082, iteration=48, tol=0.000100][running kmeans]: 48it [01:08,  1.39s/it, center_shift=0.482606, iteration=49, tol=0.000100][running kmeans]: 49it [01:08,  1.40s/it, center_shift=0.482606, iteration=49, tol=0.000100][running kmeans]: 49it [01:09,  1.40s/it, center_shift=0.433593, iteration=50, tol=0.000100][running kmeans]: 50it [01:09,  1.42s/it, center_shift=0.433593, iteration=50, tol=0.000100][running kmeans]: 50it [01:10,  1.42s/it, center_shift=0.447003, iteration=51, tol=0.000100][running kmeans]: 51it [01:10,  1.42s/it, center_shift=0.447003, iteration=51, tol=0.000100][running kmeans]: 51it [01:12,  1.42s/it, center_shift=0.281740, iteration=52, tol=0.000100][running kmeans]: 52it [01:12,  1.40s/it, center_shift=0.281740, iteration=52, tol=0.000100][running kmeans]: 52it [01:14,  1.40s/it, center_shift=0.224382, iteration=53, tol=0.000100][running kmeans]: 53it [01:14,  1.58s/it, center_shift=0.224382, iteration=53, tol=0.000100][running kmeans]: 53it [01:15,  1.58s/it, center_shift=0.189131, iteration=54, tol=0.000100][running kmeans]: 54it [01:15,  1.60s/it, center_shift=0.189131, iteration=54, tol=0.000100][running kmeans]: 54it [01:17,  1.60s/it, center_shift=0.123476, iteration=55, tol=0.000100][running kmeans]: 55it [01:17,  1.63s/it, center_shift=0.123476, iteration=55, tol=0.000100][running kmeans]: 55it [01:19,  1.63s/it, center_shift=0.107069, iteration=56, tol=0.000100][running kmeans]: 56it [01:19,  1.55s/it, center_shift=0.107069, iteration=56, tol=0.000100][running kmeans]: 56it [01:20,  1.55s/it, center_shift=0.115934, iteration=57, tol=0.000100][running kmeans]: 57it [01:20,  1.51s/it, center_shift=0.115934, iteration=57, tol=0.000100][running kmeans]: 57it [01:21,  1.51s/it, center_shift=0.114336, iteration=58, tol=0.000100][running kmeans]: 58it [01:21,  1.49s/it, center_shift=0.114336, iteration=58, tol=0.000100][running kmeans]: 58it [01:23,  1.49s/it, center_shift=0.091554, iteration=59, tol=0.000100][running kmeans]: 59it [01:23,  1.43s/it, center_shift=0.091554, iteration=59, tol=0.000100][running kmeans]: 59it [01:24,  1.43s/it, center_shift=0.075284, iteration=60, tol=0.000100][running kmeans]: 60it [01:24,  1.42s/it, center_shift=0.075284, iteration=60, tol=0.000100][running kmeans]: 60it [01:25,  1.42s/it, center_shift=0.095696, iteration=61, tol=0.000100][running kmeans]: 61it [01:25,  1.36s/it, center_shift=0.095696, iteration=61, tol=0.000100][running kmeans]: 61it [01:27,  1.36s/it, center_shift=0.085539, iteration=62, tol=0.000100][running kmeans]: 62it [01:27,  1.33s/it, center_shift=0.085539, iteration=62, tol=0.000100][running kmeans]: 62it [01:28,  1.33s/it, center_shift=0.068303, iteration=63, tol=0.000100][running kmeans]: 63it [01:28,  1.34s/it, center_shift=0.068303, iteration=63, tol=0.000100][running kmeans]: 63it [01:29,  1.34s/it, center_shift=0.073042, iteration=64, tol=0.000100][running kmeans]: 64it [01:29,  1.35s/it, center_shift=0.073042, iteration=64, tol=0.000100][running kmeans]: 64it [01:31,  1.35s/it, center_shift=0.085993, iteration=65, tol=0.000100][running kmeans]: 65it [01:31,  1.35s/it, center_shift=0.085993, iteration=65, tol=0.000100][running kmeans]: 65it [01:32,  1.35s/it, center_shift=0.115039, iteration=66, tol=0.000100][running kmeans]: 66it [01:32,  1.38s/it, center_shift=0.115039, iteration=66, tol=0.000100][running kmeans]: 66it [01:33,  1.38s/it, center_shift=0.112102, iteration=67, tol=0.000100][running kmeans]: 67it [01:33,  1.36s/it, center_shift=0.112102, iteration=67, tol=0.000100][running kmeans]: 67it [01:35,  1.36s/it, center_shift=0.123952, iteration=68, tol=0.000100][running kmeans]: 68it [01:35,  1.34s/it, center_shift=0.123952, iteration=68, tol=0.000100][running kmeans]: 68it [01:36,  1.34s/it, center_shift=0.120504, iteration=69, tol=0.000100][running kmeans]: 69it [01:36,  1.39s/it, center_shift=0.120504, iteration=69, tol=0.000100][running kmeans]: 69it [01:38,  1.39s/it, center_shift=0.108489, iteration=70, tol=0.000100][running kmeans]: 70it [01:38,  1.36s/it, center_shift=0.108489, iteration=70, tol=0.000100][running kmeans]: 70it [01:39,  1.36s/it, center_shift=0.120185, iteration=71, tol=0.000100][running kmeans]: 71it [01:39,  1.37s/it, center_shift=0.120185, iteration=71, tol=0.000100][running kmeans]: 71it [01:40,  1.37s/it, center_shift=0.136292, iteration=72, tol=0.000100][running kmeans]: 72it [01:40,  1.35s/it, center_shift=0.136292, iteration=72, tol=0.000100][running kmeans]: 72it [01:42,  1.35s/it, center_shift=0.130143, iteration=73, tol=0.000100][running kmeans]: 73it [01:42,  1.33s/it, center_shift=0.130143, iteration=73, tol=0.000100][running kmeans]: 73it [01:43,  1.33s/it, center_shift=0.095975, iteration=74, tol=0.000100][running kmeans]: 74it [01:43,  1.33s/it, center_shift=0.095975, iteration=74, tol=0.000100][running kmeans]: 74it [01:44,  1.33s/it, center_shift=0.081477, iteration=75, tol=0.000100][running kmeans]: 75it [01:44,  1.32s/it, center_shift=0.081477, iteration=75, tol=0.000100][running kmeans]: 75it [01:46,  1.32s/it, center_shift=0.054718, iteration=76, tol=0.000100][running kmeans]: 76it [01:46,  1.33s/it, center_shift=0.054718, iteration=76, tol=0.000100][running kmeans]: 76it [01:47,  1.33s/it, center_shift=0.058165, iteration=77, tol=0.000100][running kmeans]: 77it [01:47,  1.42s/it, center_shift=0.058165, iteration=77, tol=0.000100][running kmeans]: 77it [01:48,  1.42s/it, center_shift=0.043017, iteration=78, tol=0.000100][running kmeans]: 78it [01:48,  1.39s/it, center_shift=0.043017, iteration=78, tol=0.000100][running kmeans]: 78it [01:50,  1.39s/it, center_shift=0.029981, iteration=79, tol=0.000100][running kmeans]: 79it [01:50,  1.43s/it, center_shift=0.029981, iteration=79, tol=0.000100][running kmeans]: 79it [01:51,  1.43s/it, center_shift=0.014811, iteration=80, tol=0.000100][running kmeans]: 80it [01:51,  1.39s/it, center_shift=0.014811, iteration=80, tol=0.000100][running kmeans]: 80it [01:53,  1.39s/it, center_shift=0.013506, iteration=81, tol=0.000100][running kmeans]: 81it [01:53,  1.40s/it, center_shift=0.013506, iteration=81, tol=0.000100][running kmeans]: 81it [01:54,  1.40s/it, center_shift=0.012568, iteration=82, tol=0.000100][running kmeans]: 82it [01:54,  1.41s/it, center_shift=0.012568, iteration=82, tol=0.000100][running kmeans]: 82it [01:55,  1.41s/it, center_shift=0.008809, iteration=83, tol=0.000100][running kmeans]: 83it [01:55,  1.36s/it, center_shift=0.008809, iteration=83, tol=0.000100][running kmeans]: 83it [01:57,  1.36s/it, center_shift=0.004862, iteration=84, tol=0.000100][running kmeans]: 84it [01:57,  1.39s/it, center_shift=0.004862, iteration=84, tol=0.000100][running kmeans]: 84it [01:58,  1.39s/it, center_shift=0.004121, iteration=85, tol=0.000100][running kmeans]: 85it [01:58,  1.35s/it, center_shift=0.004121, iteration=85, tol=0.000100][running kmeans]: 85it [01:59,  1.35s/it, center_shift=0.003756, iteration=86, tol=0.000100][running kmeans]: 86it [01:59,  1.33s/it, center_shift=0.003756, iteration=86, tol=0.000100][running kmeans]: 86it [02:01,  1.33s/it, center_shift=0.002358, iteration=87, tol=0.000100][running kmeans]: 87it [02:01,  1.30s/it, center_shift=0.002358, iteration=87, tol=0.000100][running kmeans]: 87it [02:02,  1.30s/it, center_shift=0.002079, iteration=88, tol=0.000100][running kmeans]: 88it [02:02,  1.25s/it, center_shift=0.002079, iteration=88, tol=0.000100][running kmeans]: 88it [02:03,  1.25s/it, center_shift=0.001421, iteration=89, tol=0.000100][running kmeans]: 89it [02:03,  1.22s/it, center_shift=0.001421, iteration=89, tol=0.000100][running kmeans]: 89it [02:04,  1.22s/it, center_shift=0.000858, iteration=90, tol=0.000100][running kmeans]: 90it [02:04,  1.26s/it, center_shift=0.000858, iteration=90, tol=0.000100][running kmeans]: 90it [02:06,  1.26s/it, center_shift=0.000975, iteration=91, tol=0.000100][running kmeans]: 91it [02:06,  1.26s/it, center_shift=0.000975, iteration=91, tol=0.000100][running kmeans]: 91it [02:07,  1.26s/it, center_shift=0.000804, iteration=92, tol=0.000100][running kmeans]: 92it [02:07,  1.26s/it, center_shift=0.000804, iteration=92, tol=0.000100][running kmeans]: 92it [02:08,  1.26s/it, center_shift=0.001320, iteration=93, tol=0.000100][running kmeans]: 93it [02:08,  1.22s/it, center_shift=0.001320, iteration=93, tol=0.000100][running kmeans]: 93it [02:09,  1.22s/it, center_shift=0.002235, iteration=94, tol=0.000100][running kmeans]: 94it [02:09,  1.23s/it, center_shift=0.002235, iteration=94, tol=0.000100][running kmeans]: 94it [02:10,  1.23s/it, center_shift=0.001195, iteration=95, tol=0.000100][running kmeans]: 95it [02:10,  1.23s/it, center_shift=0.001195, iteration=95, tol=0.000100][running kmeans]: 95it [02:12,  1.23s/it, center_shift=0.001225, iteration=96, tol=0.000100][running kmeans]: 96it [02:12,  1.25s/it, center_shift=0.001225, iteration=96, tol=0.000100][running kmeans]: 96it [02:13,  1.25s/it, center_shift=0.001200, iteration=97, tol=0.000100][running kmeans]: 97it [02:13,  1.25s/it, center_shift=0.001200, iteration=97, tol=0.000100][running kmeans]: 97it [02:14,  1.25s/it, center_shift=0.000764, iteration=98, tol=0.000100][running kmeans]: 98it [02:14,  1.31s/it, center_shift=0.000764, iteration=98, tol=0.000100][running kmeans]: 98it [02:16,  1.31s/it, center_shift=0.000782, iteration=99, tol=0.000100][running kmeans]: 99it [02:16,  1.31s/it, center_shift=0.000782, iteration=99, tol=0.000100][running kmeans]: 99it [02:17,  1.31s/it, center_shift=0.000510, iteration=100, tol=0.000100][running kmeans]: 100it [02:17,  1.26s/it, center_shift=0.000510, iteration=100, tol=0.000100][running kmeans]: 100it [02:18,  1.26s/it, center_shift=0.000598, iteration=101, tol=0.000100][running kmeans]: 101it [02:18,  1.26s/it, center_shift=0.000598, iteration=101, tol=0.000100][running kmeans]: 101it [02:20,  1.26s/it, center_shift=0.000469, iteration=102, tol=0.000100][running kmeans]: 102it [02:20,  1.31s/it, center_shift=0.000469, iteration=102, tol=0.000100][running kmeans]: 102it [02:21,  1.31s/it, center_shift=0.000340, iteration=103, tol=0.000100][running kmeans]: 103it [02:21,  1.26s/it, center_shift=0.000340, iteration=103, tol=0.000100][running kmeans]: 103it [02:22,  1.26s/it, center_shift=0.000356, iteration=104, tol=0.000100][running kmeans]: 104it [02:22,  1.24s/it, center_shift=0.000356, iteration=104, tol=0.000100][running kmeans]: 104it [02:23,  1.24s/it, center_shift=0.000795, iteration=105, tol=0.000100][running kmeans]: 105it [02:23,  1.23s/it, center_shift=0.000795, iteration=105, tol=0.000100][running kmeans]: 105it [02:24,  1.23s/it, center_shift=0.000522, iteration=106, tol=0.000100][running kmeans]: 106it [02:24,  1.21s/it, center_shift=0.000522, iteration=106, tol=0.000100][running kmeans]: 106it [02:25,  1.21s/it, center_shift=0.000542, iteration=107, tol=0.000100][running kmeans]: 107it [02:25,  1.21s/it, center_shift=0.000542, iteration=107, tol=0.000100][running kmeans]: 107it [02:27,  1.21s/it, center_shift=0.000563, iteration=108, tol=0.000100][running kmeans]: 108it [02:27,  1.19s/it, center_shift=0.000563, iteration=108, tol=0.000100][running kmeans]: 108it [02:28,  1.19s/it, center_shift=0.000799, iteration=109, tol=0.000100][running kmeans]: 109it [02:28,  1.19s/it, center_shift=0.000799, iteration=109, tol=0.000100][running kmeans]: 109it [02:29,  1.19s/it, center_shift=0.001034, iteration=110, tol=0.000100][running kmeans]: 110it [02:29,  1.20s/it, center_shift=0.001034, iteration=110, tol=0.000100][running kmeans]: 110it [02:30,  1.20s/it, center_shift=0.001409, iteration=111, tol=0.000100][running kmeans]: 111it [02:30,  1.18s/it, center_shift=0.001409, iteration=111, tol=0.000100][running kmeans]: 111it [02:31,  1.18s/it, center_shift=0.000985, iteration=112, tol=0.000100][running kmeans]: 112it [02:31,  1.18s/it, center_shift=0.000985, iteration=112, tol=0.000100][running kmeans]: 112it [02:32,  1.18s/it, center_shift=0.000525, iteration=113, tol=0.000100][running kmeans]: 113it [02:32,  1.15s/it, center_shift=0.000525, iteration=113, tol=0.000100][running kmeans]: 113it [02:33,  1.15s/it, center_shift=0.000347, iteration=114, tol=0.000100][running kmeans]: 114it [02:33,  1.11s/it, center_shift=0.000347, iteration=114, tol=0.000100][running kmeans]: 114it [02:34,  1.11s/it, center_shift=0.000432, iteration=115, tol=0.000100][running kmeans]: 115it [02:34,  1.08s/it, center_shift=0.000432, iteration=115, tol=0.000100][running kmeans]: 115it [02:35,  1.08s/it, center_shift=0.000408, iteration=116, tol=0.000100][running kmeans]: 116it [02:35,  1.07s/it, center_shift=0.000408, iteration=116, tol=0.000100][running kmeans]: 116it [02:36,  1.07s/it, center_shift=0.000258, iteration=117, tol=0.000100][running kmeans]: 117it [02:36,  1.05s/it, center_shift=0.000258, iteration=117, tol=0.000100][running kmeans]: 117it [02:37,  1.05s/it, center_shift=0.000351, iteration=118, tol=0.000100][running kmeans]: 118it [02:37,  1.05s/it, center_shift=0.000351, iteration=118, tol=0.000100][running kmeans]: 118it [02:39,  1.05s/it, center_shift=0.000188, iteration=119, tol=0.000100][running kmeans]: 119it [02:39,  1.04s/it, center_shift=0.000188, iteration=119, tol=0.000100][running kmeans]: 119it [02:40,  1.04s/it, center_shift=0.000153, iteration=120, tol=0.000100][running kmeans]: 120it [02:40,  1.04s/it, center_shift=0.000153, iteration=120, tol=0.000100][running kmeans]: 120it [02:40,  1.04s/it, center_shift=0.000114, iteration=121, tol=0.000100][running kmeans]: 121it [02:40,  1.01s/it, center_shift=0.000114, iteration=121, tol=0.000100][running kmeans]: 121it [02:41,  1.01s/it, center_shift=0.000142, iteration=122, tol=0.000100][running kmeans]: 122it [02:41,  1.01it/s, center_shift=0.000142, iteration=122, tol=0.000100][running kmeans]: 122it [02:42,  1.01it/s, center_shift=0.000168, iteration=123, tol=0.000100][running kmeans]: 123it [02:42,  1.05it/s, center_shift=0.000168, iteration=123, tol=0.000100][running kmeans]: 123it [02:43,  1.05it/s, center_shift=0.000081, iteration=124, tol=0.000100][running kmeans]: 124it [02:43,  1.08it/s, center_shift=0.000081, iteration=124, tol=0.000100][running kmeans]: 124it [02:43,  1.32s/it, center_shift=0.000081, iteration=124, tol=0.000100]
predicting on cuda:0..
tensor([34,  9,  5,  ..., 14,  2,  6])
Epoch 0, loss_inner: 3.71397, loss_target: 3.69828, homo loss: 0.47186 
acc_train_clean: 0.0025, ASR_train_attach: 0.0000, ASR_train_outter: 0.0825
Traceback (most recent call last):
  File "run.py", line 258, in <module>
    model.fit(data.x, train_edge_index, None, data.y, idx_train,idx_attach, unlabeled_idx)
  File "/home/project-graph-backdoor/Backdoor/models/backdoor.py", line 506, in fit
    loss_outter.backward()
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 7.21 GiB (GPU 0; 47.54 GiB total capacity; 26.70 GiB already allocated; 693.31 MiB free; 45.89 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
