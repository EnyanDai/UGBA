nohup: ignoring input
1
2
Namespace(attack_method='Basic', cuda=True, dataset='Reddit2', debug=True, defense_mode='none', device_id=0, dis_weight=1.0, dropout=0.5, epochs=200, hidden=128, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='cluster', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_prob=0.5, trigger_size=3, trojan_epochs=200, vs_ratio=0.01, weight_decay=0.0005)
Length of training set: 46593
Training benign model Finished!
Total time elapsed: 69.4129s
Benign CA: 0.8367
Length of training set: 46593
=== training gcn model ===
Epoch 0, training loss: 4.015378952026367
acc_val: 0.1313
Epoch 10, training loss: 2.8993897438049316
acc_val: 0.2746
Epoch 20, training loss: 2.394538640975952
acc_val: 0.2289
Epoch 30, training loss: 2.0744919776916504
acc_val: 0.4367
Epoch 40, training loss: 1.9913424253463745
acc_val: 0.4944
Epoch 50, training loss: 1.8719531297683716
acc_val: 0.4369
Epoch 60, training loss: 1.7349501848220825
acc_val: 0.5271
Epoch 70, training loss: 1.6682052612304688
acc_val: 0.4028
Epoch 80, training loss: 1.7346059083938599
acc_val: 0.4793
Epoch 90, training loss: 1.609910011291504
acc_val: 0.5779
Epoch 100, training loss: 1.547725796699524
acc_val: 0.5849
Epoch 110, training loss: 2.504408836364746
acc_val: 0.4382
Epoch 120, training loss: 1.7218786478042603
acc_val: 0.5625
Epoch 130, training loss: 1.734696626663208
acc_val: 0.5630
Epoch 140, training loss: 1.4883627891540527
acc_val: 0.6082
Epoch 150, training loss: 1.4091016054153442
acc_val: 0.6229
Epoch 160, training loss: 1.5665721893310547
acc_val: 0.4322
Epoch 170, training loss: 1.8548791408538818
acc_val: 0.4357
Epoch 180, training loss: 1.601817011833191
acc_val: 0.5892
Epoch 190, training loss: 1.9425793886184692
acc_val: 0.5157
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 99.8205s
Encoder CA on clean test nodes: 0.6667
running k-means on cuda:0..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:00, ?it/s, center_shift=4244.632812, iteration=1, tol=0.000100][running kmeans]: 1it [00:00,  1.16it/s, center_shift=4244.632812, iteration=1, tol=0.000100][running kmeans]: 1it [00:01,  1.16it/s, center_shift=615.137512, iteration=2, tol=0.000100] [running kmeans]: 2it [00:01,  1.15it/s, center_shift=615.137512, iteration=2, tol=0.000100][running kmeans]: 2it [00:02,  1.15it/s, center_shift=191.111237, iteration=3, tol=0.000100][running kmeans]: 3it [00:02,  1.11it/s, center_shift=191.111237, iteration=3, tol=0.000100][running kmeans]: 3it [00:03,  1.11it/s, center_shift=78.288528, iteration=4, tol=0.000100] [running kmeans]: 4it [00:03,  1.01s/it, center_shift=78.288528, iteration=4, tol=0.000100][running kmeans]: 4it [00:04,  1.01s/it, center_shift=48.223969, iteration=5, tol=0.000100][running kmeans]: 5it [00:04,  1.06s/it, center_shift=48.223969, iteration=5, tol=0.000100][running kmeans]: 5it [00:05,  1.06s/it, center_shift=37.496166, iteration=6, tol=0.000100][running kmeans]: 6it [00:05,  1.02s/it, center_shift=37.496166, iteration=6, tol=0.000100][running kmeans]: 6it [00:06,  1.02s/it, center_shift=27.084747, iteration=7, tol=0.000100][running kmeans]: 7it [00:06,  1.02s/it, center_shift=27.084747, iteration=7, tol=0.000100][running kmeans]: 7it [00:08,  1.02s/it, center_shift=17.759008, iteration=8, tol=0.000100][running kmeans]: 8it [00:08,  1.05s/it, center_shift=17.759008, iteration=8, tol=0.000100][running kmeans]: 8it [00:09,  1.05s/it, center_shift=13.141332, iteration=9, tol=0.000100][running kmeans]: 9it [00:09,  1.07s/it, center_shift=13.141332, iteration=9, tol=0.000100][running kmeans]: 9it [00:10,  1.07s/it, center_shift=9.587532, iteration=10, tol=0.000100][running kmeans]: 10it [00:10,  1.04s/it, center_shift=9.587532, iteration=10, tol=0.000100][running kmeans]: 10it [00:11,  1.04s/it, center_shift=7.584611, iteration=11, tol=0.000100][running kmeans]: 11it [00:11,  1.02s/it, center_shift=7.584611, iteration=11, tol=0.000100][running kmeans]: 11it [00:12,  1.02s/it, center_shift=6.072155, iteration=12, tol=0.000100][running kmeans]: 12it [00:12,  1.01s/it, center_shift=6.072155, iteration=12, tol=0.000100][running kmeans]: 12it [00:13,  1.01s/it, center_shift=4.746055, iteration=13, tol=0.000100][running kmeans]: 13it [00:13,  1.03s/it, center_shift=4.746055, iteration=13, tol=0.000100][running kmeans]: 13it [00:14,  1.03s/it, center_shift=4.201857, iteration=14, tol=0.000100][running kmeans]: 14it [00:14,  1.02s/it, center_shift=4.201857, iteration=14, tol=0.000100][running kmeans]: 14it [00:15,  1.02s/it, center_shift=3.570937, iteration=15, tol=0.000100][running kmeans]: 15it [00:15,  1.01s/it, center_shift=3.570937, iteration=15, tol=0.000100][running kmeans]: 15it [00:16,  1.01s/it, center_shift=3.321598, iteration=16, tol=0.000100][running kmeans]: 16it [00:16,  1.00s/it, center_shift=3.321598, iteration=16, tol=0.000100][running kmeans]: 16it [00:17,  1.00s/it, center_shift=3.230646, iteration=17, tol=0.000100][running kmeans]: 17it [00:17,  1.01it/s, center_shift=3.230646, iteration=17, tol=0.000100][running kmeans]: 17it [00:18,  1.01it/s, center_shift=2.731924, iteration=18, tol=0.000100][running kmeans]: 18it [00:18,  1.02it/s, center_shift=2.731924, iteration=18, tol=0.000100][running kmeans]: 18it [00:19,  1.02it/s, center_shift=2.457668, iteration=19, tol=0.000100][running kmeans]: 19it [00:19,  1.02it/s, center_shift=2.457668, iteration=19, tol=0.000100][running kmeans]: 19it [00:19,  1.02it/s, center_shift=2.127320, iteration=20, tol=0.000100][running kmeans]: 20it [00:19,  1.04it/s, center_shift=2.127320, iteration=20, tol=0.000100][running kmeans]: 20it [00:20,  1.04it/s, center_shift=2.022589, iteration=21, tol=0.000100][running kmeans]: 21it [00:20,  1.05it/s, center_shift=2.022589, iteration=21, tol=0.000100][running kmeans]: 21it [00:21,  1.05it/s, center_shift=1.779650, iteration=22, tol=0.000100][running kmeans]: 22it [00:21,  1.03it/s, center_shift=1.779650, iteration=22, tol=0.000100][running kmeans]: 22it [00:22,  1.03it/s, center_shift=1.479165, iteration=23, tol=0.000100][running kmeans]: 23it [00:22,  1.04it/s, center_shift=1.479165, iteration=23, tol=0.000100][running kmeans]: 23it [00:23,  1.04it/s, center_shift=1.488417, iteration=24, tol=0.000100][running kmeans]: 24it [00:23,  1.04it/s, center_shift=1.488417, iteration=24, tol=0.000100][running kmeans]: 24it [00:24,  1.04it/s, center_shift=1.586293, iteration=25, tol=0.000100][running kmeans]: 25it [00:24,  1.05it/s, center_shift=1.586293, iteration=25, tol=0.000100][running kmeans]: 25it [00:25,  1.05it/s, center_shift=1.297003, iteration=26, tol=0.000100][running kmeans]: 26it [00:25,  1.05it/s, center_shift=1.297003, iteration=26, tol=0.000100][running kmeans]: 26it [00:26,  1.05it/s, center_shift=1.008118, iteration=27, tol=0.000100][running kmeans]: 27it [00:26,  1.06it/s, center_shift=1.008118, iteration=27, tol=0.000100][running kmeans]: 27it [00:27,  1.06it/s, center_shift=0.716529, iteration=28, tol=0.000100][running kmeans]: 28it [00:27,  1.04it/s, center_shift=0.716529, iteration=28, tol=0.000100][running kmeans]: 28it [00:28,  1.04it/s, center_shift=0.591626, iteration=29, tol=0.000100][running kmeans]: 29it [00:28,  1.05it/s, center_shift=0.591626, iteration=29, tol=0.000100][running kmeans]: 29it [00:29,  1.05it/s, center_shift=0.486962, iteration=30, tol=0.000100][running kmeans]: 30it [00:29,  1.05it/s, center_shift=0.486962, iteration=30, tol=0.000100][running kmeans]: 30it [00:30,  1.05it/s, center_shift=0.373338, iteration=31, tol=0.000100][running kmeans]: 31it [00:30,  1.05it/s, center_shift=0.373338, iteration=31, tol=0.000100][running kmeans]: 31it [00:31,  1.05it/s, center_shift=0.255723, iteration=32, tol=0.000100][running kmeans]: 32it [00:31,  1.06it/s, center_shift=0.255723, iteration=32, tol=0.000100][running kmeans]: 32it [00:32,  1.06it/s, center_shift=0.173189, iteration=33, tol=0.000100][running kmeans]: 33it [00:32,  1.06it/s, center_shift=0.173189, iteration=33, tol=0.000100][running kmeans]: 33it [00:33,  1.06it/s, center_shift=0.139462, iteration=34, tol=0.000100][running kmeans]: 34it [00:33,  1.05it/s, center_shift=0.139462, iteration=34, tol=0.000100][running kmeans]: 34it [00:34,  1.05it/s, center_shift=0.103294, iteration=35, tol=0.000100][running kmeans]: 35it [00:34,  1.04it/s, center_shift=0.103294, iteration=35, tol=0.000100][running kmeans]: 35it [00:35,  1.04it/s, center_shift=0.098834, iteration=36, tol=0.000100][running kmeans]: 36it [00:35,  1.04it/s, center_shift=0.098834, iteration=36, tol=0.000100][running kmeans]: 36it [00:36,  1.04it/s, center_shift=0.105491, iteration=37, tol=0.000100][running kmeans]: 37it [00:36,  1.04it/s, center_shift=0.105491, iteration=37, tol=0.000100][running kmeans]: 37it [00:37,  1.04it/s, center_shift=0.099238, iteration=38, tol=0.000100][running kmeans]: 38it [00:37,  1.04it/s, center_shift=0.099238, iteration=38, tol=0.000100][running kmeans]: 38it [00:38,  1.04it/s, center_shift=0.091518, iteration=39, tol=0.000100][running kmeans]: 39it [00:38,  1.04it/s, center_shift=0.091518, iteration=39, tol=0.000100][running kmeans]: 39it [00:39,  1.04it/s, center_shift=0.096087, iteration=40, tol=0.000100][running kmeans]: 40it [00:39,  1.05it/s, center_shift=0.096087, iteration=40, tol=0.000100][running kmeans]: 40it [00:40,  1.05it/s, center_shift=0.093106, iteration=41, tol=0.000100][running kmeans]: 41it [00:40,  1.03it/s, center_shift=0.093106, iteration=41, tol=0.000100][running kmeans]: 41it [00:41,  1.03it/s, center_shift=0.079851, iteration=42, tol=0.000100][running kmeans]: 42it [00:41,  1.04it/s, center_shift=0.079851, iteration=42, tol=0.000100][running kmeans]: 42it [00:41,  1.04it/s, center_shift=0.062496, iteration=43, tol=0.000100][running kmeans]: 43it [00:41,  1.05it/s, center_shift=0.062496, iteration=43, tol=0.000100][running kmeans]: 43it [00:42,  1.05it/s, center_shift=0.045168, iteration=44, tol=0.000100][running kmeans]: 44it [00:42,  1.05it/s, center_shift=0.045168, iteration=44, tol=0.000100][running kmeans]: 44it [00:43,  1.05it/s, center_shift=0.047059, iteration=45, tol=0.000100][running kmeans]: 45it [00:43,  1.05it/s, center_shift=0.047059, iteration=45, tol=0.000100][running kmeans]: 45it [00:44,  1.05it/s, center_shift=0.057077, iteration=46, tol=0.000100][running kmeans]: 46it [00:44,  1.05it/s, center_shift=0.057077, iteration=46, tol=0.000100][running kmeans]: 46it [00:45,  1.05it/s, center_shift=0.070578, iteration=47, tol=0.000100][running kmeans]: 47it [00:45,  1.04it/s, center_shift=0.070578, iteration=47, tol=0.000100][running kmeans]: 47it [00:46,  1.04it/s, center_shift=0.059596, iteration=48, tol=0.000100][running kmeans]: 48it [00:46,  1.04it/s, center_shift=0.059596, iteration=48, tol=0.000100][running kmeans]: 48it [00:47,  1.04it/s, center_shift=0.061235, iteration=49, tol=0.000100][running kmeans]: 49it [00:47,  1.04it/s, center_shift=0.061235, iteration=49, tol=0.000100][running kmeans]: 49it [00:48,  1.04it/s, center_shift=0.061989, iteration=50, tol=0.000100][running kmeans]: 50it [00:48,  1.05it/s, center_shift=0.061989, iteration=50, tol=0.000100][running kmeans]: 50it [00:49,  1.05it/s, center_shift=0.056840, iteration=51, tol=0.000100][running kmeans]: 51it [00:49,  1.05it/s, center_shift=0.056840, iteration=51, tol=0.000100][running kmeans]: 51it [00:50,  1.05it/s, center_shift=0.060399, iteration=52, tol=0.000100][running kmeans]: 52it [00:50,  1.05it/s, center_shift=0.060399, iteration=52, tol=0.000100][running kmeans]: 52it [00:51,  1.05it/s, center_shift=0.056426, iteration=53, tol=0.000100][running kmeans]: 53it [00:51,  1.05it/s, center_shift=0.056426, iteration=53, tol=0.000100][running kmeans]: 53it [00:52,  1.05it/s, center_shift=0.052047, iteration=54, tol=0.000100][running kmeans]: 54it [00:52,  1.03it/s, center_shift=0.052047, iteration=54, tol=0.000100][running kmeans]: 54it [00:53,  1.03it/s, center_shift=0.050209, iteration=55, tol=0.000100][running kmeans]: 55it [00:53,  1.03it/s, center_shift=0.050209, iteration=55, tol=0.000100][running kmeans]: 55it [00:54,  1.03it/s, center_shift=0.048191, iteration=56, tol=0.000100][running kmeans]: 56it [00:54,  1.02it/s, center_shift=0.048191, iteration=56, tol=0.000100][running kmeans]: 56it [00:55,  1.02it/s, center_shift=0.038574, iteration=57, tol=0.000100][running kmeans]: 57it [00:55,  1.03it/s, center_shift=0.038574, iteration=57, tol=0.000100][running kmeans]: 57it [00:56,  1.03it/s, center_shift=0.035997, iteration=58, tol=0.000100][running kmeans]: 58it [00:56,  1.02it/s, center_shift=0.035997, iteration=58, tol=0.000100][running kmeans]: 58it [00:57,  1.02it/s, center_shift=0.035403, iteration=59, tol=0.000100][running kmeans]: 59it [00:57,  1.01it/s, center_shift=0.035403, iteration=59, tol=0.000100][running kmeans]: 59it [00:58,  1.01it/s, center_shift=0.034599, iteration=60, tol=0.000100][running kmeans]: 60it [00:58,  1.02it/s, center_shift=0.034599, iteration=60, tol=0.000100][running kmeans]: 60it [00:59,  1.02it/s, center_shift=0.042630, iteration=61, tol=0.000100][running kmeans]: 61it [00:59,  1.03it/s, center_shift=0.042630, iteration=61, tol=0.000100][running kmeans]: 61it [01:00,  1.03it/s, center_shift=0.027744, iteration=62, tol=0.000100][running kmeans]: 62it [01:00,  1.04it/s, center_shift=0.027744, iteration=62, tol=0.000100][running kmeans]: 62it [01:01,  1.04it/s, center_shift=0.026774, iteration=63, tol=0.000100][running kmeans]: 63it [01:01,  1.05it/s, center_shift=0.026774, iteration=63, tol=0.000100][running kmeans]: 63it [01:02,  1.05it/s, center_shift=0.029777, iteration=64, tol=0.000100][running kmeans]: 64it [01:02,  1.04it/s, center_shift=0.029777, iteration=64, tol=0.000100][running kmeans]: 64it [01:03,  1.04it/s, center_shift=0.025180, iteration=65, tol=0.000100][running kmeans]: 65it [01:03,  1.02it/s, center_shift=0.025180, iteration=65, tol=0.000100][running kmeans]: 65it [01:04,  1.02it/s, center_shift=0.019121, iteration=66, tol=0.000100][running kmeans]: 66it [01:04,  1.03it/s, center_shift=0.019121, iteration=66, tol=0.000100][running kmeans]: 66it [01:05,  1.03it/s, center_shift=0.022880, iteration=67, tol=0.000100][running kmeans]: 67it [01:05,  1.04it/s, center_shift=0.022880, iteration=67, tol=0.000100][running kmeans]: 67it [01:06,  1.04it/s, center_shift=0.027045, iteration=68, tol=0.000100][running kmeans]: 68it [01:06,  1.05it/s, center_shift=0.027045, iteration=68, tol=0.000100][running kmeans]: 68it [01:07,  1.05it/s, center_shift=0.028725, iteration=69, tol=0.000100][running kmeans]: 69it [01:07,  1.05it/s, center_shift=0.028725, iteration=69, tol=0.000100][running kmeans]: 69it [01:07,  1.05it/s, center_shift=0.024473, iteration=70, tol=0.000100][running kmeans]: 70it [01:07,  1.05it/s, center_shift=0.024473, iteration=70, tol=0.000100][running kmeans]: 70it [01:08,  1.05it/s, center_shift=0.027444, iteration=71, tol=0.000100][running kmeans]: 71it [01:08,  1.06it/s, center_shift=0.027444, iteration=71, tol=0.000100][running kmeans]: 71it [01:09,  1.06it/s, center_shift=0.030523, iteration=72, tol=0.000100][running kmeans]: 72it [01:09,  1.06it/s, center_shift=0.030523, iteration=72, tol=0.000100][running kmeans]: 72it [01:10,  1.06it/s, center_shift=0.034099, iteration=73, tol=0.000100][running kmeans]: 73it [01:10,  1.05it/s, center_shift=0.034099, iteration=73, tol=0.000100][running kmeans]: 73it [01:11,  1.05it/s, center_shift=0.038843, iteration=74, tol=0.000100][running kmeans]: 74it [01:11,  1.04it/s, center_shift=0.038843, iteration=74, tol=0.000100][running kmeans]: 74it [01:12,  1.04it/s, center_shift=0.039939, iteration=75, tol=0.000100][running kmeans]: 75it [01:12,  1.03it/s, center_shift=0.039939, iteration=75, tol=0.000100][running kmeans]: 75it [01:13,  1.03it/s, center_shift=0.039972, iteration=76, tol=0.000100][running kmeans]: 76it [01:13,  1.04it/s, center_shift=0.039972, iteration=76, tol=0.000100][running kmeans]: 76it [01:14,  1.04it/s, center_shift=0.043113, iteration=77, tol=0.000100][running kmeans]: 77it [01:14,  1.03it/s, center_shift=0.043113, iteration=77, tol=0.000100][running kmeans]: 77it [01:15,  1.03it/s, center_shift=0.051235, iteration=78, tol=0.000100][running kmeans]: 78it [01:15,  1.04it/s, center_shift=0.051235, iteration=78, tol=0.000100][running kmeans]: 78it [01:16,  1.04it/s, center_shift=0.062780, iteration=79, tol=0.000100][running kmeans]: 79it [01:16,  1.05it/s, center_shift=0.062780, iteration=79, tol=0.000100][running kmeans]: 79it [01:17,  1.05it/s, center_shift=0.072986, iteration=80, tol=0.000100][running kmeans]: 80it [01:17,  1.06it/s, center_shift=0.072986, iteration=80, tol=0.000100][running kmeans]: 80it [01:18,  1.06it/s, center_shift=0.098959, iteration=81, tol=0.000100][running kmeans]: 81it [01:18,  1.05it/s, center_shift=0.098959, iteration=81, tol=0.000100][running kmeans]: 81it [01:19,  1.05it/s, center_shift=0.092693, iteration=82, tol=0.000100][running kmeans]: 82it [01:19,  1.06it/s, center_shift=0.092693, iteration=82, tol=0.000100][running kmeans]: 82it [01:20,  1.06it/s, center_shift=0.090009, iteration=83, tol=0.000100][running kmeans]: 83it [01:20,  1.06it/s, center_shift=0.090009, iteration=83, tol=0.000100][running kmeans]: 83it [01:21,  1.06it/s, center_shift=0.102073, iteration=84, tol=0.000100][running kmeans]: 84it [01:21,  1.06it/s, center_shift=0.102073, iteration=84, tol=0.000100][running kmeans]: 84it [01:22,  1.06it/s, center_shift=0.131470, iteration=85, tol=0.000100][running kmeans]: 85it [01:22,  1.06it/s, center_shift=0.131470, iteration=85, tol=0.000100][running kmeans]: 85it [01:23,  1.06it/s, center_shift=0.120963, iteration=86, tol=0.000100][running kmeans]: 86it [01:23,  1.05it/s, center_shift=0.120963, iteration=86, tol=0.000100][running kmeans]: 86it [01:24,  1.05it/s, center_shift=0.124067, iteration=87, tol=0.000100][running kmeans]: 87it [01:24,  1.05it/s, center_shift=0.124067, iteration=87, tol=0.000100][running kmeans]: 87it [01:25,  1.05it/s, center_shift=0.107955, iteration=88, tol=0.000100][running kmeans]: 88it [01:25,  1.06it/s, center_shift=0.107955, iteration=88, tol=0.000100][running kmeans]: 88it [01:26,  1.06it/s, center_shift=0.080120, iteration=89, tol=0.000100][running kmeans]: 89it [01:26,  1.06it/s, center_shift=0.080120, iteration=89, tol=0.000100][running kmeans]: 89it [01:26,  1.06it/s, center_shift=0.080999, iteration=90, tol=0.000100][running kmeans]: 90it [01:26,  1.06it/s, center_shift=0.080999, iteration=90, tol=0.000100][running kmeans]: 90it [01:27,  1.06it/s, center_shift=0.066936, iteration=91, tol=0.000100][running kmeans]: 91it [01:27,  1.06it/s, center_shift=0.066936, iteration=91, tol=0.000100][running kmeans]: 91it [01:28,  1.06it/s, center_shift=0.050802, iteration=92, tol=0.000100][running kmeans]: 92it [01:28,  1.06it/s, center_shift=0.050802, iteration=92, tol=0.000100][running kmeans]: 92it [01:29,  1.06it/s, center_shift=0.029780, iteration=93, tol=0.000100][running kmeans]: 93it [01:29,  1.06it/s, center_shift=0.029780, iteration=93, tol=0.000100][running kmeans]: 93it [01:30,  1.06it/s, center_shift=0.033466, iteration=94, tol=0.000100][running kmeans]: 94it [01:30,  1.06it/s, center_shift=0.033466, iteration=94, tol=0.000100][running kmeans]: 94it [01:31,  1.06it/s, center_shift=0.026371, iteration=95, tol=0.000100][running kmeans]: 95it [01:31,  1.07it/s, center_shift=0.026371, iteration=95, tol=0.000100][running kmeans]: 95it [01:32,  1.07it/s, center_shift=0.025606, iteration=96, tol=0.000100][running kmeans]: 96it [01:32,  1.07it/s, center_shift=0.025606, iteration=96, tol=0.000100][running kmeans]: 96it [01:33,  1.07it/s, center_shift=0.019724, iteration=97, tol=0.000100][running kmeans]: 97it [01:33,  1.07it/s, center_shift=0.019724, iteration=97, tol=0.000100][running kmeans]: 97it [01:34,  1.07it/s, center_shift=0.016645, iteration=98, tol=0.000100][running kmeans]: 98it [01:34,  1.06it/s, center_shift=0.016645, iteration=98, tol=0.000100][running kmeans]: 98it [01:35,  1.06it/s, center_shift=0.015885, iteration=99, tol=0.000100][running kmeans]: 99it [01:35,  1.04it/s, center_shift=0.015885, iteration=99, tol=0.000100][running kmeans]: 99it [01:36,  1.04it/s, center_shift=0.017950, iteration=100, tol=0.000100][running kmeans]: 100it [01:36,  1.04it/s, center_shift=0.017950, iteration=100, tol=0.000100][running kmeans]: 100it [01:37,  1.04it/s, center_shift=0.013791, iteration=101, tol=0.000100][running kmeans]: 101it [01:37,  1.04it/s, center_shift=0.013791, iteration=101, tol=0.000100][running kmeans]: 101it [01:38,  1.04it/s, center_shift=0.012063, iteration=102, tol=0.000100][running kmeans]: 102it [01:38,  1.05it/s, center_shift=0.012063, iteration=102, tol=0.000100][running kmeans]: 102it [01:39,  1.05it/s, center_shift=0.011911, iteration=103, tol=0.000100][running kmeans]: 103it [01:39,  1.05it/s, center_shift=0.011911, iteration=103, tol=0.000100][running kmeans]: 103it [01:40,  1.05it/s, center_shift=0.011510, iteration=104, tol=0.000100][running kmeans]: 104it [01:40,  1.05it/s, center_shift=0.011510, iteration=104, tol=0.000100][running kmeans]: 104it [01:41,  1.05it/s, center_shift=0.009458, iteration=105, tol=0.000100][running kmeans]: 105it [01:41,  1.03it/s, center_shift=0.009458, iteration=105, tol=0.000100][running kmeans]: 105it [01:42,  1.03it/s, center_shift=0.007706, iteration=106, tol=0.000100][running kmeans]: 106it [01:42,  1.03it/s, center_shift=0.007706, iteration=106, tol=0.000100][running kmeans]: 106it [01:43,  1.03it/s, center_shift=0.005759, iteration=107, tol=0.000100][running kmeans]: 107it [01:43,  1.03it/s, center_shift=0.005759, iteration=107, tol=0.000100][running kmeans]: 107it [01:44,  1.03it/s, center_shift=0.003075, iteration=108, tol=0.000100][running kmeans]: 108it [01:44,  1.04it/s, center_shift=0.003075, iteration=108, tol=0.000100][running kmeans]: 108it [01:45,  1.04it/s, center_shift=0.004354, iteration=109, tol=0.000100][running kmeans]: 109it [01:45,  1.03it/s, center_shift=0.004354, iteration=109, tol=0.000100][running kmeans]: 109it [01:46,  1.03it/s, center_shift=0.005697, iteration=110, tol=0.000100][running kmeans]: 110it [01:46,  1.03it/s, center_shift=0.005697, iteration=110, tol=0.000100][running kmeans]: 110it [01:47,  1.03it/s, center_shift=0.005405, iteration=111, tol=0.000100][running kmeans]: 111it [01:47,  1.02it/s, center_shift=0.005405, iteration=111, tol=0.000100][running kmeans]: 111it [01:48,  1.02it/s, center_shift=0.005291, iteration=112, tol=0.000100][running kmeans]: 112it [01:48,  1.04it/s, center_shift=0.005291, iteration=112, tol=0.000100][running kmeans]: 112it [01:49,  1.04it/s, center_shift=0.006284, iteration=113, tol=0.000100][running kmeans]: 113it [01:49,  1.04it/s, center_shift=0.006284, iteration=113, tol=0.000100][running kmeans]: 113it [01:49,  1.04it/s, center_shift=0.004660, iteration=114, tol=0.000100][running kmeans]: 114it [01:49,  1.04it/s, center_shift=0.004660, iteration=114, tol=0.000100][running kmeans]: 114it [01:50,  1.04it/s, center_shift=0.003412, iteration=115, tol=0.000100][running kmeans]: 115it [01:50,  1.04it/s, center_shift=0.003412, iteration=115, tol=0.000100][running kmeans]: 115it [01:51,  1.04it/s, center_shift=0.001854, iteration=116, tol=0.000100][running kmeans]: 116it [01:51,  1.05it/s, center_shift=0.001854, iteration=116, tol=0.000100][running kmeans]: 116it [01:52,  1.05it/s, center_shift=0.001082, iteration=117, tol=0.000100][running kmeans]: 117it [01:52,  1.04it/s, center_shift=0.001082, iteration=117, tol=0.000100][running kmeans]: 117it [01:53,  1.04it/s, center_shift=0.001576, iteration=118, tol=0.000100][running kmeans]: 118it [01:53,  1.05it/s, center_shift=0.001576, iteration=118, tol=0.000100][running kmeans]: 118it [01:54,  1.05it/s, center_shift=0.001114, iteration=119, tol=0.000100][running kmeans]: 119it [01:54,  1.05it/s, center_shift=0.001114, iteration=119, tol=0.000100][running kmeans]: 119it [01:55,  1.05it/s, center_shift=0.000919, iteration=120, tol=0.000100][running kmeans]: 120it [01:55,  1.06it/s, center_shift=0.000919, iteration=120, tol=0.000100][running kmeans]: 120it [01:56,  1.06it/s, center_shift=0.000583, iteration=121, tol=0.000100][running kmeans]: 121it [01:56,  1.06it/s, center_shift=0.000583, iteration=121, tol=0.000100][running kmeans]: 121it [01:57,  1.06it/s, center_shift=0.000410, iteration=122, tol=0.000100][running kmeans]: 122it [01:57,  1.06it/s, center_shift=0.000410, iteration=122, tol=0.000100][running kmeans]: 122it [01:58,  1.06it/s, center_shift=0.000421, iteration=123, tol=0.000100][running kmeans]: 123it [01:58,  1.06it/s, center_shift=0.000421, iteration=123, tol=0.000100][running kmeans]: 123it [01:59,  1.06it/s, center_shift=0.000842, iteration=124, tol=0.000100][running kmeans]: 124it [01:59,  1.06it/s, center_shift=0.000842, iteration=124, tol=0.000100][running kmeans]: 124it [02:00,  1.06it/s, center_shift=0.002108, iteration=125, tol=0.000100][running kmeans]: 125it [02:00,  1.06it/s, center_shift=0.002108, iteration=125, tol=0.000100][running kmeans]: 125it [02:01,  1.06it/s, center_shift=0.002293, iteration=126, tol=0.000100][running kmeans]: 126it [02:01,  1.06it/s, center_shift=0.002293, iteration=126, tol=0.000100][running kmeans]: 126it [02:02,  1.06it/s, center_shift=0.002715, iteration=127, tol=0.000100][running kmeans]: 127it [02:02,  1.06it/s, center_shift=0.002715, iteration=127, tol=0.000100][running kmeans]: 127it [02:03,  1.06it/s, center_shift=0.001862, iteration=128, tol=0.000100][running kmeans]: 128it [02:03,  1.06it/s, center_shift=0.001862, iteration=128, tol=0.000100][running kmeans]: 128it [02:04,  1.06it/s, center_shift=0.001970, iteration=129, tol=0.000100][running kmeans]: 129it [02:04,  1.05it/s, center_shift=0.001970, iteration=129, tol=0.000100][running kmeans]: 129it [02:05,  1.05it/s, center_shift=0.001843, iteration=130, tol=0.000100][running kmeans]: 130it [02:05,  1.03it/s, center_shift=0.001843, iteration=130, tol=0.000100][running kmeans]: 130it [02:06,  1.03it/s, center_shift=0.002193, iteration=131, tol=0.000100][running kmeans]: 131it [02:06,  1.03it/s, center_shift=0.002193, iteration=131, tol=0.000100][running kmeans]: 131it [02:07,  1.03it/s, center_shift=0.001283, iteration=132, tol=0.000100][running kmeans]: 132it [02:07,  1.02it/s, center_shift=0.001283, iteration=132, tol=0.000100][running kmeans]: 132it [02:08,  1.02it/s, center_shift=0.001210, iteration=133, tol=0.000100][running kmeans]: 133it [02:08,  1.03it/s, center_shift=0.001210, iteration=133, tol=0.000100][running kmeans]: 133it [02:09,  1.03it/s, center_shift=0.001293, iteration=134, tol=0.000100][running kmeans]: 134it [02:09,  1.04it/s, center_shift=0.001293, iteration=134, tol=0.000100][running kmeans]: 134it [02:09,  1.04it/s, center_shift=0.001198, iteration=135, tol=0.000100][running kmeans]: 135it [02:09,  1.05it/s, center_shift=0.001198, iteration=135, tol=0.000100][running kmeans]: 135it [02:10,  1.05it/s, center_shift=0.001667, iteration=136, tol=0.000100][running kmeans]: 136it [02:10,  1.06it/s, center_shift=0.001667, iteration=136, tol=0.000100][running kmeans]: 136it [02:11,  1.06it/s, center_shift=0.001768, iteration=137, tol=0.000100][running kmeans]: 137it [02:11,  1.06it/s, center_shift=0.001768, iteration=137, tol=0.000100][running kmeans]: 137it [02:12,  1.06it/s, center_shift=0.001462, iteration=138, tol=0.000100][running kmeans]: 138it [02:12,  1.07it/s, center_shift=0.001462, iteration=138, tol=0.000100][running kmeans]: 138it [02:13,  1.07it/s, center_shift=0.001588, iteration=139, tol=0.000100][running kmeans]: 139it [02:13,  1.06it/s, center_shift=0.001588, iteration=139, tol=0.000100][running kmeans]: 139it [02:14,  1.06it/s, center_shift=0.000892, iteration=140, tol=0.000100][running kmeans]: 140it [02:14,  1.04it/s, center_shift=0.000892, iteration=140, tol=0.000100][running kmeans]: 140it [02:15,  1.04it/s, center_shift=0.000963, iteration=141, tol=0.000100][running kmeans]: 141it [02:15,  1.03it/s, center_shift=0.000963, iteration=141, tol=0.000100][running kmeans]: 141it [02:16,  1.03it/s, center_shift=0.001146, iteration=142, tol=0.000100][running kmeans]: 142it [02:16,  1.02it/s, center_shift=0.001146, iteration=142, tol=0.000100][running kmeans]: 142it [02:17,  1.02it/s, center_shift=0.000459, iteration=143, tol=0.000100][running kmeans]: 143it [02:17,  1.03it/s, center_shift=0.000459, iteration=143, tol=0.000100][running kmeans]: 143it [02:18,  1.03it/s, center_shift=0.000598, iteration=144, tol=0.000100][running kmeans]: 144it [02:18,  1.04it/s, center_shift=0.000598, iteration=144, tol=0.000100][running kmeans]: 144it [02:19,  1.04it/s, center_shift=0.000588, iteration=145, tol=0.000100][running kmeans]: 145it [02:19,  1.05it/s, center_shift=0.000588, iteration=145, tol=0.000100][running kmeans]: 145it [02:20,  1.05it/s, center_shift=0.000533, iteration=146, tol=0.000100][running kmeans]: 146it [02:20,  1.05it/s, center_shift=0.000533, iteration=146, tol=0.000100][running kmeans]: 146it [02:21,  1.05it/s, center_shift=0.000564, iteration=147, tol=0.000100][running kmeans]: 147it [02:21,  1.05it/s, center_shift=0.000564, iteration=147, tol=0.000100][running kmeans]: 147it [02:22,  1.05it/s, center_shift=0.000454, iteration=148, tol=0.000100][running kmeans]: 148it [02:22,  1.05it/s, center_shift=0.000454, iteration=148, tol=0.000100][running kmeans]: 148it [02:23,  1.05it/s, center_shift=0.000191, iteration=149, tol=0.000100][running kmeans]: 149it [02:23,  1.06it/s, center_shift=0.000191, iteration=149, tol=0.000100][running kmeans]: 149it [02:24,  1.06it/s, center_shift=0.000078, iteration=150, tol=0.000100][running kmeans]: 150it [02:24,  1.06it/s, center_shift=0.000078, iteration=150, tol=0.000100][running kmeans]: 150it [02:24,  1.04it/s, center_shift=0.000078, iteration=150, tol=0.000100]
predicting on cuda:0..
tensor([37,  4,  7,  ..., 10,  5, 29])
Epoch 0, loss_inner: 4.41590, loss_target: 3.57707, homo loss: 0.46427 
acc_train_clean: 0.0161, ASR_train_attach: 0.0000, ASR_train_outter: 0.1549
Traceback (most recent call last):
  File "run.py", line 259, in <module>
    model.fit(data.x, train_edge_index, None, data.y, idx_train,idx_attach, unlabeled_idx)
  File "/home/project-graph-backdoor/Backdoor/models/backdoor.py", line 506, in fit
    loss_outter.backward()
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/root/anaconda3/envs/py38_torch110/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA out of memory. Tried to allocate 7.21 GiB (GPU 0; 47.54 GiB total capacity; 29.34 GiB already allocated; 679.31 MiB free; 45.91 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
