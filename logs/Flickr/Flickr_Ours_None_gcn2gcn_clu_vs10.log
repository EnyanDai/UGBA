nohup: ignoring input
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='none', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.15, seed=11, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=10, vs_ratio=0, weight_decay=0.0005)
Length of training set: 17850
Training benign model Finished!
Total time elapsed: 12.9964s
Benign CA: 0.4534
#Attach Nodes:10
Length of training set: 17850
=== training gcn model ===
Epoch 0, training loss: 1.980782389640808
acc_val: 0.2613
Epoch 10, training loss: 1.625368356704712
acc_val: 0.4119
Epoch 20, training loss: 1.5911859273910522
acc_val: 0.4119
Epoch 30, training loss: 1.5817729234695435
acc_val: 0.4119
Epoch 40, training loss: 1.5776357650756836
acc_val: 0.4124
Epoch 50, training loss: 1.571601390838623
acc_val: 0.4165
Epoch 60, training loss: 1.562059760093689
acc_val: 0.4182
Epoch 70, training loss: 1.5464015007019043
acc_val: 0.4521
Epoch 80, training loss: 1.5203315019607544
acc_val: 0.4632
Epoch 90, training loss: 1.5139563083648682
acc_val: 0.4815
Epoch 100, training loss: 1.5090237855911255
acc_val: 0.4862
Epoch 110, training loss: 1.5089091062545776
acc_val: 0.4807
Epoch 120, training loss: 1.5028011798858643
acc_val: 0.4875
Epoch 130, training loss: 1.5087026357650757
acc_val: 0.4781
Epoch 140, training loss: 1.5038068294525146
acc_val: 0.4761
Epoch 150, training loss: 1.5030968189239502
acc_val: 0.4905
Epoch 160, training loss: 1.498571753501892
acc_val: 0.4768
Epoch 170, training loss: 1.4947514533996582
acc_val: 0.4799
Epoch 180, training loss: 1.494539499282837
acc_val: 0.4798
Epoch 190, training loss: 1.494118571281433
acc_val: 0.4939
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 12.2054s
Encoder CA on clean test nodes: 0.4977
idx_sing_class []
idx_sing_class []
idx_sing_class []
idx_sing_class [    2     3     6 ... 89226 89246 89247]
each_class_size 1
y_pred [0 0 1 ... 0 0 1]
node_idxs [32769     2 65544 ... 65528 32761 32766]
selected_nodes [12521 81556 73030 ...   750 13464    50] [12521 81556 73030 ...   750 13464    50]
idx_sing_class []
idx_sing_class [    0     1     4 ... 89245 89248 89249]
each_class_size 1
y_pred [1 0 1 ... 0 1 1]
node_idxs [    0     4    10 ... 89243 89248 89249]
selected_nodes [48746 32503 30769 ...    53   184   171] [48746 32503 30769 ...    53   184   171]
idx_attach: tensor([12521, 81556, 73030,  ...,    53,   184,   171], device='cuda:2')
Traceback (most recent call last):
  File "run_adaptive.py", line 189, in <module>
    model.fit(data.x, train_edge_index, None, data.y, idx_train,idx_attach, unlabeled_idx)
  File "/home/mfl5681/project-backdoor/Backdoor/models/backdoor.py", line 222, in fit
    idx_outter = torch.cat([idx_attach,idx_unlabeled[rs.choice(len(idx_unlabeled),size=512,replace=False)]])
  File "mtrand.pyx", line 909, in numpy.random.mtrand.RandomState.choice
ValueError: a must be greater than 0 unless no samples are taken
