nohup: ignoring input
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=11, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
Length of training set: 17850
Training benign model Finished!
Total time elapsed: 24.8424s
Benign CA: 0.4529
#Attach Nodes:160
idx_attach: tensor([67234, 70935, 18432, 10101, 44248, 80691, 55020, 44983, 73130, 66173,
        25204, 64318, 71396, 69957, 88514, 15452, 82877, 62169, 22150, 41613,
        81391, 58576, 85025,  8744, 22730,  9006, 84563, 29980, 16503, 32464,
        10461, 66575, 22914, 29964, 72748,  2219, 84042, 34205, 27602, 20654,
        41038, 31878,  8875, 38749, 48559, 76873, 59546, 29991, 86576, 15977,
        78985, 80964, 72704, 62289, 75810, 25352, 25778, 20552, 70016, 65255,
        30933, 21346, 15777, 69565, 74715, 86550, 25215, 79535, 53817, 58304,
        22854,  3817, 25915, 28615, 83815,  3711, 21752, 36714, 80215, 53615,
        78780, 63355, 42635, 60998, 25170, 73015, 20434, 54137, 66504, 14279,
         5091, 28243,  6160, 48242, 73131, 46313, 18908, 20345, 65733, 28548,
        27937, 33957, 45334, 65308, 31695, 65703, 49285, 74084, 75617, 66155,
        25425,  7267, 33566, 58018,  3533, 65883, 51347, 42994, 70729, 57674,
        33646, 45239, 13809,  9408, 35742, 27082, 29689, 43210, 14843, 56626,
        20007, 29709, 29609, 88176, 21494, 33052, 47603, 45460,  3424, 77388,
        71807, 27969, 77242, 70017, 69582,  8784,  9494,  2904, 29005, 43609,
        42835, 25760, 26198, 51889, 74042, 68836, 65858, 55781, 17835,  5187],
       device='cuda:2')
Epoch 0, loss_inner: 1.94540, loss_target: 1.91927, homo loss: 0.46805 
acc_train_clean: 0.0517, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 1.68954, loss_target: 1.81825, homo loss: 0.00420 
acc_train_clean: 0.4243, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 1.62770, loss_target: 1.59117, homo loss: 0.00778 
acc_train_clean: 0.4243, ASR_train_attach: 0.9500, ASR_train_outter: 0.9509
Epoch 30, loss_inner: 1.61311, loss_target: 1.58169, homo loss: 0.00306 
acc_train_clean: 0.4243, ASR_train_attach: 0.9062, ASR_train_outter: 0.8884
Epoch 40, loss_inner: 1.60479, loss_target: 1.56568, homo loss: 0.00270 
acc_train_clean: 0.4243, ASR_train_attach: 0.9688, ASR_train_outter: 0.9568
Epoch 50, loss_inner: 1.59606, loss_target: 1.55633, homo loss: 0.00262 
acc_train_clean: 0.4243, ASR_train_attach: 0.9813, ASR_train_outter: 0.9717
Epoch 60, loss_inner: 1.58912, loss_target: 1.54898, homo loss: 0.04561 
acc_train_clean: 0.4243, ASR_train_attach: 0.9938, ASR_train_outter: 0.9807
Epoch 70, loss_inner: 1.58503, loss_target: 1.54489, homo loss: 0.00621 
acc_train_clean: 0.4242, ASR_train_attach: 0.9938, ASR_train_outter: 0.9836
Epoch 80, loss_inner: 1.58091, loss_target: 1.54032, homo loss: 0.00440 
acc_train_clean: 0.4243, ASR_train_attach: 1.0000, ASR_train_outter: 0.9881
Epoch 90, loss_inner: 1.57649, loss_target: 1.53608, homo loss: 0.00372 
acc_train_clean: 0.4245, ASR_train_attach: 0.9938, ASR_train_outter: 0.9836
Epoch 100, loss_inner: 1.57157, loss_target: 1.53078, homo loss: 0.00321 
acc_train_clean: 0.4251, ASR_train_attach: 1.0000, ASR_train_outter: 0.9881
Epoch 110, loss_inner: 1.56584, loss_target: 1.52474, homo loss: 0.00302 
acc_train_clean: 0.4260, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 120, loss_inner: 1.55978, loss_target: 1.51852, homo loss: 0.00294 
acc_train_clean: 0.4272, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 130, loss_inner: 1.55381, loss_target: 1.51252, homo loss: 0.00301 
acc_train_clean: 0.4291, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 140, loss_inner: 1.54828, loss_target: 1.50719, homo loss: 0.00334 
acc_train_clean: 0.4319, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 150, loss_inner: 1.54337, loss_target: 1.50193, homo loss: 0.00308 
acc_train_clean: 0.4335, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 160, loss_inner: 1.53963, loss_target: 1.49945, homo loss: 0.00395 
acc_train_clean: 0.4385, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 170, loss_inner: 1.53740, loss_target: 1.49595, homo loss: 0.00364 
acc_train_clean: 0.4487, ASR_train_attach: 1.0000, ASR_train_outter: 0.9926
Epoch 180, loss_inner: 1.54276, loss_target: 1.51418, homo loss: 0.03059 
acc_train_clean: 0.4333, ASR_train_attach: 1.0000, ASR_train_outter: 0.9077
Epoch 190, loss_inner: 1.59313, loss_target: 1.50343, homo loss: 0.04295 
acc_train_clean: 0.4457, ASR_train_attach: 0.0000, ASR_train_outter: 0.9985
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=1.0, dropout=0.5, epochs=200, evaluate_mode='overall', hidden=64, homo_boost_thrd=0.5, homo_loss_weight=1.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=921, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=200, use_vs_number=True, vs_number=160, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7188
accuracy on clean test nodes: 0.4170
ASR: 0.7463
Flip ASR: 0.7469/8360 nodes
CA: 0.4217
Traceback (most recent call last):
  File "run_adaptive.py", line 294, in <module>
    overall_asr += asr
NameError: name 'asr' is not defined
