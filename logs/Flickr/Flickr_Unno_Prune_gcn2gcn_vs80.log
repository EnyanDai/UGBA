nohup: ignoring input
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=10, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
#Attach Nodes:80
idx_attach: tensor([86029, 78392, 54241, 61270, 29823, 81648, 28645, 80080, 16167, 65648,
        87291, 82541, 70942, 40939, 82589, 28203, 51694, 45348, 41609, 51296,
        19286, 46490, 41634, 26971, 44348, 53389, 62834, 68448,  3148,  6801,
        66797, 48818, 80062,  1676, 72805, 62619,  2657, 16630, 46989, 77075,
        39006, 14161, 81241, 44094, 23464, 11710,  3635, 75845,  8131, 54859,
        49894, 32582, 26637, 39713, 82347, 65462, 74586,  9864, 81440, 78450,
        78335, 76726, 82157, 54235,  4112, 17107, 51620,  8064, 71650, 51656,
        36205, 11868, 19404, 75919, 66613,  4672, 17876, 76769, 16816,  3221],
       device='cuda:2')
tensor([    0,     2,     4,  ..., 89243, 89248, 89249], device='cuda:2')
Epoch 0, loss_inner: 1.94527, loss_target: 1.91430, homo loss: 0.77779 
acc_train_clean: 0.0587, ASR_train_attach: 1.0000, ASR_train_outter: 0.0000
Epoch 10, loss_inner: 1.72661, loss_target: 2.16186, homo loss: 0.08159 
acc_train_clean: 0.4243, ASR_train_attach: 0.0000, ASR_train_outter: 0.0000
Epoch 20, loss_inner: 1.63775, loss_target: 1.60817, homo loss: 0.05819 
acc_train_clean: 0.4236, ASR_train_attach: 0.9875, ASR_train_outter: 0.9882
Epoch 30, loss_inner: 1.62088, loss_target: 1.59734, homo loss: 0.05529 
acc_train_clean: 0.4243, ASR_train_attach: 0.9375, ASR_train_outter: 0.8311
Epoch 40, loss_inner: 1.61334, loss_target: 1.57398, homo loss: 0.05141 
acc_train_clean: 0.4243, ASR_train_attach: 0.9875, ASR_train_outter: 0.9662
Epoch 50, loss_inner: 1.60499, loss_target: 1.56594, homo loss: 0.04557 
acc_train_clean: 0.4243, ASR_train_attach: 0.9500, ASR_train_outter: 0.9662
Epoch 60, loss_inner: 1.59775, loss_target: 1.55816, homo loss: 0.04968 
acc_train_clean: 0.4244, ASR_train_attach: 0.9875, ASR_train_outter: 0.9696
Epoch 70, loss_inner: 1.59248, loss_target: 1.55345, homo loss: 0.04227 
acc_train_clean: 0.4243, ASR_train_attach: 0.9875, ASR_train_outter: 0.9696
Epoch 80, loss_inner: 1.58785, loss_target: 1.54897, homo loss: 0.03993 
acc_train_clean: 0.4244, ASR_train_attach: 0.9875, ASR_train_outter: 0.9679
Epoch 90, loss_inner: 1.58401, loss_target: 1.54525, homo loss: 0.03644 
acc_train_clean: 0.4246, ASR_train_attach: 0.9625, ASR_train_outter: 0.9645
Epoch 100, loss_inner: 1.58022, loss_target: 1.54218, homo loss: 0.03460 
acc_train_clean: 0.4246, ASR_train_attach: 0.9750, ASR_train_outter: 0.9595
Epoch 110, loss_inner: 1.57682, loss_target: 1.53919, homo loss: 0.02976 
acc_train_clean: 0.4253, ASR_train_attach: 0.9750, ASR_train_outter: 0.9611
Epoch 120, loss_inner: 1.57321, loss_target: 1.53505, homo loss: 0.02582 
acc_train_clean: 0.4256, ASR_train_attach: 0.9750, ASR_train_outter: 0.9662
Epoch 130, loss_inner: 1.56964, loss_target: 1.53074, homo loss: 0.04191 
acc_train_clean: 0.4262, ASR_train_attach: 0.9625, ASR_train_outter: 0.9662
Epoch 140, loss_inner: 1.56708, loss_target: 1.53392, homo loss: 0.02832 
acc_train_clean: 0.4265, ASR_train_attach: 0.9375, ASR_train_outter: 0.9206
Epoch 150, loss_inner: 1.56349, loss_target: 1.52797, homo loss: 0.02268 
acc_train_clean: 0.4269, ASR_train_attach: 0.9625, ASR_train_outter: 0.9443
Epoch 160, loss_inner: 1.56036, loss_target: 1.52520, homo loss: 0.01922 
acc_train_clean: 0.4280, ASR_train_attach: 0.9625, ASR_train_outter: 0.9459
Epoch 170, loss_inner: 1.55708, loss_target: 1.52135, homo loss: 0.01592 
acc_train_clean: 0.4287, ASR_train_attach: 0.9625, ASR_train_outter: 0.9493
Epoch 180, loss_inner: 1.55350, loss_target: 1.51592, homo loss: 0.04616 
acc_train_clean: 0.4303, ASR_train_attach: 0.9500, ASR_train_outter: 0.9611
Epoch 190, loss_inner: 1.55298, loss_target: 1.52385, homo loss: 0.01946 
acc_train_clean: 0.4310, ASR_train_attach: 0.8625, ASR_train_outter: 0.8834
Epoch 200, loss_inner: 1.54955, loss_target: 1.51426, homo loss: 0.01344 
acc_train_clean: 0.4326, ASR_train_attach: 0.9625, ASR_train_outter: 0.9561
Epoch 210, loss_inner: 1.54473, loss_target: 1.50823, homo loss: 0.00974 
acc_train_clean: 0.4356, ASR_train_attach: 0.9625, ASR_train_outter: 0.9578
Epoch 220, loss_inner: 1.54124, loss_target: 1.50576, homo loss: 0.00727 
acc_train_clean: 0.4397, ASR_train_attach: 0.9625, ASR_train_outter: 0.9611
Epoch 230, loss_inner: 1.53663, loss_target: 1.49685, homo loss: 0.03133 
acc_train_clean: 0.4433, ASR_train_attach: 0.9875, ASR_train_outter: 0.9899
Epoch 240, loss_inner: 1.53467, loss_target: 1.49772, homo loss: 0.02009 
acc_train_clean: 0.4454, ASR_train_attach: 0.9750, ASR_train_outter: 0.9747
Epoch 250, loss_inner: 1.53444, loss_target: 1.50107, homo loss: 0.00648 
acc_train_clean: 0.4454, ASR_train_attach: 0.9375, ASR_train_outter: 0.9341
Epoch 260, loss_inner: 1.53159, loss_target: 1.49927, homo loss: 0.00274 
acc_train_clean: 0.4482, ASR_train_attach: 0.9250, ASR_train_outter: 0.9274
Epoch 270, loss_inner: 1.52925, loss_target: 1.49780, homo loss: 0.00083 
acc_train_clean: 0.4508, ASR_train_attach: 0.9625, ASR_train_outter: 0.9392
Epoch 280, loss_inner: 1.52722, loss_target: 1.49551, homo loss: 0.00010 
acc_train_clean: 0.4519, ASR_train_attach: 0.9625, ASR_train_outter: 0.9426
Epoch 290, loss_inner: 1.52554, loss_target: 1.49304, homo loss: 0.00004 
acc_train_clean: 0.4524, ASR_train_attach: 0.9625, ASR_train_outter: 0.9544
Epoch 300, loss_inner: 1.52434, loss_target: 1.49141, homo loss: 0.00003 
acc_train_clean: 0.4552, ASR_train_attach: 0.9625, ASR_train_outter: 0.9595
Epoch 310, loss_inner: 1.52249, loss_target: 1.48601, homo loss: 0.06175 
acc_train_clean: 0.4547, ASR_train_attach: 0.9875, ASR_train_outter: 0.9966
Epoch 320, loss_inner: 1.52212, loss_target: 1.48672, homo loss: 0.07164 
acc_train_clean: 0.4576, ASR_train_attach: 0.9875, ASR_train_outter: 0.9696
Epoch 330, loss_inner: 1.52174, loss_target: 1.48458, homo loss: 0.07054 
acc_train_clean: 0.4560, ASR_train_attach: 0.9750, ASR_train_outter: 0.9949
Epoch 340, loss_inner: 1.52150, loss_target: 1.48411, homo loss: 0.06660 
acc_train_clean: 0.4582, ASR_train_attach: 0.9875, ASR_train_outter: 0.9949
Epoch 350, loss_inner: 1.52165, loss_target: 1.48454, homo loss: 0.05746 
acc_train_clean: 0.4569, ASR_train_attach: 0.9750, ASR_train_outter: 0.9899
Epoch 360, loss_inner: 1.52281, loss_target: 1.48663, homo loss: 0.04208 
acc_train_clean: 0.4543, ASR_train_attach: 0.9750, ASR_train_outter: 0.9780
Epoch 370, loss_inner: 1.52245, loss_target: 1.48520, homo loss: 0.02968 
acc_train_clean: 0.4550, ASR_train_attach: 0.9750, ASR_train_outter: 0.9932
Epoch 380, loss_inner: 1.52103, loss_target: 1.48378, homo loss: 0.02032 
acc_train_clean: 0.4575, ASR_train_attach: 0.9875, ASR_train_outter: 0.9848
Epoch 390, loss_inner: 1.51991, loss_target: 1.48458, homo loss: 0.04676 
acc_train_clean: 0.4589, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=265, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.4182
Overall ASR: 0.9960
Flip ASR: 0.9957/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=125, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9875
accuracy on clean test nodes: 0.4194
Overall ASR: 0.9985
Flip ASR: 0.9984/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=996, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.4165
Overall ASR: 0.9969
Flip ASR: 0.9968/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=527, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.4185
Overall ASR: 0.9972
Flip ASR: 0.9970/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=320, selection_method='none', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.4177
Overall ASR: 0.9947
Flip ASR: 0.9945/8360 nodes
Overall ASR: 0.9967 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.4180
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=781, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3875
accuracy on clean test nodes: 0.4082
Overall ASR: 0.2859
Flip ASR: 0.2809/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=706, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.3875
accuracy on clean test nodes: 0.4034
Overall ASR: 0.2840
Flip ASR: 0.2788/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=778, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.7875
accuracy on clean test nodes: 0.4037
Overall ASR: 0.8428
Flip ASR: 0.8403/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=604, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.8000
accuracy on clean test nodes: 0.4046
Overall ASR: 0.8245
Flip ASR: 0.8217/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=133, selection_method='none', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.5000
accuracy on clean test nodes: 0.4043
Overall ASR: 0.4593
Flip ASR: 0.4538/8360 nodes
Overall ASR: 0.5393 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.4048
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=673, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9375
accuracy on clean test nodes: 0.4612
Overall ASR: 0.9765
Flip ASR: 0.9754/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=904, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9375
accuracy on clean test nodes: 0.4649
Overall ASR: 0.9673
Flip ASR: 0.9657/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=56, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9375
accuracy on clean test nodes: 0.4614
Overall ASR: 0.9795
Flip ASR: 0.9786/8360 nodes
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=1, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9375
accuracy on clean test nodes: 0.4578
Overall ASR: 0.9767
Flip ASR: 0.9757/8360 nodes
run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/project-graph-backdoor/Backdoor/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
Namespace(cuda=True, dataset='Flickr', debug=True, defense_mode='prune', device_id=2, dis_weight=0.0, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=64, homo_boost_thrd=0.8, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.4, seed=694, selection_method='none', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.02, trigger_size=3, trojan_epochs=400, use_vs_number=True, vs_number=80, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9250
accuracy on clean test nodes: 0.4623
Overall ASR: 0.9518
Flip ASR: 0.9498/8360 nodes
Overall ASR: 0.9704 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.4615
Total Overall ASR: 0.8354 
Total Clean Accuracy: 0.4281
